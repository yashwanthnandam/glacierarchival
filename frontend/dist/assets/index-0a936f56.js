var Mn=Object.defineProperty,Nn=Object.defineProperties;var Hn=Object.getOwnPropertyDescriptors;var jr=Object.getOwnPropertySymbols;var js=Object.prototype.hasOwnProperty,vs=Object.prototype.propertyIsEnumerable;var Gt=Math.pow,bs=(r,t,s)=>t in r?Mn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,I=(r,t)=>{for(var s in t||(t={}))js.call(t,s)&&bs(r,s,t[s]);if(jr)for(var s of jr(t))vs.call(t,s)&&bs(r,s,t[s]);return r},be=(r,t)=>Nn(r,Hn(t));var ws=(r,t)=>{var s={};for(var n in r)js.call(r,n)&&t.indexOf(n)<0&&(s[n]=r[n]);if(r!=null&&jr)for(var n of jr(r))t.indexOf(n)<0&&vs.call(r,n)&&(s[n]=r[n]);return s};var Gn=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var k=(r,t,s)=>new Promise((n,i)=>{var o=c=>{try{d(s.next(c))}catch(p){i(p)}},a=c=>{try{d(s.throw(c))}catch(p){i(p)}},d=c=>c.done?n(c.value):Promise.resolve(c.value).then(o,a);d((s=s.apply(r,t)).next())});import{j as e,B as h,C as Kt,a as it,P as ie,T as l,A as he,b as tt,c as z,L as et,d as Ae,I as Ne,R as Xt,G as T,e as De,f as Te,g as oe,h as Me,S as Dt,i as Le,k as jt,l as ut,u as Jt,m as as,n as qt,o as ee,p as j,q as Xr,D as ft,r as mt,s as yt,t as Zt,v as Rr,w as Vt,x as en,y as Ur,F as ar,z as Ot,E as dt,H as ve,J as we,K as _e,M as qn,N as gt,O as Yt,Q as bt,U as Vn,V as Yn,W as lt,X as tn,Y as Kn,Z as Cr,_ as _s,$ as Nr,a0 as zt,a1 as Hr,a2 as ls,a3 as rn,a4 as Xn,a5 as Ss,a6 as kr,a7 as Jn,a8 as St,a9 as vr,aa as Es,ab as Zn,ac as Cs,ad as Qn,ae as ei,af as ti,ag as sn,ah as ri,ai as lr,aj as ks,ak as wr,al as Ps,am as Dr,an as si,ao as Gr,ap as ni,aq as ii,ar as oi,as as ai,at as Is,au as Et,av as li,aw as Rs,ax as Ds,ay as Ts,az as Fs,aA as qr,aB as ci,aC as Jr,aD as di,aE as ui,aF as hi,aG as nn,aH as pi,aI as xi,aJ as gi,aK as fi,aL as mi,aM as yi,aN as As,aO as bi,aP as ji,aQ as Ws,aR as vi,aS as wi,aT as _i,aU as Si,aV as Ei,aW as Ci,aX as ki,aY as Pi}from"./ui-61e5f988.js";import{c as Ii,r as u,a as ur}from"./vendor-950dbbc1.js";import{a as Tr}from"./utils-76a9f601.js";var Xa=Gn(X=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var on,Us=Ii;on=Us.createRoot,Us.hydrateRoot;/**
 * @remix-run/router v1.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hr(){return hr=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])}return r},hr.apply(this,arguments)}var Pt;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(Pt||(Pt={}));const zs="popstate";function Ri(r){r===void 0&&(r={});function t(n,i){let{pathname:o,search:a,hash:d}=n.location;return Zr("",{pathname:o,search:a,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(n,i){return typeof i=="string"?i:Fr(i)}return Ti(t,s,null,r)}function Ce(r,t){if(r===!1||r===null||typeof r=="undefined")throw new Error(t)}function cs(r,t){if(!r){typeof console!="undefined"&&console.warn(t);try{throw new Error(t)}catch(s){}}}function Di(){return Math.random().toString(36).substr(2,8)}function Ls(r,t){return{usr:r.state,key:r.key,idx:t}}function Zr(r,t,s,n){return s===void 0&&(s=null),hr({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof t=="string"?Qt(t):t,{state:s,key:t&&t.key||n||Di()})}function Fr(r){let{pathname:t="/",search:s="",hash:n=""}=r;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Qt(r){let t={};if(r){let s=r.indexOf("#");s>=0&&(t.hash=r.substr(s),r=r.substr(0,s));let n=r.indexOf("?");n>=0&&(t.search=r.substr(n),r=r.substr(0,n)),r&&(t.pathname=r)}return t}function Ti(r,t,s,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,a=i.history,d=Pt.Pop,c=null,p=f();p==null&&(p=0,a.replaceState(hr({},a.state,{idx:p}),""));function f(){return(a.state||{idx:null}).idx}function w(){d=Pt.Pop;let P=f(),R=P==null?null:P-p;p=P,c&&c({action:d,location:E.location,delta:R})}function g(P,R){d=Pt.Push;let v=Zr(E.location,P,R);s&&s(v,P),p=f()+1;let N=Ls(v,p),b=E.createHref(v);try{a.pushState(N,"",b)}catch(A){i.location.assign(b)}o&&c&&c({action:d,location:E.location,delta:1})}function D(P,R){d=Pt.Replace;let v=Zr(E.location,P,R);s&&s(v,P),p=f();let N=Ls(v,p),b=E.createHref(v);a.replaceState(N,"",b),o&&c&&c({action:d,location:E.location,delta:0})}function S(P){let R=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof P=="string"?P:Fr(P);return Ce(R,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,R)}let E={get action(){return d},get location(){return r(i,a)},listen(P){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(zs,w),c=P,()=>{i.removeEventListener(zs,w),c=null}},createHref(P){return t(i,P)},createURL:S,encodeLocation(P){let R=S(P);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:g,replace:D,go(P){return a.go(P)}};return E}var Os;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Os||(Os={}));function Fi(r,t,s){s===void 0&&(s="/");let n=typeof t=="string"?Qt(t):t,i=ds(n.pathname||"/",s);if(i==null)return null;let o=an(r);Ai(o);let a=null;for(let d=0;a==null&&d<o.length;++d)a=Ni(o[d],qi(i));return a}function an(r,t,s,n){t===void 0&&(t=[]),s===void 0&&(s=[]),n===void 0&&(n="");let i=(o,a,d)=>{let c={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};c.relativePath.startsWith("/")&&(Ce(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let p=Rt([n,c.relativePath]),f=s.concat(c);o.children&&o.children.length>0&&(Ce(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),an(o.children,t,f,p)),!(o.path==null&&!o.index)&&t.push({path:p,score:Bi(p,o.index),routesMeta:f})};return r.forEach((o,a)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))i(o,a);else for(let c of ln(o.path))i(o,a,c)}),t}function ln(r){let t=r.split("/");if(t.length===0)return[];let[s,...n]=t,i=s.endsWith("?"),o=s.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let a=ln(n.join("/")),d=[];return d.push(...a.map(c=>c===""?o:[o,c].join("/"))),i&&d.push(...a),d.map(c=>r.startsWith("/")&&c===""?"/":c)}function Ai(r){r.sort((t,s)=>t.score!==s.score?s.score-t.score:Mi(t.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const Wi=/^:\w+$/,Ui=3,zi=2,Li=1,Oi=10,$i=-2,$s=r=>r==="*";function Bi(r,t){let s=r.split("/"),n=s.length;return s.some($s)&&(n+=$i),t&&(n+=zi),s.filter(i=>!$s(i)).reduce((i,o)=>i+(Wi.test(o)?Ui:o===""?Li:Oi),n)}function Mi(r,t){return r.length===t.length&&r.slice(0,-1).every((n,i)=>n===t[i])?r[r.length-1]-t[t.length-1]:0}function Ni(r,t){let{routesMeta:s}=r,n={},i="/",o=[];for(let a=0;a<s.length;++a){let d=s[a],c=a===s.length-1,p=i==="/"?t:t.slice(i.length)||"/",f=Hi({path:d.relativePath,caseSensitive:d.caseSensitive,end:c},p);if(!f)return null;Object.assign(n,f.params);let w=d.route;o.push({params:n,pathname:Rt([i,f.pathname]),pathnameBase:Xi(Rt([i,f.pathnameBase])),route:w}),f.pathnameBase!=="/"&&(i=Rt([i,f.pathnameBase]))}return o}function Hi(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[s,n]=Gi(r.path,r.caseSensitive,r.end),i=t.match(s);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),d=i.slice(1);return{params:n.reduce((p,f,w)=>{if(f==="*"){let g=d[w]||"";a=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}return p[f]=Vi(d[w]||"",f),p},{}),pathname:o,pathnameBase:a,pattern:r}}function Gi(r,t,s){t===void 0&&(t=!1),s===void 0&&(s=!0),cs(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let n=[],i="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,d)=>(n.push(d),"/([^\\/]+)"));return r.endsWith("*")?(n.push("*"),i+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":r!==""&&r!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function qi(r){try{return decodeURI(r)}catch(t){return cs(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),r}}function Vi(r,t){try{return decodeURIComponent(r)}catch(s){return cs(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+r+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+s+").")),r}}function ds(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,n=r.charAt(s);return n&&n!=="/"?null:r.slice(s)||"/"}function Yi(r,t){t===void 0&&(t="/");let{pathname:s,search:n="",hash:i=""}=typeof r=="string"?Qt(r):r;return{pathname:s?s.startsWith("/")?s:Ki(s,t):t,search:Ji(n),hash:Zi(i)}}function Ki(r,t){let s=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function Vr(r,t,s,n){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cn(r){return r.filter((t,s)=>s===0||t.route.path&&t.route.path.length>0)}function dn(r,t,s,n){n===void 0&&(n=!1);let i;typeof r=="string"?i=Qt(r):(i=hr({},r),Ce(!i.pathname||!i.pathname.includes("?"),Vr("?","pathname","search",i)),Ce(!i.pathname||!i.pathname.includes("#"),Vr("#","pathname","hash",i)),Ce(!i.search||!i.search.includes("#"),Vr("#","search","hash",i)));let o=r===""||i.pathname==="",a=o?"/":i.pathname,d;if(n||a==null)d=s;else{let w=t.length-1;if(a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),w-=1;i.pathname=g.join("/")}d=w>=0?t[w]:"/"}let c=Yi(i,d),p=a&&a!=="/"&&a.endsWith("/"),f=(o||a===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(p||f)&&(c.pathname+="/"),c}const Rt=r=>r.join("/").replace(/\/\/+/g,"/"),Xi=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Ji=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Zi=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Qi(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const un=["post","put","patch","delete"];new Set(un);const eo=["get",...un];new Set(eo);/**
 * React Router v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ar(){return Ar=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])}return r},Ar.apply(this,arguments)}const us=u.createContext(null),hn=u.createContext(null),er=u.createContext(null),zr=u.createContext(null),tr=u.createContext({outlet:null,matches:[]}),pn=u.createContext(null);function to(r,t){let{relative:s}=t===void 0?{}:t;rr()||Ce(!1);let{basename:n,navigator:i}=u.useContext(er),{hash:o,pathname:a,search:d}=gn(r,{relative:s}),c=a;return n!=="/"&&(c=a==="/"?n:Rt([n,a])),i.createHref({pathname:c,search:d,hash:o})}function rr(){return u.useContext(zr)!=null}function sr(){return rr()||Ce(!1),u.useContext(zr).location}function xn(r){u.useContext(er).static||u.useLayoutEffect(r)}function vt(){return u.useContext(us)!=null?go():ro()}function ro(){rr()||Ce(!1);let{basename:r,navigator:t}=u.useContext(er),{matches:s}=u.useContext(tr),{pathname:n}=sr(),i=JSON.stringify(cn(s).map(d=>d.pathnameBase)),o=u.useRef(!1);return xn(()=>{o.current=!0}),u.useCallback(function(d,c){if(c===void 0&&(c={}),!o.current)return;if(typeof d=="number"){t.go(d);return}let p=dn(d,JSON.parse(i),n,c.relative==="path");r!=="/"&&(p.pathname=p.pathname==="/"?r:Rt([r,p.pathname])),(c.replace?t.replace:t.push)(p,c.state,c)},[r,t,i,n])}function gn(r,t){let{relative:s}=t===void 0?{}:t,{matches:n}=u.useContext(tr),{pathname:i}=sr(),o=JSON.stringify(cn(n).map(a=>a.pathnameBase));return u.useMemo(()=>dn(r,JSON.parse(o),i,s==="path"),[r,o,i,s])}function so(r,t){return no(r,t)}function no(r,t,s){rr()||Ce(!1);let{navigator:n}=u.useContext(er),{matches:i}=u.useContext(tr),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let c=sr(),p;if(t){var f;let E=typeof t=="string"?Qt(t):t;d==="/"||(f=E.pathname)!=null&&f.startsWith(d)||Ce(!1),p=E}else p=c;let w=p.pathname||"/",g=d==="/"?w:w.slice(d.length)||"/",D=Fi(r,{pathname:g}),S=co(D&&D.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:Rt([d,n.encodeLocation?n.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:Rt([d,n.encodeLocation?n.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,s);return t&&S?u.createElement(zr.Provider,{value:{location:Ar({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Pt.Pop}},S):S}function io(){let r=xo(),t=Qi(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),s=r instanceof Error?r.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),s?u.createElement("pre",{style:i},s):null,o)}const oo=u.createElement(io,null);class ao extends u.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){console.error("React Router caught the following error during render",t,s)}render(){return this.state.error?u.createElement(tr.Provider,{value:this.props.routeContext},u.createElement(pn.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lo(r){let{routeContext:t,match:s,children:n}=r,i=u.useContext(us);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),u.createElement(tr.Provider,{value:t},n)}function co(r,t,s){var n;if(t===void 0&&(t=[]),s===void 0&&(s=null),r==null){var i;if((i=s)!=null&&i.errors)r=s.matches;else return null}let o=r,a=(n=s)==null?void 0:n.errors;if(a!=null){let d=o.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));d>=0||Ce(!1),o=o.slice(0,Math.min(o.length,d+1))}return o.reduceRight((d,c,p)=>{let f=c.route.id?a==null?void 0:a[c.route.id]:null,w=null;s&&(w=c.route.errorElement||oo);let g=t.concat(o.slice(0,p+1)),D=()=>{let S;return f?S=w:c.route.element?S=c.route.element:S=d,u.createElement(lo,{match:c,routeContext:{outlet:d,matches:g},children:S})};return s&&(c.route.ErrorBoundary||c.route.errorElement||p===0)?u.createElement(ao,{location:s.location,revalidation:s.revalidation,component:w,error:f,children:D(),routeContext:{outlet:null,matches:g}}):D()},null)}var Qr;(function(r){r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate"})(Qr||(Qr={}));var pr;(function(r){r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId"})(pr||(pr={}));function uo(r){let t=u.useContext(us);return t||Ce(!1),t}function ho(r){let t=u.useContext(hn);return t||Ce(!1),t}function po(r){let t=u.useContext(tr);return t||Ce(!1),t}function fn(r){let t=po(),s=t.matches[t.matches.length-1];return s.route.id||Ce(!1),s.route.id}function xo(){var r;let t=u.useContext(pn),s=ho(pr.UseRouteError),n=fn(pr.UseRouteError);return t||((r=s.errors)==null?void 0:r[n])}function go(){let{router:r}=uo(Qr.UseNavigateStable),t=fn(pr.UseNavigateStable),s=u.useRef(!1);return xn(()=>{s.current=!0}),u.useCallback(function(i,o){o===void 0&&(o={}),s.current&&(typeof i=="number"?r.navigate(i):r.navigate(i,Ar({fromRouteId:t},o)))},[r,t])}function fo(r){let{to:t,replace:s,state:n,relative:i}=r;rr()||Ce(!1);let o=u.useContext(hn),a=vt();return u.useEffect(()=>{o&&o.navigation.state!=="idle"||a(t,{replace:s,state:n,relative:i})}),null}function nt(r){Ce(!1)}function mo(r){let{basename:t="/",children:s=null,location:n,navigationType:i=Pt.Pop,navigator:o,static:a=!1}=r;rr()&&Ce(!1);let d=t.replace(/^\/*/,"/"),c=u.useMemo(()=>({basename:d,navigator:o,static:a}),[d,o,a]);typeof n=="string"&&(n=Qt(n));let{pathname:p="/",search:f="",hash:w="",state:g=null,key:D="default"}=n,S=u.useMemo(()=>{let E=ds(p,d);return E==null?null:{location:{pathname:E,search:f,hash:w,state:g,key:D},navigationType:i}},[d,p,f,w,g,D,i]);return S==null?null:u.createElement(er.Provider,{value:c},u.createElement(zr.Provider,{children:s,value:S}))}function yo(r){let{children:t,location:s}=r;return so(es(t),s)}var Bs;(function(r){r[r.pending=0]="pending",r[r.success=1]="success",r[r.error=2]="error"})(Bs||(Bs={}));new Promise(()=>{});function es(r,t){t===void 0&&(t=[]);let s=[];return u.Children.forEach(r,(n,i)=>{if(!u.isValidElement(n))return;let o=[...t,i];if(n.type===u.Fragment){s.push.apply(s,es(n.props.children,o));return}n.type!==nt&&Ce(!1),!n.props.index||!n.props.children||Ce(!1);let a={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=es(n.props.children,o)),s.push(a)}),s}/**
 * React Router DOM v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ts(){return ts=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])}return r},ts.apply(this,arguments)}function bo(r,t){if(r==null)return{};var s={},n=Object.keys(r),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(s[i]=r[i]);return s}function jo(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function vo(r,t){return r.button===0&&(!t||t==="_self")&&!jo(r)}function rs(r){return r===void 0&&(r=""),new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((t,s)=>{let n=r[s];return t.concat(Array.isArray(n)?n.map(i=>[s,i]):[[s,n]])},[]))}function wo(r,t){let s=rs(r);if(t)for(let n of t.keys())s.has(n)||t.getAll(n).forEach(i=>{s.append(n,i)});return s}const _o=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function So(r){let{basename:t,children:s,window:n}=r,i=u.useRef();i.current==null&&(i.current=Ri({window:n,v5Compat:!0}));let o=i.current,[a,d]=u.useState({action:o.action,location:o.location});return u.useLayoutEffect(()=>o.listen(d),[o]),u.createElement(mo,{basename:t,children:s,location:a.location,navigationType:a.action,navigator:o})}const Eo=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",Co=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xr=u.forwardRef(function(t,s){let{onClick:n,relative:i,reloadDocument:o,replace:a,state:d,target:c,to:p,preventScrollReset:f}=t,w=bo(t,_o),{basename:g}=u.useContext(er),D,S=!1;if(typeof p=="string"&&Co.test(p)&&(D=p,Eo))try{let v=new URL(window.location.href),N=p.startsWith("//")?new URL(v.protocol+p):new URL(p),b=ds(N.pathname,g);N.origin===v.origin&&b!=null?p=b+N.search+N.hash:S=!0}catch(v){}let E=to(p,{relative:i}),P=ko(p,{replace:a,state:d,target:c,preventScrollReset:f,relative:i});function R(v){n&&n(v),v.defaultPrevented||P(v)}return u.createElement("a",ts({},w,{href:D||E,onClick:S||o?n:R,ref:s,target:c}))});var Ms;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmitImpl="useSubmitImpl",r.UseFetcher="useFetcher"})(Ms||(Ms={}));var Ns;(function(r){r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(Ns||(Ns={}));function ko(r,t){let{target:s,replace:n,state:i,preventScrollReset:o,relative:a}=t===void 0?{}:t,d=vt(),c=sr(),p=gn(r,{relative:a});return u.useCallback(f=>{if(vo(f,s)){f.preventDefault();let w=n!==void 0?n:Fr(c)===Fr(p);d(r,{replace:w,state:i,preventScrollReset:o,relative:a})}},[c,d,p,n,i,s,r,o,a])}function mn(r){let t=u.useRef(rs(r)),s=u.useRef(!1),n=sr(),i=u.useMemo(()=>wo(n.search,s.current?null:t.current),[n.search]),o=vt(),a=u.useCallback((d,c)=>{const p=rs(typeof d=="function"?d(i):d);s.current=!0,o("?"+p,c)},[o,i]);return[i,a]}const gr={baseURL:"https://datahibernate.in/api/",timeout:3e4,withCredentials:!0},_r=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),Sr=navigator.deviceMemory&&navigator.deviceMemory<4,cr={timeout:3e5,bulkBatchSize:_r||Sr?1e3:1500,webWorkerBatchSize:_r||Sr?1e3:1500,mainBatchSize:_r||Sr?1e3:1500,maxConcurrentUploads:_r?12:Sr?16:24,minConcurrentUploads:6,maxConcurrentWorkers:4},pt={TOKEN:"token",REFRESH_TOKEN:"refreshToken",USER:"user"},Ve={MAX_FILE_SIZE:5*1024*1024*1024,MAX_TOTAL_SIZE:15*1024*1024*1024,MAX_FILES:1e5,MAX_SESSION_SIZE:50*1024*1024*1024,CHUNK_SIZE:8*1024*1024,MEMORY_LIMIT:100*1024*1024},dr={UPLOAD_SUCCESS:"Files uploaded successfully",UPLOAD_FAILED:"Upload failed",ARCHIVE_SUCCESS:"File archived successfully",ARCHIVE_FAILED:"Archive failed",RESTORE_SUCCESS:"File restored successfully",RESTORE_FAILED:"Restore failed",DOWNLOAD_SUCCESS:"Download started",DOWNLOAD_FAILED:"Download failed",S3_CONFIG_REQUIRED:"S3 configuration required. Please configure S3 settings first.",FILE_TOO_LARGE:"File too large",NETWORK_ERROR:"Network error. Please check your connection.",UNAUTHORIZED:"Unauthorized access",FORBIDDEN:"Access forbidden",NOT_FOUND:"Resource not found",SERVER_ERROR:"Server error. Please try again later.",FILE_SIZE_EXCEEDED:"File size exceeds the maximum limit of 5GB",TOTAL_SIZE_EXCEEDED:"Total upload size exceeds the limit of 15GB",SESSION_SIZE_EXCEEDED:"Upload session size exceeds the limit of 50GB",STORAGE_LIMIT_EXCEEDED:"Storage limit exceeded. Please subscribe to a hibernation plan to continue.",MEMORY_LIMIT_EXCEEDED:"File processing exceeds memory limit. Please upload smaller files.",TOO_MANY_FILES:"Too many files selected. Maximum 100,000 files per upload.",INVALID_FILE_TYPE:"File type not allowed. Please check allowed file types.",UPLOAD_CANCELLED:"Upload cancelled by user",UPLOAD_TIMEOUT:"Upload timeout. Please try again with smaller files.",NETWORK_TIMEOUT:"Network timeout. Please check your connection.",PARTIAL_UPLOAD_FAILED:"Some files failed to upload. Please retry failed files.",CONCURRENT_UPLOAD_LIMIT:"Too many concurrent uploads. Please wait for current uploads to complete."},Ge={EMAIL_REGEX:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,USERNAME_MIN_LENGTH:3,USERNAME_MAX_LENGTH:30,PASSWORD_MIN_LENGTH:8,PASSWORD_MAX_LENGTH:128},ct={isValidJWT:r=>{if(!r||typeof r!="string")return!1;try{const t=r.split(".");if(t.length!==3)return!1;const s=JSON.parse(atob(t[1])),n=Date.now()/1e3;return s.exp&&s.exp<n?!1:!!(s.user_id&&s.exp)}catch(t){return!1}},getTokenPayload:r=>{if(!r)return null;try{const t=r.split(".");return t.length!==3?null:JSON.parse(atob(t[1]))}catch(t){return null}},isTokenExpired:r=>{const t=ct.getTokenPayload(r);return!t||!t.exp?!0:t.exp<Date.now()/1e3}};class Po{constructor(){this.isProduction=!0,this.useHttpOnly=this.supportsHttpOnly(),this.csrfToken=null}supportsHttpOnly(){return!1}setCSRFToken(t){this.csrfToken=t}getCSRFToken(){return this.csrfToken}setAccessToken(t){if(!ct.isValidJWT(t))throw new Error("Invalid token format");this.useHttpOnly?console.log("Access token validated and stored in httpOnly cookie"):this.setSecureLocalStorage(pt.TOKEN,t)}setRefreshToken(t){if(!ct.isValidJWT(t))throw new Error("Invalid refresh token format");this.useHttpOnly?console.log("Refresh token validated and stored in httpOnly cookie"):this.setSecureLocalStorage(pt.REFRESH_TOKEN,t)}getAccessToken(){if(this.useHttpOnly)return"httpOnly_cookie";{const t=localStorage.getItem(pt.TOKEN);return ct.isValidJWT(t)?t:null}}getRefreshToken(){if(this.useHttpOnly)return"httpOnly_cookie";{const t=localStorage.getItem(pt.REFRESH_TOKEN);return ct.isValidJWT(t)?t:null}}clearTokens(){this.useHttpOnly?console.log("Clearing httpOnly cookies via logout endpoint"):(localStorage.removeItem(pt.TOKEN),localStorage.removeItem(pt.REFRESH_TOKEN),localStorage.removeItem(pt.USER))}isAuthenticated(){return k(this,null,function*(){if(this.useHttpOnly)try{return(yield fetch("https://datahibernate.in/api/auth/secure/user/",{method:"GET",credentials:"include",headers:this.getAuthHeaders()})).ok}catch(t){return console.error("Authentication check failed:",t),!1}else{const t=this.getAccessToken();return t&&ct.isValidJWT(t)&&!ct.isTokenExpired(t)}})}setSecureLocalStorage(t,s){try{if((t===pt.TOKEN||t===pt.REFRESH_TOKEN)&&!ct.isValidJWT(s))throw new Error("Invalid token format");if(localStorage.setItem(t,s),localStorage.getItem(t)!==s)throw new Error("Failed to store token securely")}catch(n){throw console.error("Failed to store token:",n),n}}getTokenPayload(){if(this.useHttpOnly)return null;{const t=this.getAccessToken();return t?ct.getTokenPayload(t):null}}isTokenExpired(){if(this.useHttpOnly)return!1;{const t=this.getAccessToken();return t?ct.isTokenExpired(t):!0}}getAuthHeaders(){const t={};if(this.useHttpOnly)this.csrfToken&&(t["X-CSRFToken"]=this.csrfToken);else{const s=this.getAccessToken();s&&(t.Authorization=`Bearer ${s}`)}return t}}const Ke=new Po,Yr=({children:r})=>{const[t,s]=u.useState(!0),[n,i]=u.useState(!1);return u.useEffect(()=>{(()=>k(X,null,function*(){try{const a=yield Ke.isAuthenticated();i(a),a||Ke.clearTokens()}catch(a){console.error("Authentication check failed:",a),i(!1),Ke.clearTokens()}finally{s(!1)}}))()},[]),t?e.jsx(h,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",sx:{bgcolor:"background.default"},children:e.jsx(Kt,{})}):n?r:e.jsx(fo,{to:"/login",replace:!0})},V=Tr.create(gr);V.interceptors.request.use(r=>{const t=Ke.getAuthHeaders();return Object.assign(r.headers,t),r},r=>Promise.reject(r));V.interceptors.response.use(r=>r,r=>k(X,null,function*(){var s,n;const t=r.config;if(((s=r.response)==null?void 0:s.status)===401&&!t._retry){t._retry=!0;try{const i=Ke.getRefreshToken();if(i){const o=yield Tr.post(`${gr.baseURL}auth/refresh/`,{refresh:i}),{access:a}=o.data;return Ke.setAccessToken(a),t.headers.Authorization=`Bearer ${a}`,V(t)}}catch(i){return Ke.clearTokens(),window.location.href="/login",Promise.reject(i)}}if(((n=r.response)==null?void 0:n.status)===402){const i=r.response.data;if(i.plan_required){if(i.free_tier_used&&i.free_tier_limit){const o=(i.free_tier_used/1073741824).toFixed(1),a=(i.free_tier_limit/Gt(1024,3)).toFixed(0);alert(`Free tier limit exceeded!

You have used ${o}GB of your ${a}GB free allowance.

Please subscribe to a hibernation plan to continue uploading files.`)}else window.location.href="/plans";return Promise.reject(r)}else if(i.plan_expired)return alert(`Your hibernation plan has expired. Please renew your subscription.
Expired on: ${new Date(i.expires_at).toLocaleDateString()}`),window.location.href="/plans",Promise.reject(r)}return Promise.reject(r)}));const Tt={secureLogin:r=>V.post("auth/secure/login/",r),secureRefresh:()=>V.post("auth/secure/refresh/"),secureLogout:()=>V.post("auth/secure/logout/"),secureGetUser:()=>V.get("auth/secure/user/"),secureRegister:r=>V.post("auth/secure/register/",r),login:r=>V.post("auth/login/",r),register:r=>V.post("auth/register/",r),refresh:()=>V.post("auth/refresh/"),getUser:()=>V.get("auth/user/"),verifyEmail:r=>V.post("auth/verify-email/",r),resendVerification:r=>V.post("auth/resend-verification/",r),requestPasswordReset:r=>V.post("auth/request-password-reset/",r),resetPassword:r=>V.post("auth/reset-password/",r)},Re={getFiles:(r={})=>{const t=new URLSearchParams;return r.folder!==void 0&&t.set("folder",r.folder),r.search&&t.set("search",r.search),r.paginate===!1&&t.set("paginate","false"),r.cacheBust&&t.set("_t",r.cacheBust),V.get("media-files/list_optimized/",{params:Object.fromEntries(t)})},archiveFile:r=>V.post(`media-files/${r}/archive/`),restoreFile:(r,t="Standard")=>V.post(`media-files/${r}/restore/`,{restore_tier:t}),downloadFile:r=>V.get(`media-files/${r}/download/`),deleteFile:r=>V.delete(`media-files/${r}/`),bulkDeleteFiles:r=>{const t=Tr.create(be(I({},gr),{timeout:3e5}));return t.interceptors.request.use(s=>{const n=Ke.getAuthHeaders();return Object.assign(s.headers,n),s},s=>Promise.reject(s)),t.post("media-files/bulk_delete/",{file_ids:r})},deleteAllFiles:(r=!0)=>V.post("media-files/delete_all/",{confirm_delete_all:r}),getRestoreTiers:()=>V.get("media-files/restore_tiers/"),getSmartTierSuggestion:(r,t)=>V.post("media-files/get_smart_tier_suggestion/",{file_size:r,file_type:t}),getStorageCosts:()=>V.get("media-files/get_storage_costs/"),getStorageCostsINR:()=>V.get("media-files/get_storage_costs_inr/"),autoHibernateFiles:r=>V.post("media-files/auto_hibernate_files/",r),createFolder:(r,t="")=>V.post("create-folder/",{folder_name:r,parent_path:t}),getPresignedUrls:r=>{const t=Tr.create(be(I({},gr),{timeout:6e4}));return t.interceptors.request.use(s=>{const n=Ke.getAuthHeaders();return Object.assign(s.headers,n),s},s=>Promise.reject(s)),t.post("media-files/get_presigned_urls/",r)},markUploadComplete:r=>V.post("media-files/mark_upload_complete/",{file_ids:r}),getFolderStructure:(r=!1)=>{const t=r?{_t:Date.now()}:{};return V.get("media-files/folder_structure/",{params:t})}},Io={getJobs:()=>V.get("archive-jobs/"),getJobStats:()=>V.get("archive-jobs/stats/")},Ro={getConfig:()=>V.get("s3-config/"),saveConfig:r=>V.post("s3-config/",r)},Bt={getPlans:()=>V.get("hibernation-plans/"),getPlansGroupedByTier:()=>V.get("hibernation-plans/grouped_by_tier/"),getCurrentPlan:()=>V.get("user-hibernation-plans/current_plan/"),getStorageUsage:()=>V.get("user-hibernation-plans/storage_usage/"),subscribe:r=>V.post("user-hibernation-plans/subscribe/",{plan_id:r}),cancelSubscription:()=>V.post("user-hibernation-plans/cancel_subscription/"),getUsageStats:()=>V.get("user-hibernation-plans/usage_stats/")},Pr={createOrder:(r,t)=>V.post("/payments/create_order/",{plan_id:r,amount_inr:t,currency:"INR"}),verifyPayment:(r,t,s,n)=>V.post("/payments/verify_payment/",{payment_id:r,razorpay_order_id:t,razorpay_payment_id:s,razorpay_signature:n}),getPaymentStatus:r=>V.get(`/payments/status/?payment_id=${r}`),getAll:()=>V.get("/payments/"),getStats:()=>V.get("/payments/stats/")},yn={getPresignedUrl:r=>V.post("uppy/presigned-url/",r),markUploadComplete:r=>V.post("uppy/upload-complete/",r),createSession:r=>V.post("uppy/create-session/",r),getProgress:r=>V.get(`uppy/upload-progress/?sessionId=${r}`),listFiles:()=>V.get("uppy/files/")},bn=Object.freeze(Object.defineProperty({__proto__:null,authAPI:Tt,default:V,hibernationAPI:Bt,jobAPI:Io,mediaAPI:Re,paymentAPI:Pr,s3ConfigAPI:Ro,uppyAPI:yn},Symbol.toStringTag,{value:"Module"}));class Do{constructor(){this.measurementId="G-EH6V4R00H3",this.isInitialized=!1,this.init()}init(){typeof window!="undefined"&&window.gtag?(this.isInitialized=!0,console.log("Google Analytics initialized")):console.warn("Google Analytics not loaded")}trackPageView(t,s){this.isInitialized&&window.gtag("config",this.measurementId,{page_title:t,page_location:window.location.href,page_path:s})}trackRegistration(t="email"){this.isInitialized&&window.gtag("event","sign_up",{method:t,event_category:"engagement",event_label:"user_registration"})}trackLogin(t="email"){this.isInitialized&&window.gtag("event","login",{method:t,event_category:"engagement",event_label:"user_login"})}trackFileUpload(t,s,n="web"){this.isInitialized&&window.gtag("event","file_upload",{event_category:"file_management",event_label:"upload",value:t,custom_parameters:{file_count:t,total_size_mb:Math.round(s/(1024*1024)),upload_method:n}})}trackFileDownload(t,s){this.isInitialized&&window.gtag("event","file_download",{event_category:"file_management",event_label:"download",value:t,custom_parameters:{file_count:t,total_size_mb:Math.round(s/(1024*1024))}})}trackFileDeletion(t,s){this.isInitialized&&window.gtag("event","file_deletion",{event_category:"file_management",event_label:"delete",value:t,custom_parameters:{file_count:t,total_size_mb:Math.round(s/(1024*1024))}})}trackPlanSubscription(t,s,n){this.isInitialized&&window.gtag("event","purchase",{event_category:"ecommerce",event_label:"plan_subscription",value:s,currency:"INR",custom_parameters:{plan_name:t,plan_price:s,plan_storage_gb:n}})}trackPayment(t,s,n="INR"){this.isInitialized&&window.gtag("event","purchase",{event_category:"ecommerce",event_label:"payment",value:s,currency:n,custom_parameters:{payment_method:t,amount:s}})}trackSearch(t,s){this.isInitialized&&window.gtag("event","search",{event_category:"engagement",event_label:"file_search",search_term:t,custom_parameters:{result_count:s}})}trackError(t,s,n){this.isInitialized&&window.gtag("event","exception",{event_category:"error",event_label:t,description:s,custom_parameters:{error_location:n,error_type:t}})}trackCustomEvent(t,s,n,i=null,o={}){if(!this.isInitialized)return;const a=I({event_category:s,event_label:n},o);i!==null&&(a.value=i),window.gtag("event",t,a)}trackEngagementTime(t,s){this.isInitialized&&window.gtag("event","engagement_time",{event_category:"engagement",event_label:s,value:t,custom_parameters:{time_spent_seconds:t,page_name:s}})}trackFeatureUsage(t,s="used"){this.isInitialized&&window.gtag("event","feature_usage",{event_category:"engagement",event_label:t,custom_parameters:{feature_name:t,action:s}})}}const Mt=new Do,To=Object.prototype.toString;function Fo(r,t){return To.call(r)===`[object ${t}]`}function jn(r){return Fo(r,"Object")}function hs(r){return!!(r&&r.then&&typeof r.then=="function")}function Er(r){return r&&r.Math==Math?r:void 0}const ot=typeof globalThis=="object"&&Er(globalThis)||typeof window=="object"&&Er(window)||typeof self=="object"&&Er(self)||typeof global=="object"&&Er(global)||function(){return this}()||{};function vn(r,t,s){const n=s||ot,i=n.__SENTRY__=n.__SENTRY__||{};return i[r]||(i[r]=t())}const Ao=typeof __SENTRY_DEBUG__=="undefined"||__SENTRY_DEBUG__,Wo="Sentry Logger ",Hs=["debug","info","warn","error","log","assert","trace"],Gs={};function wn(r){if(!("console"in ot))return r();const t=ot.console,s={},n=Object.keys(Gs);n.forEach(i=>{const o=Gs[i];s[i]=t[i],t[i]=o});try{return r()}finally{n.forEach(i=>{t[i]=s[i]})}}function Uo(){let r=!1;const t={enable:()=>{r=!0},disable:()=>{r=!1},isEnabled:()=>r};return Ao?Hs.forEach(s=>{t[s]=(...n)=>{r&&wn(()=>{ot.console[s](`${Wo}[${s}]:`,...n)})}}):Hs.forEach(s=>{t[s]=()=>{}}),t}const It=Uo();function Lt(r){return ss(r,new Map)}function ss(r,t){if(zo(r)){const s=t.get(r);if(s!==void 0)return s;const n={};t.set(r,n);for(const i of Object.keys(r))typeof r[i]!="undefined"&&(n[i]=ss(r[i],t));return n}if(Array.isArray(r)){const s=t.get(r);if(s!==void 0)return s;const n=[];return t.set(r,n),r.forEach(i=>{n.push(ss(i,t))}),n}return r}function zo(r){if(!jn(r))return!1;try{const t=Object.getPrototypeOf(r).constructor.name;return!t||t==="Object"}catch(t){return!0}}function ht(){const r=ot,t=r.crypto||r.msCrypto;let s=()=>Math.random()*16;try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(s=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch(n){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(s()&15)>>n/4).toString(16))}function Lo(r){return Array.isArray(r)?r:[r]}var xt;(function(r){r[r.PENDING=0]="PENDING";const s=1;r[r.RESOLVED=s]="RESOLVED";const n=2;r[r.REJECTED=n]="REJECTED"})(xt||(xt={}));class kt{constructor(t){kt.prototype.__init.call(this),kt.prototype.__init2.call(this),kt.prototype.__init3.call(this),kt.prototype.__init4.call(this),this._state=xt.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(s){this._reject(s)}}then(t,s){return new kt((n,i)=>{this._handlers.push([!1,o=>{if(!t)n(o);else try{n(t(o))}catch(a){i(a)}},o=>{if(!s)i(o);else try{n(s(o))}catch(a){i(a)}}]),this._executeHandlers()})}catch(t){return this.then(s=>s,t)}finally(t){return new kt((s,n)=>{let i,o;return this.then(a=>{o=!1,i=a,t&&t()},a=>{o=!0,i=a,t&&t()}).then(()=>{if(o){n(i);return}s(i)})})}__init(){this._resolve=t=>{this._setResult(xt.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(xt.REJECTED,t)}}__init3(){this._setResult=(t,s)=>{if(this._state===xt.PENDING){if(hs(s)){s.then(this._resolve,this._reject);return}this._state=t,this._value=s,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===xt.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(s=>{s[0]||(this._state===xt.RESOLVED&&s[1](this._value),this._state===xt.REJECTED&&s[2](this._value),s[0]=!0)})}}}const _n=1e3;function ps(){return Date.now()/_n}function Oo(){const{performance:r}=ot;if(!r||!r.now)return ps;const t=Date.now()-r.now(),s=r.timeOrigin==null?t:r.timeOrigin;return()=>(s+r.now())/_n}const Sn=Oo();(()=>{const{performance:r}=ot;if(!r||!r.now)return;const t=3600*1e3,s=r.now(),n=Date.now(),i=r.timeOrigin?Math.abs(r.timeOrigin+s-n):t,o=i<t,a=r.timing&&r.timing.navigationStart,c=typeof a=="number"?Math.abs(a+s-n):t,p=c<t;return o||p?i<=c?r.timeOrigin:a:n})();const Ir=typeof __SENTRY_DEBUG__=="undefined"||__SENTRY_DEBUG__,En="production";function $o(){return vn("globalEventProcessors",()=>[])}function ns(r,t,s,n=0){return new kt((i,o)=>{const a=r[n];if(t===null||typeof a!="function")i(t);else{const d=a(I({},t),s);Ir&&a.id&&d===null&&It.log(`Event processor "${a.id}" dropped event`),hs(d)?d.then(c=>ns(r,c,s,n+1).then(i)).then(null,o):ns(r,d,s,n+1).then(i).then(null,o)}})}function Bo(r){const t=Sn(),s={sid:ht(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>No(s)};return r&&Lr(s,r),s}function Lr(r,t={}){if(t.user&&(!r.ipAddress&&t.user.ip_address&&(r.ipAddress=t.user.ip_address),!r.did&&!t.did&&(r.did=t.user.id||t.user.email||t.user.username)),r.timestamp=t.timestamp||Sn(),t.abnormal_mechanism&&(r.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(r.ignoreDuration=t.ignoreDuration),t.sid&&(r.sid=t.sid.length===32?t.sid:ht()),t.init!==void 0&&(r.init=t.init),!r.did&&t.did&&(r.did=`${t.did}`),typeof t.started=="number"&&(r.started=t.started),r.ignoreDuration)r.duration=void 0;else if(typeof t.duration=="number")r.duration=t.duration;else{const s=r.timestamp-r.started;r.duration=s>=0?s:0}t.release&&(r.release=t.release),t.environment&&(r.environment=t.environment),!r.ipAddress&&t.ipAddress&&(r.ipAddress=t.ipAddress),!r.userAgent&&t.userAgent&&(r.userAgent=t.userAgent),typeof t.errors=="number"&&(r.errors=t.errors),t.status&&(r.status=t.status)}function Mo(r,t){let s={};t?s={status:t}:r.status==="ok"&&(s={status:"exited"}),Lr(r,s)}function No(r){return Lt({sid:`${r.sid}`,init:r.init,started:new Date(r.started*1e3).toISOString(),timestamp:new Date(r.timestamp*1e3).toISOString(),status:r.status,errors:r.errors,did:typeof r.did=="number"||typeof r.did=="string"?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})}const Ho=1;function Go(r){const{spanId:t,traceId:s}=r.spanContext(),{data:n,op:i,parent_span_id:o,status:a,tags:d,origin:c}=Wr(r);return Lt({data:n,op:i,parent_span_id:o,span_id:t,status:a,tags:d,trace_id:s,origin:c})}function Wr(r){return qo(r)?r.getSpanJSON():typeof r.toJSON=="function"?r.toJSON():{}}function qo(r){return typeof r.getSpanJSON=="function"}function Vo(r){const{traceFlags:t}=r.spanContext();return!!(t&Ho)}function Yo(r){if(r)return Ko(r)?{captureContext:r}:Jo(r)?{captureContext:r}:r}function Ko(r){return r instanceof $t||typeof r=="function"}const Xo=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Jo(r){return Object.keys(r).some(t=>Xo.includes(t))}function Zo(r,t){return nr().captureException(r,Yo(t))}function Qo(r,t){nr().addBreadcrumb(r,t)}function ea(r){nr().setUser(r)}function ta(...r){const t=nr();if(r.length===2){const[s,n]=r;return s?t.withScope(()=>(t.getStackTop().scope=s,n(s))):t.withScope(n)}return t.withScope(r[0])}function ra(){return nr().getClient()}function sa(){return nr().getScope()}function Cn(r){return r.transaction}function na(r,t,s){const n=t.getOptions(),{publicKey:i}=t.getDsn()||{},{segment:o}=s&&s.getUser()||{},a=Lt({environment:n.environment||En,release:n.release,user_segment:o,public_key:i,trace_id:r});return t.emit&&t.emit("createDsc",a),a}function ia(r){const t=ra();if(!t)return{};const s=na(Wr(r).trace_id||"",t,sa()),n=Cn(r);if(!n)return s;const i=n&&n._frozenDynamicSamplingContext;if(i)return i;const{sampleRate:o,source:a}=n.metadata;o!=null&&(s.sample_rate=`${o}`);const d=Wr(n);return a&&a!=="url"&&(s.transaction=d.description),s.sampled=String(Vo(n)),t.emit&&t.emit("createDsc",s),s}function oa(r,t){const{fingerprint:s,span:n,breadcrumbs:i,sdkProcessingMetadata:o}=t;aa(r,t),n&&da(r,n),ua(r,s),la(r,i),ca(r,o)}function aa(r,t){const{extra:s,tags:n,user:i,contexts:o,level:a,transactionName:d}=t,c=Lt(s);c&&Object.keys(c).length&&(r.extra=I(I({},c),r.extra));const p=Lt(n);p&&Object.keys(p).length&&(r.tags=I(I({},p),r.tags));const f=Lt(i);f&&Object.keys(f).length&&(r.user=I(I({},f),r.user));const w=Lt(o);w&&Object.keys(w).length&&(r.contexts=I(I({},w),r.contexts)),a&&(r.level=a),d&&(r.transaction=d)}function la(r,t){const s=[...r.breadcrumbs||[],...t];r.breadcrumbs=s.length?s:void 0}function ca(r,t){r.sdkProcessingMetadata=I(I({},r.sdkProcessingMetadata),t)}function da(r,t){r.contexts=I({trace:Go(t)},r.contexts);const s=Cn(t);if(s){r.sdkProcessingMetadata=I({dynamicSamplingContext:ia(t)},r.sdkProcessingMetadata);const n=Wr(s).description;n&&(r.tags=I({transaction:n},r.tags))}}function ua(r,t){r.fingerprint=r.fingerprint?Lo(r.fingerprint):[],t&&(r.fingerprint=r.fingerprint.concat(t)),r.fingerprint&&!r.fingerprint.length&&delete r.fingerprint}const ha=100;class $t{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=qs()}static clone(t){return t?t.clone():new $t}clone(){const t=new $t;return t._breadcrumbs=[...this._breadcrumbs],t._tags=I({},this._tags),t._extra=I({},this._extra),t._contexts=I({},this._contexts),t._user=this._user,t._level=this._level,t._span=this._span,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._requestSession=this._requestSession,t._attachments=[...this._attachments],t._sdkProcessingMetadata=I({},this._sdkProcessingMetadata),t._propagationContext=I({},this._propagationContext),t._client=this._client,t}setClient(t){this._client=t}getClient(){return this._client}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&Lr(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags=I(I({},this._tags),t),this._notifyScopeListeners(),this}setTag(t,s){return this._tags=be(I({},this._tags),{[t]:s}),this._notifyScopeListeners(),this}setExtras(t){return this._extra=I(I({},this._extra),t),this._notifyScopeListeners(),this}setExtra(t,s){return this._extra=be(I({},this._extra),{[t]:s}),this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,s){return s===null?delete this._contexts[t]:this._contexts[t]=s,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this._span;return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const s=typeof t=="function"?t(this):t;if(s instanceof $t){const n=s.getScopeData();this._tags=I(I({},this._tags),n.tags),this._extra=I(I({},this._extra),n.extra),this._contexts=I(I({},this._contexts),n.contexts),n.user&&Object.keys(n.user).length&&(this._user=n.user),n.level&&(this._level=n.level),n.fingerprint.length&&(this._fingerprint=n.fingerprint),s.getRequestSession()&&(this._requestSession=s.getRequestSession()),n.propagationContext&&(this._propagationContext=n.propagationContext)}else if(jn(s)){const n=t;this._tags=I(I({},this._tags),n.tags),this._extra=I(I({},this._extra),n.extra),this._contexts=I(I({},this._contexts),n.contexts),n.user&&(this._user=n.user),n.level&&(this._level=n.level),n.fingerprint&&(this._fingerprint=n.fingerprint),n.requestSession&&(this._requestSession=n.requestSession),n.propagationContext&&(this._propagationContext=n.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=qs(),this}addBreadcrumb(t,s){const n=typeof s=="number"?s:ha;if(n<=0)return this;const i=I({timestamp:ps()},t),o=this._breadcrumbs;return o.push(i),this._breadcrumbs=o.length>n?o.slice(-n):o,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:t,_attachments:s,_contexts:n,_tags:i,_extra:o,_user:a,_level:d,_fingerprint:c,_eventProcessors:p,_propagationContext:f,_sdkProcessingMetadata:w,_transactionName:g,_span:D}=this;return{breadcrumbs:t,attachments:s,contexts:n,tags:i,extra:o,user:a,level:d,fingerprint:c||[],eventProcessors:p,propagationContext:f,sdkProcessingMetadata:w,transactionName:g,span:D}}applyToEvent(t,s={},n=[]){oa(t,this.getScopeData());const i=[...n,...$o(),...this._eventProcessors];return ns(i,t,s)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=I(I({},this._sdkProcessingMetadata),t),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,s){const n=s&&s.event_id?s.event_id:ht();if(!this._client)return It.warn("No client configured on scope - will not capture exception!"),n;const i=new Error("Sentry syntheticException");return this._client.captureException(t,be(I({originalException:t,syntheticException:i},s),{event_id:n}),this),n}captureMessage(t,s,n){const i=n&&n.event_id?n.event_id:ht();if(!this._client)return It.warn("No client configured on scope - will not capture message!"),i;const o=new Error(t);return this._client.captureMessage(t,s,be(I({originalException:t,syntheticException:o},n),{event_id:i}),this),i}captureEvent(t,s){const n=s&&s.event_id?s.event_id:ht();return this._client?(this._client.captureEvent(t,be(I({},s),{event_id:n}),this),n):(It.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function qs(){return{traceId:ht(),spanId:ht().substring(16)}}const pa="7.120.4",kn=parseFloat(pa),xa=100;class Pn{constructor(t,s,n,i=kn){this._version=i;let o;s?o=s:(o=new $t,o.setClient(t));let a;n?a=n:(a=new $t,a.setClient(t)),this._stack=[{scope:o}],t&&this.bindClient(t),this._isolationScope=a}isOlderThan(t){return this._version<t}bindClient(t){const s=this.getStackTop();s.client=t,s.scope.setClient(t),t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const s=this.pushScope();let n;try{n=t(s)}catch(i){throw this.popScope(),i}return hs(n)?n.then(i=>(this.popScope(),i),i=>{throw this.popScope(),i}):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,s){const n=this._lastEventId=s&&s.event_id?s.event_id:ht(),i=new Error("Sentry syntheticException");return this.getScope().captureException(t,be(I({originalException:t,syntheticException:i},s),{event_id:n})),n}captureMessage(t,s,n){const i=this._lastEventId=n&&n.event_id?n.event_id:ht(),o=new Error(t);return this.getScope().captureMessage(t,s,be(I({originalException:t,syntheticException:o},n),{event_id:i})),i}captureEvent(t,s){const n=s&&s.event_id?s.event_id:ht();return t.type||(this._lastEventId=n),this.getScope().captureEvent(t,be(I({},s),{event_id:n})),n}lastEventId(){return this._lastEventId}addBreadcrumb(t,s){const{scope:n,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:a=xa}=i.getOptions&&i.getOptions()||{};if(a<=0)return;const d=ps(),c=I({timestamp:d},t),p=o?wn(()=>o(c,s)):c;p!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",p,s),n.addBreadcrumb(p,a))}setUser(t){this.getScope().setUser(t),this.getIsolationScope().setUser(t)}setTags(t){this.getScope().setTags(t),this.getIsolationScope().setTags(t)}setExtras(t){this.getScope().setExtras(t),this.getIsolationScope().setExtras(t)}setTag(t,s){this.getScope().setTag(t,s),this.getIsolationScope().setTag(t,s)}setExtra(t,s){this.getScope().setExtra(t,s),this.getIsolationScope().setExtra(t,s)}setContext(t,s){this.getScope().setContext(t,s),this.getIsolationScope().setContext(t,s)}configureScope(t){const{scope:s,client:n}=this.getStackTop();n&&t(s)}run(t){const s=Vs(this);try{t(this)}finally{Vs(s)}}getIntegration(t){const s=this.getClient();if(!s)return null;try{return s.getIntegration(t)}catch(n){return Ir&&It.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,s){const n=this._callExtensionMethod("startTransaction",t,s);return Ir&&!n&&(this.getClient()?It.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):It.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const s=this.getStackTop().scope,n=s.getSession();n&&Mo(n),this._sendSessionUpdate(),s.setSession()}startSession(t){const{scope:s,client:n}=this.getStackTop(),{release:i,environment:o=En}=n&&n.getOptions()||{},{userAgent:a}=ot.navigator||{},d=Bo(I(I({release:i,environment:o,user:s.getUser()},a&&{userAgent:a}),t)),c=s.getSession&&s.getSession();return c&&c.status==="ok"&&Lr(c,{status:"exited"}),this.endSession(),s.setSession(d),d}shouldSendDefaultPii(){const t=this.getClient(),s=t&&t.getOptions();return!!(s&&s.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:s}=this.getStackTop(),n=t.getSession();n&&s&&s.captureSession&&s.captureSession(n)}_callExtensionMethod(t,...s){const i=Or().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[t]=="function")return i.extensions[t].apply(this,s);Ir&&It.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function Or(){return ot.__SENTRY__=ot.__SENTRY__||{extensions:{},hub:void 0},ot}function Vs(r){const t=Or(),s=is(t);return In(t,r),s}function nr(){const r=Or();if(r.__SENTRY__&&r.__SENTRY__.acs){const t=r.__SENTRY__.acs.getCurrentHub();if(t)return t}return ga(r)}function ga(r=Or()){return(!fa(r)||is(r).isOlderThan(kn))&&In(r,new Pn),is(r)}function fa(r){return!!(r&&r.__SENTRY__&&r.__SENTRY__.hub)}function is(r){return vn("hub",()=>new Pn,r)}function In(r,t){if(!r)return!1;const s=r.__SENTRY__=r.__SENTRY__||{};return s.hub=t,!0}try{console.log("Sentry temporarily disabled to avoid 403 errors")}catch(r){console.warn("Sentry initialization failed:",r)}const ma=r=>{try{ea({id:r==null?void 0:r.id,username:r==null?void 0:r.username,email:r==null?void 0:r.email})}catch(t){console.warn("Failed to set Sentry user context:",t)}},Rn=(r,t={})=>{try{ta(s=>{Object.keys(t).forEach(n=>{s.setContext(n,t[n])}),Zo(r)})}catch(s){console.warn("Failed to capture exception in Sentry:",s),console.error("Original error:",r)}},ya=(r,t="custom",s="info",n={})=>{try{Qo({message:r,category:t,level:s,data:n,timestamp:Date.now()/1e3})}catch(i){console.warn("Failed to add Sentry breadcrumb:",i)}},ba=()=>{const[r,t]=u.useState(""),[s,n]=u.useState(""),[i,o]=u.useState(""),[a,d]=u.useState(!1),c=vt(),p=()=>{const g={};return r.trim()?r.length<Ge.USERNAME_MIN_LENGTH?g.username=`Username must be at least ${Ge.USERNAME_MIN_LENGTH} characters`:r.length>Ge.USERNAME_MAX_LENGTH&&(g.username=`Username must be less than ${Ge.USERNAME_MAX_LENGTH} characters`):g.username="Username is required",s?s.length<Ge.PASSWORD_MIN_LENGTH&&(g.password=`Password must be at least ${Ge.PASSWORD_MIN_LENGTH} characters`):g.password="Password is required",g},f=g=>{var D,S,E;return((D=g.response)==null?void 0:D.status)===401?"Invalid username or password. Please check your credentials.":((S=g.response)==null?void 0:S.status)===429?"Too many login attempts. Please try again later.":((E=g.response)==null?void 0:E.status)>=500?"Server error. Please try again later.":g.code==="NETWORK_ERROR"||!g.response?"Network error. Please check your connection.":"Login failed. Please try again."},w=g=>k(X,null,function*(){g.preventDefault(),d(!0),o("");const D=p();if(Object.keys(D).length>0){o(Object.values(D)[0]),d(!1);return}try{{const E=yield Tt.login({username:r,password:s}),{access:P,refresh:R}=E.data;Ke.setAccessToken(P),Ke.setRefreshToken(R),Mt.trackLogin("email"),ma({username:r}),c("/dashboard")}}catch(S){const E=f(S);o(E),Mt.trackError("login_error",E,"login_form"),Rn(S,{tags:{component:"Login",action:"login_attempt"},extra:{username:r,error_message:E}}),{}.VITE_DEBUG==="true"&&console.error("Login error:",S)}finally{d(!1)}});return e.jsx(h,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",py:4},children:e.jsx(it,{maxWidth:"sm",children:e.jsxs(ie,{elevation:0,sx:{p:4,borderRadius:4,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(h,{sx:{textAlign:"center",mb:4},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:48,height:48,mr:2,borderRadius:2}}),e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:800,color:"#1e293b"},children:"Data Hibernate"})]}),e.jsx(l,{variant:"h6",sx:{color:"#64748b",fontWeight:400},children:"Welcome back! Login to your account"})]}),i&&e.jsx(he,{severity:"error",sx:{mb:3,borderRadius:2},children:i}),e.jsxs(h,{component:"form",onSubmit:w,sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(tt,{label:"Username",value:r,onChange:g=>t(g.target.value),required:!0,fullWidth:!0,autoComplete:"username",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(tt,{type:"password",label:"Password",value:s,onChange:g=>n(g.target.value),required:!0,fullWidth:!0,autoComplete:"current-password",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(z,{type:"submit",variant:"contained",fullWidth:!0,disabled:a,sx:{mt:2,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:2,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 16px rgba(25, 118, 210, 0.3)","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #0d47a1 100%)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(25, 118, 210, 0.4)"}},children:a?"Logging in...":"Login"})]}),e.jsxs(h,{sx:{mt:4,textAlign:"center"},children:[e.jsx(l,{variant:"body2",sx:{color:"#64748b",mb:1},children:e.jsx(et,{component:xr,to:"/forgot-password",sx:{color:"#1976d2",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Forgot your password?"})}),e.jsxs(l,{variant:"body2",sx:{color:"#64748b"},children:["Don't have an account?"," ",e.jsx(et,{component:xr,to:"/register",sx:{color:"#1976d2",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Register here"})]})]})]})})})},ja=()=>{const[r,t]=u.useState({username:"",email:"",password:""}),[s,n]=u.useState(""),[i,o]=u.useState(!1),a=vt(),d=()=>{const g={};return r.username.trim()?r.username.length<Ge.USERNAME_MIN_LENGTH?g.username=`Username must be at least ${Ge.USERNAME_MIN_LENGTH} characters`:r.username.length>Ge.USERNAME_MAX_LENGTH&&(g.username=`Username must be less than ${Ge.USERNAME_MAX_LENGTH} characters`):g.username="Username is required",r.email.trim()?Ge.EMAIL_REGEX.test(r.email)||(g.email="Please enter a valid email address"):g.email="Email is required",r.password?r.password.length<Ge.PASSWORD_MIN_LENGTH?g.password=`Password must be at least ${Ge.PASSWORD_MIN_LENGTH} characters`:r.password.length>Ge.PASSWORD_MAX_LENGTH&&(g.password=`Password must be less than ${Ge.PASSWORD_MAX_LENGTH} characters`):g.password="Password is required",g},c=g=>{var D,S,E,P,R,v;return((D=g.response)==null?void 0:D.status)===400?((S=g.response.data)==null?void 0:S.error)||"Invalid registration data. Please check your input.":((E=g.response)==null?void 0:E.status)===409?"Username or email already exists. Please choose different credentials.":((P=g.response)==null?void 0:P.status)===201?((R=g.response.data)==null?void 0:R.error)||"Registration successful but email verification failed.":((v=g.response)==null?void 0:v.status)>=500?"Server error. Please try again later.":g.code==="NETWORK_ERROR"||!g.response?"Network error. Please check your connection.":"Registration failed. Please try again."},p=g=>{var D;return(D=g.data)!=null&&D.message?g.data.message:"Registration successful! Please check your email to verify your account."},f=g=>{t(be(I({},r),{[g.target.name]:g.target.value}))},w=g=>k(X,null,function*(){g.preventDefault(),o(!0),n("");const D=d();if(Object.keys(D).length>0){n(Object.values(D)[0]),o(!1);return}try{const S=yield Tt.register(r),E=p(S);n(E),t({username:"",email:"",password:""}),Mt.trackRegistration("email"),setTimeout(()=>{a("/login")},4e3)}catch(S){const E=c(S);n(E),Mt.trackError("registration_error",E,"register_form"),{}.VITE_DEBUG==="true"&&console.error("Registration error:",S)}finally{o(!1)}});return e.jsx(h,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",py:4},children:e.jsx(it,{maxWidth:"sm",children:e.jsxs(ie,{elevation:0,sx:{p:4,borderRadius:4,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(h,{sx:{textAlign:"center",mb:4},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:48,height:48,mr:2,borderRadius:2}}),e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:800,color:"#1e293b"},children:"Data Hibernate"})]}),e.jsx(l,{variant:"h6",sx:{color:"#64748b",fontWeight:400},children:"Join us! Create your account"})]}),s&&e.jsx(he,{severity:s.includes("successful")||s.includes("Registration successful")||s.includes("check your email")?"success":"error",sx:{mb:3,borderRadius:2},children:s}),e.jsxs(h,{component:"form",onSubmit:w,sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(tt,{name:"username",label:"Username",value:r.username,onChange:f,required:!0,fullWidth:!0,disabled:i,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(tt,{name:"email",label:"Email",type:"email",value:r.email,onChange:f,required:!0,fullWidth:!0,disabled:i,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(tt,{name:"password",type:"password",label:"Password",value:r.password,onChange:f,required:!0,fullWidth:!0,disabled:i,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(z,{type:"submit",variant:"contained",fullWidth:!0,disabled:i,sx:{mt:2,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:2,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 16px rgba(25, 118, 210, 0.3)","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #0d47a1 100%)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(25, 118, 210, 0.4)"},"&:disabled":{background:"rgba(25, 118, 210, 0.3)",color:"rgba(255, 255, 255, 0.7)"}},children:i?"Creating Account...":"Create Account"})]}),e.jsx(h,{sx:{mt:4,textAlign:"center"},children:e.jsxs(l,{variant:"body2",sx:{color:"#64748b"},children:["Already have an account?"," ",e.jsx(et,{component:xr,to:"/login",sx:{color:"#1976d2",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Login here"})]})})]})})})},va=()=>{const[r,t]=u.useState(""),[s,n]=u.useState(!1),[i,o]=u.useState(""),[a,d]=u.useState(""),c=vt(),p=f=>k(X,null,function*(){var w,g,D;if(f.preventDefault(),n(!0),d(""),o(""),!r){d("Email is required"),n(!1);return}try{const S=yield Tt.requestPasswordReset({email:r});o(S.data.message||"Password reset email sent successfully. Please check your email."),t(""),setTimeout(()=>{c("/login")},3e3)}catch(S){((w=S.response)==null?void 0:w.status)===200?(o("If an account with this email exists, a password reset email has been sent."),setTimeout(()=>{c("/login")},3e3)):d(((D=(g=S.response)==null?void 0:g.data)==null?void 0:D.error)||"Failed to send password reset email. Please try again.")}finally{n(!1)}});return e.jsx(h,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",py:4},children:e.jsx(it,{maxWidth:"sm",children:e.jsxs(ie,{elevation:0,sx:{p:4,borderRadius:4,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(h,{sx:{textAlign:"center",mb:4},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:48,height:48,mr:2,borderRadius:2}}),e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:800,color:"#1e293b"},children:"Data Hibernate"})]}),e.jsx(l,{variant:"h6",sx:{color:"#64748b",fontWeight:400},children:"Reset your password"})]}),a&&e.jsx(he,{severity:"error",sx:{mb:3,borderRadius:2},children:a}),i&&e.jsx(he,{severity:"success",sx:{mb:3,borderRadius:2},children:i}),e.jsxs(h,{component:"form",onSubmit:p,sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(tt,{name:"email",label:"Email Address",type:"email",value:r,onChange:f=>t(f.target.value),required:!0,fullWidth:!0,disabled:s,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(z,{type:"submit",variant:"contained",fullWidth:!0,disabled:s,sx:{mt:2,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:2,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 16px rgba(25, 118, 210, 0.3)","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #0d47a1 100%)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(25, 118, 210, 0.4)"},"&:disabled":{background:"rgba(25, 118, 210, 0.3)",color:"rgba(255, 255, 255, 0.7)"}},children:s?"Sending...":"Send Reset Email"})]}),e.jsx(h,{sx:{mt:4,textAlign:"center"},children:e.jsxs(l,{variant:"body2",sx:{color:"#64748b"},children:["Remember your password?"," ",e.jsx(et,{component:xr,to:"/login",sx:{color:"#1976d2",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Login here"})]})})]})})})},wa=()=>{const[r,t]=u.useState(""),[s,n]=u.useState(""),[i,o]=u.useState(!1),[a,d]=u.useState(""),[c,p]=u.useState(""),[f]=mn(),w=vt(),g=f.get("token");u.useEffect(()=>{g||p("Invalid reset link. Please request a new password reset.")},[g]);const D=S=>k(X,null,function*(){var E,P;if(S.preventDefault(),o(!0),p(""),d(""),!r){p("Password is required"),o(!1);return}if(r.length<8){p("Password must be at least 8 characters long"),o(!1);return}if(r!==s){p("Passwords do not match"),o(!1);return}if(!g){p("Invalid reset token"),o(!1);return}try{const R=yield Tt.resetPassword({token:g,password:r});d(R.data.message||"Password reset successfully. You can now login with your new password."),t(""),n(""),setTimeout(()=>{w("/login")},3e3)}catch(R){p(((P=(E=R.response)==null?void 0:E.data)==null?void 0:P.error)||"Failed to reset password. Please try again.")}finally{o(!1)}});return e.jsx(h,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",py:4},children:e.jsx(it,{maxWidth:"sm",children:e.jsxs(ie,{elevation:0,sx:{p:4,borderRadius:4,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(h,{sx:{textAlign:"center",mb:4},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:48,height:48,mr:2,borderRadius:2}}),e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:800,color:"#1e293b"},children:"Data Hibernate"})]}),e.jsx(l,{variant:"h6",sx:{color:"#64748b",fontWeight:400},children:"Set your new password"})]}),c&&e.jsx(he,{severity:"error",sx:{mb:3,borderRadius:2},children:c}),a&&e.jsx(he,{severity:"success",sx:{mb:3,borderRadius:2},children:a}),e.jsxs(h,{component:"form",onSubmit:D,sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(tt,{name:"password",label:"New Password",type:"password",value:r,onChange:S=>t(S.target.value),required:!0,fullWidth:!0,disabled:i,variant:"outlined",helperText:"Password must be at least 8 characters long",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(tt,{name:"confirmPassword",label:"Confirm New Password",type:"password",value:s,onChange:S=>n(S.target.value),required:!0,fullWidth:!0,disabled:i,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.8)"}}}),e.jsx(z,{type:"submit",variant:"contained",fullWidth:!0,disabled:i||!g,sx:{mt:2,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:2,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 16px rgba(25, 118, 210, 0.3)","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #0d47a1 100%)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(25, 118, 210, 0.4)"},"&:disabled":{background:"rgba(25, 118, 210, 0.3)",color:"rgba(255, 255, 255, 0.7)"}},children:i?"Resetting...":"Reset Password"})]}),e.jsx(h,{sx:{mt:4,textAlign:"center"},children:e.jsxs(l,{variant:"body2",sx:{color:"#64748b"},children:["Remember your password?"," ",e.jsx(et,{component:xr,to:"/login",sx:{color:"#1976d2",fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Login here"})]})})]})})})},_a=(r,t={})=>{if(!r)return"N/A";const n=I(I({},{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),t);return new Date(r).toLocaleString(void 0,n)},Sa=(r,t=2)=>r===0?"0 GB":`${(r/(1024*1024*1024)).toFixed(t)} GB`,Ys=()=>{var E,P;const[r,t]=u.useState(null),[s,n]=u.useState(null),[i,o]=u.useState(!0),[a,d]=u.useState(null);u.useEffect(()=>{c()},[]);const c=()=>k(X,null,function*(){try{o(!0),d(null);const[R,v]=yield Promise.all([Bt.getCurrentPlan(),Bt.getUsageStats()]);t(R.data),n(v.data)}catch(R){console.error("Error loading overview data:",R),d("Failed to load overview data")}finally{o(!1)}}),p=()=>{if(!r||!r.plan)return{name:"Free Tier",storage:"15 GB",color:"info",icon:e.jsx(ut,{}),description:"Free storage allowance"};const R=r.plan,N={"100gb":{storage:"100 GB",color:"primary"},"500gb":{storage:"500 GB",color:"warning"},"1tb":{storage:"1 TB",color:"error"}}[R.storage_tier]||{storage:"Unknown",color:"primary"};return{name:R.name.replace("_"," ").replace(/\b\w/g,b=>b.toUpperCase()),storage:N.storage,color:N.color,icon:e.jsx(jt,{}),description:R.description}},f=()=>{var b;if(!s)return 0;const v=(((b=s.current_storage)==null?void 0:b.bytes)||s.total_storage_bytes||0)/Gt(1024,3),N=r&&r.plan?r.plan.storage_tier==="100gb"?100:r.plan.storage_tier==="500gb"?500:1024:15;return Math.min(v/N*100,100)},w=()=>{const R=f();return R>=90?"error":R>=75?"warning":"primary"};if(i)return e.jsx(h,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Ae,{sx:{width:"100%",maxWidth:400}})});if(a)return e.jsx(he,{severity:"error",action:e.jsx(z,{color:"inherit",size:"small",onClick:c,children:"Retry"}),children:a});const g=p(),D=f(),S=w();return e.jsxs(h,{sx:{maxWidth:1200,mx:"auto",p:4},children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,children:[e.jsx(l,{variant:"h4",sx:{fontWeight:800,color:"text.primary"},children:"Storage Overview"}),e.jsx(Ne,{onClick:c,sx:{p:1.5,borderRadius:2,bgcolor:"grey.100",color:"text.secondary","&:hover":{bgcolor:"grey.200",transform:"scale(1.05)"},transition:"all 0.3s ease"},children:e.jsx(Xt,{})})]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{item:!0,xs:12,md:4,children:e.jsx(De,{sx:{height:"100%",borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.12)",transform:"translateY(-2px)"}},children:e.jsxs(Te,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(h,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(h,{sx:{p:1.5,borderRadius:2,bgcolor:"grey.100",color:"text.secondary",mr:2},children:g.icon}),e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:"text.primary"},children:"Current Plan"})]}),e.jsx(oe,{label:g.name,color:g.color,size:"large",sx:{mb:3,fontWeight:600,fontSize:"0.9rem",height:32}}),e.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx(l,{variant:"h3",sx:{fontWeight:800,color:"text.primary",mb:2},children:g.storage}),e.jsx(l,{variant:"body1",sx:{color:"text.secondary",mb:3,lineHeight:1.6},children:g.description})]}),r&&e.jsx(h,{sx:{p:2,bgcolor:"grey.50",borderRadius:2,border:"1px solid rgba(0,0,0,0.05)"},children:e.jsxs(l,{variant:"caption",sx:{color:"text.secondary",fontWeight:500},children:["Expires: ",_a(r.expires_at)]})})]})})}),e.jsx(T,{item:!0,xs:12,md:4,children:e.jsx(De,{sx:{height:"100%",borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.12)",transform:"translateY(-2px)"}},children:e.jsxs(Te,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(h,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(h,{sx:{p:1.5,borderRadius:2,bgcolor:"grey.100",color:"text.secondary",mr:2},children:e.jsx(Me,{})}),e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:"text.primary"},children:"Storage Usage"})]}),e.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx(l,{variant:"h3",sx:{fontWeight:800,color:"text.primary",mb:2},children:Sa((s==null?void 0:s.total_storage_bytes)||0)}),e.jsxs(h,{sx:{mb:3},children:[e.jsx(Ae,{variant:"determinate",value:D,color:S,sx:{height:10,borderRadius:5,mb:2,bgcolor:"grey.200","& .MuiLinearProgress-bar":{borderRadius:5}}}),e.jsxs(l,{variant:"body1",sx:{color:"text.secondary",fontWeight:500},children:[D.toFixed(1),"% of ",g.storage," used"]})]})]}),s&&e.jsx(h,{sx:{p:2,bgcolor:"grey.50",borderRadius:2,border:"1px solid rgba(0,0,0,0.05)"},children:e.jsxs(l,{variant:"caption",sx:{color:"text.secondary",fontWeight:500},children:[((P=(E=s.current_storage)==null?void 0:E.gb)==null?void 0:P.toFixed(1))||"0.0"," GB stored"]})})]})})}),e.jsx(T,{item:!0,xs:12,md:4,children:e.jsx(De,{sx:{height:"100%",borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.12)",transform:"translateY(-2px)"}},children:e.jsxs(Te,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(h,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(h,{sx:{p:1.5,borderRadius:2,bgcolor:"grey.100",color:"text.secondary",mr:2},children:e.jsx(Dt,{})}),e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:"text.primary"},children:"Account Status"})]}),e.jsx(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(h,{sx:{mb:3},children:[e.jsxs(h,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Le,{sx:{color:"text.secondary",mr:1}}),e.jsx(l,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:"Storage Active"})]}),e.jsxs(h,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Le,{sx:{color:"text.secondary",mr:1}}),e.jsx(l,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:"Encryption Enabled"})]}),e.jsxs(h,{display:"flex",alignItems:"center",children:[e.jsx(Le,{sx:{color:"text.secondary",mr:1}}),e.jsx(l,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:"Backup Secure"})]})]})}),e.jsx(h,{sx:{p:2,bgcolor:"grey.50",borderRadius:2,border:"1px solid rgba(0,0,0,0.05)"},children:e.jsx(l,{variant:"caption",sx:{color:"text.secondary",fontWeight:600},children:"✓ All systems operational"})})]})})}),e.jsx(T,{item:!0,xs:12,children:e.jsxs(ie,{sx:{p:4,borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)"},children:[e.jsx(l,{variant:"h5",sx:{fontWeight:700,mb:3,color:"text.primary"},children:"Quick Actions"}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(z,{variant:"contained",fullWidth:!0,startIcon:e.jsx(Me,{}),onClick:()=>window.location.href="/upload",sx:{py:2,borderRadius:2,fontSize:"1rem",fontWeight:600,boxShadow:"0 4px 12px rgba(0,0,0,0.15)","&:hover":{boxShadow:"0 6px 16px rgba(0,0,0,0.2)",transform:"translateY(-2px)"},transition:"all 0.3s ease"},children:"Upload Files"})}),e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(z,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(jt,{}),onClick:()=>{window.location.href="/dashboard#hibernate"},sx:{py:2,borderRadius:2,fontSize:"1rem",fontWeight:600,borderWidth:2,"&:hover":{borderWidth:2,transform:"translateY(-2px)"},transition:"all 0.3s ease"},children:"Manage Files"})}),e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(z,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(ut,{}),onClick:()=>window.location.href="/plans",sx:{py:2,borderRadius:2,fontSize:"1rem",fontWeight:600,borderWidth:2,"&:hover":{borderWidth:2,transform:"translateY(-2px)"},transition:"all 0.3s ease"},children:"View Plans"})})]})]})}),!r&&D>50&&e.jsx(T,{item:!0,xs:12,children:e.jsx(he,{severity:"warning",sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)"},action:e.jsx(z,{color:"inherit",size:"small",onClick:()=>window.location.href="/plans",sx:{fontWeight:600,borderRadius:2,px:2,py:1},children:"View Plans"}),children:e.jsxs(l,{variant:"body1",sx:{fontWeight:500},children:["You're using ",D.toFixed(1),"% of your free storage. Consider upgrading to a hibernation plan for more space and features."]})})})]})]})};class Ea{constructor(){this.razorpay=null}initializeRazorpay(t){if(typeof window!="undefined"){if(!t)throw new Error("Razorpay key ID is required");if(typeof window.Razorpay=="undefined")throw new Error("Razorpay script not loaded. Please refresh the page and try again.");const s={}.VITE_ENVIRONMENT==="production",n=s?"production":"development";this.razorpay=new window.Razorpay(I({key:t,currency:"INR",name:"Glacier Archival",description:"Hibernation Plan Subscription",image:"/logo.png",theme:{color:"#6b7280"}},s&&{modal:{ondismiss:()=>{console.log("Payment modal dismissed")}}})),console.log(`Razorpay initialized in ${n} mode with key: ${t.substring(0,10)}...`)}else throw new Error("Razorpay can only be initialized in browser environment")}createPaymentOrder(t,s){return k(this,null,function*(){var n,i,o,a;try{return(yield Pr.createOrder(t,s)).data}catch(d){throw console.error("Error creating payment order:",d),((n=d.response)==null?void 0:n.status)===500?new Error("Payment system is temporarily unavailable. Please contact support at support@datahibernate.in"):((i=d.response)==null?void 0:i.status)===400?new Error("Invalid payment request. Please refresh the page and try again."):d.response?new Error(((a=(o=d.response)==null?void 0:o.data)==null?void 0:a.error)||"Payment system is currently unavailable. Please contact support."):new Error("Network error. Please check your internet connection and try again.")}})}processPayment(t){return k(this,null,function*(){return new Promise((s,n)=>{if(!this.razorpay){n(new Error("Payment system is not initialized. Please refresh the page and try again."));return}const i={order_id:t.razorpay_order_id,amount:t.amount,currency:t.currency,name:t.plan.name,description:`${t.plan.storage_tier} - ${t.plan.name}`,prefill:{name:"",email:""},notes:{plan_id:t.plan.id,payment_id:t.payment_id},handler:o=>k(this,null,function*(){try{const a=yield Pr.verifyPayment(t.payment_id,o.razorpay_order_id,o.razorpay_payment_id,o.razorpay_signature);s({success:!0,paymentData:a.data,razorpayResponse:o})}catch(a){console.error("Payment verification failed:",a),n(new Error("Payment verification failed. Please contact support at support@datahibernate.in for assistance."))}}),modal:{ondismiss:()=>{n(new Error("Payment was cancelled. You can try again when ready."))}}};this.razorpay.open(i)})})}getPaymentStatus(t){return k(this,null,function*(){var s,n;try{return(yield Pr.getPaymentStatus(t)).data}catch(i){throw console.error("Error getting payment status:",i),new Error(((n=(s=i.response)==null?void 0:s.data)==null?void 0:n.error)||"Failed to get payment status")}})}formatAmount(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getPaymentMethods(){return[{id:"card",name:"Credit/Debit Card",icon:"💳"},{id:"upi",name:"UPI",icon:"📱"},{id:"netbanking",name:"Net Banking",icon:"🏦"},{id:"wallet",name:"Wallet",icon:"👛"}]}}const Kr=({onPlanSelect:r,currentPlan:t,onClose:s})=>{var qe,Y,Pe;Jt();const[n,i]=u.useState({}),[o,a]=u.useState(!0),[d,c]=u.useState(null),[p,f]=u.useState(null),[w,g]=u.useState(!1),[D]=u.useState(()=>new Ea),[S,E]=u.useState(!1),[P,R]=u.useState(null);u.useState(!1);const[v,N]=u.useState(0);u.useEffect(()=>{b()},[]);const b=()=>k(X,null,function*(){try{a(!0);const W=yield Bt.getPlansGroupedByTier();i(W.data.plans||W.data)}catch(W){c("Failed to load hibernation plans"),console.error("Error loading plans:",W)}finally{a(!1)}}),A=W=>k(X,null,function*(){try{E(!0),R(null);const J=(yield Bt.getPlansGroupedByTier()).data.razorpay_key_id,Ze=window.location.hostname==="localhost";if(!J)throw new Error("Payment system is currently unavailable. Please contact support at support@datahibernate.in");if(!Ze&&J==="rzp_test_1234567890")throw new Error("Payment system is not properly configured. Please contact support at support@datahibernate.in");D.initializeRazorpay(J);const Oe=yield D.createPaymentOrder(W.id,parseFloat(W.annual_price_inr)),Ft=yield D.processPayment(Oe);Ft.success&&(r(Ft.paymentData.plan),g(!1),alert("Payment successful! Your hibernation plan has been activated."))}catch(ue){console.error("Payment error:",ue);let J="Payment is currently unavailable. Please try again later or contact support.";ue.message.includes("Razorpay")?J="Payment system is temporarily unavailable. Please contact support at support@datahibernate.in for assistance.":ue.message.includes("network")||ue.message.includes("Network")?J="Network error occurred. Please check your internet connection and try again.":ue.message.includes("cancelled")?J="Payment was cancelled. You can try again when ready.":ue.message.includes("verification")&&(J="Payment verification failed. Please contact support at support@datahibernate.in."),R(J)}finally{E(!1)}}),K=W=>{switch(W){case"deep_freeze":return e.jsx(jt,{sx:{fontSize:40,color:"#4f46e5"}});case"flexible_archive":return e.jsx(Rr,{sx:{fontSize:40,color:"#2563eb"}});default:return e.jsx(ut,{sx:{fontSize:40,color:"#4f46e5"}})}},H=W=>{switch(W){case"deep_freeze":return"#4f46e5";case"flexible_archive":return"#2563eb";default:return"#4f46e5"}},pe=W=>{switch(W){case"deep_freeze":return"Deep Hibernate";case"flexible_archive":return"Smart Hibernate";default:return"Hibernation Plan"}},de=W=>{const ue={deep_freeze:{title:"Deep Hibernate",subtitle:"🌙 Long-term archival storage",description:"Perfect for memories, backups, and data you rarely need",icon:e.jsx(jt,{}),color:"#4f46e5",gradient:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)",lightColor:"#e0e7ff",darkColor:"#312e81",bgColor:"#f8fafc",textColor:"#1e293b"},flexible_archive:{title:"Smart Hibernate",subtitle:"🌤️ Flexible retrieval storage",description:"Balance between cost and accessibility for regular backups",icon:e.jsx(Rr,{}),color:"#2563eb",gradient:"linear-gradient(135deg, #2563eb 0%, #1e40af 100%)",lightColor:"#dbeafe",darkColor:"#1e3a8a",bgColor:"#f8fafc",textColor:"#1e293b"}};return ue[W]||ue.deep_freeze},je=W=>W===0?"Instant":W<1?"Minutes":`${W} hours`,ke=W=>{if(W==null||W==="NaN"||isNaN(W))return"0 GB";const ue=W/Gt(1024,3);return ue>=1e3?`${(ue/1024).toFixed(1)} TB`:`${ue.toFixed(0)} GB`};if(o)return e.jsx(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:400},children:e.jsx(Kt,{})});if(d)return e.jsx(he,{severity:"error",sx:{mb:2},children:d});const ne=["deep_freeze","flexible_archive"],Xe=ne[v],fe=n[Xe]||[],O=de(Xe);return e.jsxs(h,{sx:{p:4,maxWidth:1200,mx:"auto"},children:[e.jsxs(h,{sx:{textAlign:"center",mb:6},children:[e.jsx(l,{variant:"h3",sx:{mb:3,fontWeight:800,color:"#1e293b"},children:"Choose Your Hibernation Plan"}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",maxWidth:700,mx:"auto",lineHeight:1.6},children:"Select the perfect storage solution for your data needs. Each plan offers different balance between cost, storage capacity, and retrieval speed."})]}),e.jsx(ie,{sx:{mb:6,borderRadius:3,overflow:"hidden",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:e.jsx(as,{value:v,onChange:(W,ue)=>N(ue),variant:"fullWidth",sx:{"& .MuiTab-root":{py:3,px:4,fontSize:"1.1rem",fontWeight:700,textTransform:"none",transition:"all 0.3s ease"},"& .MuiTabs-indicator":{height:4,borderRadius:"2px 2px 0 0"}},children:ne.map((W,ue)=>{const J=de(W),Ze=n[W]||[],Oe=t&&Ze.some(Ft=>{var Nt;return Ft.id===((Nt=t.plan)==null?void 0:Nt.id)});return e.jsx(qt,{label:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:1,children:[J.icon,e.jsxs(h,{children:[e.jsx(l,{variant:"subtitle1",sx:{fontWeight:600},children:J.title}),e.jsx(l,{variant:"caption",sx:{color:"text.secondary"},children:J.subtitle})]}),Oe&&e.jsx(oe,{label:"Active",size:"small",color:"success",sx:{ml:1}})]}),sx:{background:v===ue?J.bgColor:"transparent",color:v===ue?J.textColor:"text.primary",border:v===ue?`2px solid ${J.color}`:"2px solid transparent","&:hover":{background:v===ue?J.bgColor:j(J.color,.05),border:`2px solid ${j(J.color,.3)}`}}},W)})})}),e.jsx(ie,{sx:{p:4,mb:6,background:O.bgColor,color:O.textColor,borderRadius:3,boxShadow:`0 8px 24px ${j(O.color,.1)}`,border:`1px solid ${j(O.color,.2)}`},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:3,children:[e.jsx(h,{sx:{p:3,borderRadius:"50%",bgcolor:O.lightColor,display:"flex",alignItems:"center",justifyContent:"center",border:`2px solid ${O.color}`},children:ur.cloneElement(O.icon,{sx:{fontSize:48,color:O.color}})}),e.jsxs(h,{children:[e.jsx(l,{variant:"h4",sx:{fontWeight:800,mb:2,color:O.textColor},children:O.title}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",lineHeight:1.5},children:O.description})]})]})}),e.jsx(T,{container:!0,spacing:4,children:fe.map((W,ue)=>{var Oe;const J=((Oe=t==null?void 0:t.plan)==null?void 0:Oe.id)===W.id,Ze=ue===1;return e.jsx(T,{item:!0,xs:12,md:4,children:e.jsxs(De,{sx:I(I({height:"100%",position:"relative",border:`2px solid ${j(O.color,.15)}`,borderRadius:4,transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)","&:hover":{transform:"translateY(-12px) scale(1.02)",boxShadow:`0 20px 60px ${j(O.color,.25)}`,borderColor:O.color}},J&&{borderColor:O.color,background:`linear-gradient(145deg, ${j(O.color,.05)} 0%, ${j(O.color,.02)} 100%)`,boxShadow:`0 8px 32px ${j(O.color,.15)}`}),Ze&&!J&&{borderColor:O.color,boxShadow:`0 8px 32px ${j(O.color,.2)}`,background:`linear-gradient(145deg, ${j(O.color,.02)} 0%, #ffffff 100%)`}),children:[Ze&&!J&&e.jsx(oe,{label:"★ Most Popular",sx:{position:"absolute",top:20,right:20,zIndex:1,bgcolor:O.color,color:"white",fontWeight:700,fontSize:"0.875rem",borderRadius:2,boxShadow:`0 4px 12px ${j(O.color,.3)}`}}),J&&e.jsx(oe,{label:"✓ Current Plan",sx:{position:"absolute",top:20,right:20,zIndex:1,bgcolor:"#10b981",color:"white",fontWeight:700,fontSize:"0.875rem",borderRadius:2,boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)"}}),e.jsx(Te,{sx:{p:4},children:e.jsxs(ee,{spacing:4,children:[e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(l,{variant:"h2",sx:{fontWeight:800,color:O.color,mb:2},children:ke(W.storage_size_bytes)}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{fontWeight:600},children:"Storage Capacity"})]}),e.jsxs(h,{sx:{textAlign:"center",p:3,bgcolor:O.lightColor,borderRadius:3,border:`1px solid ${j(O.color,.2)}`},children:[e.jsxs(l,{variant:"h3",sx:{fontWeight:800,mb:1,color:O.textColor},children:["₹",W.annual_price_inr]}),e.jsxs(l,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:["per year (₹",W.user_cost_inr,"/month)"]})]}),e.jsx(z,{fullWidth:!0,variant:J?"outlined":"contained",onClick:()=>A(W),disabled:J,sx:{bgcolor:J?"transparent":O.color,color:J?O.textColor:"white",borderColor:O.color,borderRadius:3,py:3,fontSize:"1.1rem",fontWeight:700,textTransform:"none",boxShadow:J?"none":`0 4px 16px ${j(O.color,.2)}`,transition:"all 0.3s ease","&:hover":{bgcolor:J?O.lightColor:O.darkColor,transform:J?"none":"translateY(-2px)",boxShadow:J?"none":`0 8px 24px ${j(O.color,.3)}`},"&:disabled":{bgcolor:"transparent",color:O.color,borderColor:O.color}},children:J?"✓ Current Plan":"Select Plan"})]})})]})},W.id)})}),e.jsxs(ie,{sx:{p:4,mt:6,background:O.bgColor,borderRadius:3,boxShadow:`0 4px 16px ${j(O.color,.08)}`,border:`1px solid ${j(O.color,.15)}`},children:[e.jsxs(l,{variant:"h5",sx:{fontWeight:700,mb:4,color:O.textColor,textAlign:"center"},children:[O.title," Features"]}),e.jsxs(T,{container:!0,spacing:4,children:[e.jsx(T,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2,p:3,bgcolor:j(O.color,.05),borderRadius:3,height:"100%"},children:[e.jsx(h,{sx:{p:2,bgcolor:O.lightColor,borderRadius:2},children:e.jsx(Xr,{sx:{fontSize:32,color:O.color}})}),e.jsxs(h,{children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700,mb:1,color:"text.primary"},children:"Restore Time"}),e.jsx(l,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:je(((qe=fe[0])==null?void 0:qe.restore_time_hours)||12)})]})]})}),e.jsx(T,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2,p:3,bgcolor:j(O.color,.05),borderRadius:3,height:"100%"},children:[e.jsx(h,{sx:{p:2,bgcolor:O.lightColor,borderRadius:2},children:e.jsx(Dt,{sx:{fontSize:32,color:O.color}})}),e.jsxs(h,{children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700,mb:1,color:"text.primary"},children:"Retrieval Allowance"}),e.jsx(l,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:((Y=fe[0])==null?void 0:Y.free_retrieval_gb)>0?`${fe[0].free_retrieval_gb} GB free every ${fe[0].retrieval_period_months} months`:"Unlimited retrievals"})]})]})}),e.jsx(T,{item:!0,xs:12,md:4,children:e.jsx(h,{sx:{p:3,bgcolor:j(O.color,.08),borderRadius:3,border:`1px solid ${j(O.color,.2)}`,textAlign:"center",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(l,{variant:"body1",sx:{fontStyle:"italic",fontWeight:500,color:O.textColor},children:['"',((Pe=fe[0])==null?void 0:Pe.user_message)||"Your data sleeps safely — wake it only when needed.",'"']})})})]})]}),e.jsxs(ft,{open:w,onClose:()=>g(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(mt,{sx:{textAlign:"center",pb:1},children:e.jsx(l,{variant:"h5",sx:{fontWeight:700},children:"Confirm Subscription"})}),e.jsx(yt,{children:p&&e.jsxs(ee,{spacing:3,children:[e.jsx(ie,{sx:{p:3,background:de(p.name).gradient,color:"white",borderRadius:2},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{p:2,borderRadius:"50%",bgcolor:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:K(p.name)}),e.jsxs(h,{children:[e.jsxs(l,{variant:"h6",sx:{fontWeight:700},children:[pe(p.name)," - ",ke(p.storage_size_bytes)]}),e.jsx(l,{variant:"body2",sx:{opacity:.9},children:p.description})]})]})}),P&&e.jsxs(he,{severity:"error",sx:{mb:2,borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)"},action:e.jsx(z,{color:"inherit",size:"small",onClick:()=>R(null),sx:{fontWeight:600,borderRadius:2,px:2,py:1},children:"Dismiss"}),children:[e.jsx(l,{variant:"body1",sx:{fontWeight:500},children:P}),P.includes("support@datahibernate.in")&&e.jsx(l,{variant:"body2",sx:{mt:1,opacity:.8},children:"We apologize for the inconvenience. Our team is working to resolve this issue."})]}),e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsxs(l,{variant:"h4",sx:{fontWeight:700,color:H(p.name)},children:["₹",p.annual_price_inr]}),e.jsxs(l,{variant:"body1",color:"text.secondary",children:["per year (₹",p.user_cost_inr,"/month)"]})]}),e.jsxs(ee,{spacing:2,children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xr,{sx:{fontSize:20,color:H(p.name)}}),e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Restore Time:"})," ",je(p.restore_time_hours)]})]}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Dt,{sx:{fontSize:20,color:H(p.name)}}),e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Retrieval:"})," ",p.free_retrieval_gb>0?`${p.free_retrieval_gb} GB free every ${p.retrieval_period_months} months`:"Unlimited retrievals"]})]})]}),e.jsx(he,{severity:"info",sx:{mt:2},children:e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Subscription Terms:"})," This plan will be active for 1 year from the date of purchase. You can cancel anytime, but no refunds will be provided for unused time."]})})]})}),e.jsxs(Zt,{sx:{p:3,pt:1},children:[e.jsx(z,{onClick:()=>g(!1),variant:"outlined",fullWidth:!0,sx:{mr:1},children:"Cancel"}),e.jsx(z,{onClick:()=>A(p),variant:"contained",disabled:S,startIcon:S?e.jsx(Kt,{size:20}):e.jsx(Le,{}),fullWidth:!0,sx:{ml:1},children:S?"Processing Payment...":"Pay & Subscribe"})]})]})]})},Dn=()=>{const r=Jt(),[t,s]=u.useState(null),[n,i]=u.useState(null),[o,a]=u.useState(!0),[d,c]=u.useState(null),[p,f]=u.useState(!1),[w,g]=u.useState(!1);u.useEffect(()=>{D()},[]);const D=()=>k(X,null,function*(){try{a(!0),c(null);const[H,pe]=yield Promise.allSettled([Bt.getCurrentPlan().catch(de=>{var je;if(((je=de.response)==null?void 0:je.status)===404)return{data:null};throw de}),Bt.getUsageStats()]);if(H.status==="fulfilled"){const de=H.value.data;de&&de.is_free_tier?s(null):s(de)}else H.status==="rejected"&&(console.error("Error loading current plan:",H.reason),s(null));pe.status==="fulfilled"?i(pe.value.data):pe.status==="rejected"&&(console.error("Error loading usage stats:",pe.reason),i(null))}catch(H){console.error("Error loading plan data:",H),c("Failed to load plan information")}finally{a(!1)}}),S=()=>k(X,null,function*(){g(!0),yield D(),g(!1)}),E=H=>{s({plan:H}),f(!1),D()},P=H=>{switch(H){case"deep_freeze":return e.jsx(jt,{sx:{fontSize:32,color:"#94a3b8"}});case"flexible_archive":return e.jsx(Rr,{sx:{fontSize:32,color:"#60a5fa"}});case"instant_archive":return e.jsx(Ur,{sx:{fontSize:32,color:"#34d399"}});default:return e.jsx(ut,{sx:{fontSize:32}})}},R=H=>{switch(H){case"deep_freeze":return"#94a3b8";case"flexible_archive":return"#60a5fa";case"instant_archive":return"#34d399";default:return r.palette.primary.main}},v=H=>{switch(H){case"deep_freeze":return"🌙 Hibernate (Deep Freeze Tier)";case"flexible_archive":return"🌤️ Smart Hibernate (Flexible Archive Tier)";case"instant_archive":return"⚡ Quick Hibernate (Instant Archive Tier)";default:return"Hibernation Plan"}},N=H=>{const pe=H/1073741824;return pe>=1e3?`${(pe/1024).toFixed(1)} TB`:`${pe.toFixed(1)} GB`},b=H=>{const pe=H/1073741824;return pe>=1e3?`${(pe/1024).toFixed(2)} TB`:`${pe.toFixed(2)} GB`};if(o)return e.jsx(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:400},children:e.jsx(Kt,{})});if(d)return e.jsx(he,{severity:"error",sx:{mb:2},children:d});if(!t)return e.jsxs(h,{sx:{p:3},children:[e.jsx(l,{variant:"h4",sx:{mb:3,textAlign:"center",fontWeight:700},children:"Storage Dashboard"}),(n==null?void 0:n.is_free_tier)&&e.jsxs(ie,{elevation:3,sx:{p:4,mb:4,borderRadius:2,border:"2px solid #6b7280",bgcolor:"rgba(107, 114, 128, 0.05)"},children:[e.jsxs(ee,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(ut,{sx:{fontSize:40,color:"#6b7280"}}),e.jsxs(h,{children:[e.jsx(l,{variant:"h5",sx:{fontWeight:700,color:"#6b7280"},children:"Free Tier - 15GB"}),e.jsx(l,{variant:"body1",color:"text.secondary",children:"Upload and manage files up to 15GB for free"})]})]}),e.jsx(oe,{label:"Free Tier",color:"primary",icon:e.jsx(Le,{}),sx:{fontSize:"1rem",height:32,px:1}})]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:"Storage Usage"}),e.jsxs(ee,{spacing:1,children:[e.jsxs(l,{variant:"body1",children:["Used: ",e.jsxs("strong",{children:[(n==null?void 0:n.storage_used_gb)||0," GB"]})," / ",(n==null?void 0:n.storage_limit_gb)||15," GB"]}),e.jsxs(l,{variant:"body1",children:["Percentage: ",e.jsxs("strong",{children:[(n==null?void 0:n.storage_used_percentage)||0,"%"]})]}),e.jsxs(h,{sx:{mt:2},children:[e.jsx(l,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Storage Usage"}),e.jsx(Ae,{variant:"determinate",value:(n==null?void 0:n.storage_used_percentage)||0,sx:{height:8,borderRadius:4,bgcolor:"rgba(107, 114, 128, 0.1)","& .MuiLinearProgress-bar":{bgcolor:"#6b7280"}}})]})]})]}),e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:"Upgrade Options"}),e.jsxs(ee,{spacing:1,children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Up to 1TB storage capacity"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Advanced hibernation features"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Priority support"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Cost-effective archival storage"})]})]})]}),e.jsx(h,{mt:4,display:"flex",justifyContent:"center",children:e.jsx(z,{variant:"contained",size:"large",onClick:()=>f(!0),sx:{textTransform:"none",fontWeight:600,px:4,py:1.5,bgcolor:"#6b7280","&:hover":{bgcolor:"#4b5563"}},children:"Upgrade to Hibernation Plan"})})]}),!(n!=null&&n.is_free_tier)&&e.jsx(he,{severity:"info",sx:{mb:3},children:"You don't have an active hibernation plan. Choose a plan to start storing your data efficiently."}),e.jsx(h,{sx:{textAlign:"center",mb:4},children:e.jsx(z,{variant:"contained",size:"large",onClick:()=>f(!0),sx:{textTransform:"none",fontWeight:600,px:4,py:1.5},children:"View Available Plans"})}),e.jsxs(ft,{open:p,onClose:()=>f(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsx(mt,{children:"Choose Your Hibernation Plan"}),e.jsx(yt,{children:e.jsx(Kr,{onPlanSelect:E,onClose:()=>f(!1)})})]})]});if(o)return e.jsx(h,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsx(Kt,{size:60})});if(!t)return e.jsxs(h,{sx:{p:3},children:[e.jsx(l,{variant:"h4",sx:{mb:3,textAlign:"center",fontWeight:700},children:"Storage Dashboard"}),(n==null?void 0:n.is_free_tier)&&e.jsxs(ie,{elevation:3,sx:{p:4,mb:4,borderRadius:2,border:"2px solid #6b7280",bgcolor:"rgba(107, 114, 128, 0.05)"},children:[e.jsxs(ee,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(ut,{sx:{fontSize:40,color:"#6b7280"}}),e.jsxs(h,{children:[e.jsx(l,{variant:"h5",sx:{fontWeight:700,color:"#6b7280"},children:"Free Tier - 15GB"}),e.jsx(l,{variant:"body1",color:"text.secondary",children:"Upload and manage files up to 15GB for free"})]})]}),e.jsx(oe,{label:"Free Tier",color:"primary",icon:e.jsx(Le,{}),sx:{fontSize:"1rem",height:32,px:1}})]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:"Storage Usage"}),e.jsxs(ee,{spacing:1,children:[e.jsxs(l,{variant:"body1",children:["Used: ",e.jsxs("strong",{children:[(n==null?void 0:n.storage_used_gb)||0," GB"]})," / ",(n==null?void 0:n.storage_limit_gb)||15," GB"]}),e.jsxs(l,{variant:"body1",children:["Percentage: ",e.jsxs("strong",{children:[(n==null?void 0:n.storage_used_percentage)||0,"%"]})]}),e.jsxs(h,{sx:{mt:2},children:[e.jsx(l,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Storage Usage"}),e.jsx(Ae,{variant:"determinate",value:(n==null?void 0:n.storage_used_percentage)||0,sx:{height:8,borderRadius:4,bgcolor:"rgba(107, 114, 128, 0.1)","& .MuiLinearProgress-bar":{bgcolor:"#6b7280"}}})]})]})]}),e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:"Upgrade Options"}),e.jsxs(ee,{spacing:1,children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Up to 1TB storage capacity"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Advanced hibernation features"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Priority support"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"• Cost-effective archival storage"})]})]})]}),e.jsx(h,{mt:4,display:"flex",justifyContent:"center",children:e.jsx(z,{variant:"contained",size:"large",onClick:()=>f(!0),sx:{textTransform:"none",fontWeight:600,px:4,py:1.5,bgcolor:"#6b7280","&:hover":{bgcolor:"#4b5563"}},children:"Upgrade to Hibernation Plan"})})]}),!(n!=null&&n.is_free_tier)&&e.jsx(he,{severity:"info",sx:{mb:3},children:"You don't have an active hibernation plan. Choose a plan to start storing your data efficiently."}),e.jsx(h,{sx:{textAlign:"center",mb:4},children:e.jsx(z,{variant:"contained",size:"large",onClick:()=>f(!0),sx:{textTransform:"none",fontWeight:600,px:4,py:1.5},children:"View Available Plans"})}),e.jsxs(ft,{open:p,onClose:()=>f(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsx(mt,{children:e.jsx(l,{variant:"h5",sx:{fontWeight:700},children:"Choose Your Hibernation Plan"})}),e.jsx(yt,{children:e.jsx(Kr,{onPlanSelect:E,currentPlan:t,onClose:()=>f(!1)})})]})]});const A=t.plan,K=R(A.name);return e.jsxs(h,{sx:{p:3},children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(l,{variant:"h4",sx:{fontWeight:700},children:"Hibernation Plan Dashboard"}),e.jsx(z,{startIcon:e.jsx(Xt,{}),onClick:S,disabled:w,sx:{textTransform:"none"},children:w?"Refreshing...":"Refresh"})]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(De,{sx:{height:"100%"},children:e.jsx(Te,{sx:{p:3},children:e.jsxs(ee,{spacing:2,children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{p:1.5,borderRadius:"50%",bgcolor:j(K,.1)},children:P(A.name)}),e.jsxs(h,{children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600},children:v(A.name)}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[N(A.storage_size_bytes)," Storage"]})]})]}),e.jsx(Vt,{}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Annual Price"}),e.jsxs(l,{variant:"h6",sx:{fontWeight:600},children:["₹",A.annual_price_inr]})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Monthly Cost"}),e.jsxs(l,{variant:"body1",children:["₹",A.user_cost_inr]})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Restore Time"}),e.jsx(oe,{label:A.restore_time_hours===0?"Instant":`${A.restore_time_hours} hours`,size:"small",sx:{bgcolor:j(K,.1),color:K}})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Free Retrieval"}),e.jsx(l,{variant:"body2",children:A.free_retrieval_gb>0?`${A.free_retrieval_gb} GB/${A.retrieval_period_months===1?"month":`${A.retrieval_period_months} months`}`:"Unlimited"})]}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(en,{}),onClick:()=>f(!0),sx:{textTransform:"none",borderColor:K,color:K},children:"Change Plan"})]})})})}),n&&e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{p:3},children:[e.jsx(l,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Usage Statistics"}),e.jsxs(ee,{spacing:3,children:[e.jsxs(h,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Storage Used"}),e.jsxs(l,{variant:"body2",sx:{fontWeight:600},children:[b(n.storage_used_bytes)," / ",b(n.storage_limit_bytes)]})]}),e.jsx(Ae,{variant:"determinate",value:n.storage_used_percentage,sx:{height:8,borderRadius:4,bgcolor:j(K,.1),"& .MuiLinearProgress-bar":{bgcolor:K,borderRadius:4}}}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[n.storage_used_percentage.toFixed(1),"% used"]})]}),A.free_retrieval_gb>0&&e.jsxs(h,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Retrieval Used"}),e.jsxs(l,{variant:"body2",sx:{fontWeight:600},children:[n.retrieval_used_gb.toFixed(1)," / ",n.retrieval_limit_gb," GB"]})]}),e.jsx(Ae,{variant:"determinate",value:n.retrieval_used_gb/n.retrieval_limit_gb*100,sx:{height:8,borderRadius:4,bgcolor:j("#f59e0b",.1),"& .MuiLinearProgress-bar":{bgcolor:"#f59e0b",borderRadius:4}}}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[n.retrieval_remaining_gb.toFixed(1)," GB remaining"]})]}),e.jsxs(h,{sx:{p:2,bgcolor:j("#f59e0b",.05),borderRadius:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Plan Expires"}),e.jsx(l,{variant:"body1",sx:{fontWeight:600},children:new Date(n.plan_expires_at).toLocaleDateString()}),n.is_expired&&e.jsx(he,{severity:"warning",sx:{mt:1},children:"Plan has expired"})]})]})]})})})]}),e.jsxs(ft,{open:p,onClose:()=>f(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsx(mt,{children:"Change Hibernation Plan"}),e.jsx(yt,{children:e.jsx(Kr,{currentPlan:t,onPlanSelect:E,onClose:()=>f(!1)})})]})]})},Ca="modulepreload",ka=function(r){return"/"+r},Ks={},xs=function(t,s,n){if(!s||s.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=ka(o),o in Ks)return;Ks[o]=!0;const a=o.endsWith(".css"),d=a?'[rel="stylesheet"]':"";if(!!n)for(let f=i.length-1;f>=0;f--){const w=i[f];if(w.href===o&&(!a||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${d}`))return;const p=document.createElement("link");if(p.rel=a?"stylesheet":Ca,a||(p.as="script",p.crossOrigin=""),p.href=o,document.head.appendChild(p),a)return new Promise((f,w)=>{p.addEventListener("load",f),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Ut={UPLOADED:"uploaded",ARCHIVING:"archiving",ARCHIVED:"archived",RESTORING:"restoring",RESTORED:"restored",FAILED:"failed"},Xs={[Ut.UPLOADED]:{name:"Awake",emoji:"☀️",color:"#4CAF50",description:"File is active and accessible",actionText:"Archive",actionIcon:"AcUnit",canArchive:!0,canRestore:!1,canDownload:!0,canDelete:!0},[Ut.ARCHIVING]:{name:"Falling Asleep",emoji:"🌙",color:"#FF9800",description:"File is being archived to cold storage",actionText:"Cancel",actionIcon:"Stop",canArchive:!1,canRestore:!1,canDownload:!1,canDelete:!1,isProcessing:!0},[Ut.ARCHIVED]:{name:"Hibernating",emoji:"❄️",color:"#2196F3",description:"File is in cold storage (cheaper)",actionText:"Restore",actionIcon:"CloudUpload",canArchive:!1,canRestore:!0,canDownload:!1,canDelete:!0},[Ut.RESTORING]:{name:"Waking Up",emoji:"🌅",color:"#9C27B0",description:"File is being restored from cold storage",actionText:"Cancel",actionIcon:"Stop",canArchive:!1,canRestore:!1,canDownload:!1,canDelete:!1,isProcessing:!0},[Ut.RESTORED]:{name:"Awake",emoji:"☀️",color:"#4CAF50",description:"File is restored and accessible",actionText:"Archive",actionIcon:"AcUnit",canArchive:!0,canRestore:!1,canDownload:!0,canDelete:!0},[Ut.FAILED]:{name:"Error",emoji:"⚠️",color:"#F44336",description:"Operation failed",actionText:"Retry",actionIcon:"Refresh",canArchive:!0,canRestore:!0,canDownload:!1,canDelete:!0,isError:!0}},Wt=r=>Xs[r]||Xs[Ut.UPLOADED];class Pa{constructor(){this.algorithm="AES-GCM",this.keyLength=256,this.ivLength=12,this.pbkdf2Iterations=1e5,this.saltLength=32}deriveKey(t,s){return k(this,null,function*(){const i=new TextEncoder().encode(t),o=yield crypto.subtle.importKey("raw",i,"PBKDF2",!1,["deriveKey"]);return yield crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:this.pbkdf2Iterations,hash:"SHA-256"},o,{name:this.algorithm,length:this.keyLength},!1,["encrypt","decrypt"])})}generateSalt(){return crypto.getRandomValues(new Uint8Array(this.saltLength))}generateIV(){return crypto.getRandomValues(new Uint8Array(this.ivLength))}encryptFile(t,s){return k(this,null,function*(){try{const n=this.generateSalt(),i=this.generateIV(),o=yield this.deriveKey(s,n),a=yield crypto.subtle.encrypt({name:this.algorithm,iv:i},o,t),d={algorithm:this.algorithm,keyLength:this.keyLength,ivLength:this.ivLength,pbkdf2Iterations:this.pbkdf2Iterations,salt:Array.from(n),iv:Array.from(i),version:"1.0",timestamp:Date.now()};return{encryptedData:a,metadata:d}}catch(n){throw console.error("Encryption failed:",n),new Error(`Encryption failed: ${n.message}`)}})}decryptFile(t,s,n){return k(this,null,function*(){try{if(!s||!s.salt||!s.iv)throw new Error("Invalid encryption metadata");const i=new Uint8Array(s.salt),o=new Uint8Array(s.iv),a=yield this.deriveKey(n,i);return yield crypto.subtle.decrypt({name:this.algorithm,iv:o},a,t)}catch(i){throw console.error("Decryption failed:",i),new Error(`Decryption failed: ${i.message}`)}})}encryptFileObject(t,s){return k(this,null,function*(){try{const n=yield t.arrayBuffer(),{encryptedData:i,metadata:o}=yield this.encryptFile(n,s);return{encryptedFile:new File([i],`encrypted_${t.name}`,{type:"application/octet-stream",lastModified:t.lastModified}),metadata:o}}catch(n){throw console.error("File encryption failed:",n),new Error(`File encryption failed: ${n.message}`)}})}decryptFileObject(t,s,n){return k(this,null,function*(){try{const i=yield t.arrayBuffer(),o=yield this.decryptFile(i,s,n),a=t.name.replace("encrypted_","");return new File([o],a,{type:s.originalType||"application/octet-stream",lastModified:t.lastModified})}catch(i){throw console.error("File decryption failed:",i),new Error(`File decryption failed: ${i.message}`)}})}verifyEncryption(t){return k(this,null,function*(){try{const s=new TextEncoder().encode("Glacier Archival E2E Encryption Test"),{encryptedData:n,metadata:i}=yield this.encryptFile(s,t),o=yield this.decryptFile(n,i,t),a=new TextDecoder().decode(s),d=new TextDecoder().decode(o);return a===d}catch(s){return console.error("Encryption verification failed:",s),!1}})}getEncryptionInfo(){return{algorithm:this.algorithm,keyLength:this.keyLength,pbkdf2Iterations:this.pbkdf2Iterations,features:["AES-GCM 256-bit encryption","PBKDF2 key derivation (100,000 iterations)","Random IV for each file","Authentication tags for integrity","Zero-knowledge architecture","Open source implementation"],securityLevel:"Military-grade",compliance:["FIPS 140-2","Common Criteria"]}}}class Ia{constructor(){this.encryption=new Pa,this.isEncryptionEnabled=!1,this.masterPassword=null,this.encryptionCache=new Map}initializeEncryption(t){return k(this,null,function*(){try{if(!t||t.length<8)throw new Error("Master password must be at least 8 characters");if(!(yield this.encryption.verifyEncryption(t)))throw new Error("Encryption verification failed");return this.masterPassword=t,this.isEncryptionEnabled=!0,console.log("E2E Encryption initialized successfully"),!0}catch(s){throw console.error("Encryption initialization failed:",s),this.isEncryptionEnabled=!1,this.masterPassword=null,s}})}disableEncryption(){this.isEncryptionEnabled=!1,this.masterPassword=null,this.encryptionCache.clear(),console.log("E2E Encryption disabled")}isEnabled(){return this.isEncryptionEnabled&&!!this.masterPassword}encryptFileForUpload(t,s=null){return k(this,null,function*(){if(!this.isEnabled())throw new Error("Encryption not initialized");try{s&&s(0,"Starting encryption...");const n={originalName:t.name,originalType:t.type,originalSize:t.size,originalLastModified:t.lastModified};s&&s(25,"Reading file data...");const{encryptedFile:i,metadata:o}=yield this.encryption.encryptFileObject(t,this.masterPassword);return s&&s(75,"Finalizing encryption..."),o.originalMetadata=n,this.encryptionCache.set(t.name,o),s&&s(100,"Encryption complete"),console.log(`File encrypted: ${t.name} (${t.size} → ${i.size} bytes)`),{encryptedFile:i,metadata:o}}catch(n){throw console.error("File encryption failed:",n),new Error(`Encryption failed: ${n.message}`)}})}decryptFileAfterDownload(t,s,n=null){return k(this,null,function*(){if(!this.isEnabled())throw new Error("Encryption not initialized");try{n&&n(0,"Starting decryption..."),n&&n(25,"Reading encrypted data...");const i=yield this.encryption.decryptFileObject(t,s,this.masterPassword);if(n&&n(75,"Restoring file properties..."),s.originalMetadata){const o=s.originalMetadata;Object.defineProperty(i,"name",{value:o.originalName,writable:!1}),Object.defineProperty(i,"type",{value:o.originalType,writable:!1})}return n&&n(100,"Decryption complete"),console.log(`File decrypted: ${t.name} (${t.size} → ${i.size} bytes)`),i}catch(i){throw console.error("File decryption failed:",i),new Error(`Decryption failed: ${i.message}`)}})}getEncryptionMetadata(t){return this.encryptionCache.get(t)||null}storeEncryptionMetadata(t,s){this.encryptionCache.set(t,s)}clearEncryptionMetadata(t){this.encryptionCache.delete(t)}getEncryptionStatus(){const t=this.encryption.getEncryptionInfo();return{enabled:this.isEnabled(),initialized:!!this.masterPassword,algorithm:t.algorithm,keyLength:t.keyLength,features:t.features,securityLevel:t.securityLevel,compliance:t.compliance,cachedFiles:this.encryptionCache.size}}testEncryption(){return k(this,null,function*(){if(!this.isEnabled())throw new Error("Encryption not initialized");try{const t=Date.now(),s="Glacier Archival E2E Encryption Test - "+new Date().toISOString(),n=new File([s],"test.txt",{type:"text/plain"}),{encryptedFile:i,metadata:o}=yield this.encryptFileForUpload(n),a=yield this.decryptFileAfterDownload(i,o),c=Date.now()-t,f=(yield a.text())===s;return{success:f,duration:c,originalSize:n.size,encryptedSize:i.size,decryptedSize:a.size,compressionRatio:(i.size/n.size).toFixed(2),message:f?"Encryption test passed":"Encryption test failed"}}catch(t){return{success:!1,error:t.message,message:"Encryption test failed"}}})}getMemoryUsage(){return{cacheSize:this.encryptionCache.size,cacheKeys:Array.from(this.encryptionCache.keys()),memoryEstimate:this.encryptionCache.size*1024}}clearCache(){this.encryptionCache.clear(),console.log("Encryption cache cleared")}}const Ye=new Ia,Ra={EXPEDITED:{label:"Quick Wake-Up",emoji:"⚡",time:"1-5 minutes",description:"Fastest restore option",cost:"High",technical:"Expedited"},STANDARD:{label:"Standard Wake-Up",emoji:"🌅",time:"3-5 hours",description:"Default restore option",cost:"Standard",technical:"Standard"},BULK:{label:"Slow Wake-Up",emoji:"🌄",time:"5-12 hours",description:"Cheapest restore option",cost:"Lowest",technical:"Bulk"}},Da=(r,t=!1)=>{const[s,n]=u.useState(!1),[i,o]=u.useState(!1),[a,d]=u.useState(null),[c,p]=u.useState(!1),[f,w]=u.useState(null),g=b=>k(X,null,function*(){try{const A=yield Re.downloadFile(b.id),{download_url:K,filename:H,file_size:pe,is_encrypted:de,encryption_metadata:je}=A.data;w({filename:H,file_size:pe,is_encrypted:de,encryption_metadata:je}),p(!0);const ke=yield fetch(K);if(!ke.ok)throw new Error(`Failed to download file: ${ke.status}`);const ne=yield ke.blob();let Xe=ne,fe=H;if(de&&je&&Ye.isEnabled())try{console.log(`Decrypting file: ${H}`);const Pe=new File([ne],H,{type:ne.type}),W=yield Ye.decryptFileAfterDownload(Pe,je,(ue,J)=>{console.log(`Decrypting ${H}: ${ue}% - ${J}`)});Xe=W,fe=W.name,console.log(`File decrypted successfully: ${H}`)}catch(Pe){throw console.error(`Decryption failed for ${H}:`,Pe),new Error(`Decryption failed: ${Pe.message}`)}else if(de&&!Ye.isEnabled())throw new Error("File is encrypted but encryption service is not enabled. Please set up your master password first.");const O=window.URL.createObjectURL(Xe),qe=document.createElement("a");return qe.href=O,qe.download=fe,document.body.appendChild(qe),qe.click(),document.body.removeChild(qe),window.URL.revokeObjectURL(O),p(!1),{success:!0,message:`Download started for ${fe}${de?" (decrypted)":""}`}}catch(A){throw console.error("Download failed:",A),p(!1),A}}),D=b=>k(X,null,function*(){var A,K;try{return b.status==="archived"?{success:!1,message:"File is already hibernated ❄️"}:b.status==="archiving"?{success:!1,message:"File is already hibernating... 🌙"}:b.status!=="uploaded"&&b.status!=="restored"?{success:!1,message:`Cannot hibernate file in ${b.status} state`}:(yield Re.archiveFile(b.id),{success:!0,message:`❄️ ${b.original_filename} is now hibernating!`})}catch(H){console.error("Archive failed:",H);const pe=((K=(A=H.response)==null?void 0:A.data)==null?void 0:K.error)||H.message||"Archive failed";throw alert(`Failed to hibernate file: ${pe}`),H}}),S=b=>k(X,null,function*(){return d(b),o(!0),{success:!0,message:"Restore dialog opened"}}),E=b=>k(X,null,function*(){try{const A=yield Re.restoreFile(a.id,b),H=`🌅 Wake-up initiated! Your file will be ready in ${Ra[b.toUpperCase()].time}.`;return o(!1),d(null),r&&(yield r()),{success:!0,message:H}}catch(A){throw console.error("Error restoring file:",A),A}}),P=(b,A=!1)=>k(X,null,function*(){if(!A&&!window.confirm(`🗑️ Delete "${b.original_filename}"?

This will permanently delete the file from:
• Database records
• S3 storage
• Glacier archives (if any)

This action cannot be undone.`))return{success:!1,message:"Delete cancelled"};try{return yield Re.deleteFile(b.id),r&&(yield r()),{success:!0,message:`🗑️ ${b.original_filename} deleted successfully`}}catch(K){throw console.error("Delete failed:",K),K}});return{loading:s,restoreDialogOpen:i,restoreFile:a,setRestoreDialogOpen:o,setRestoreFile:d,downloadDialogOpen:c,downloadInfo:f,setDownloadDialogOpen:p,setDownloadInfo:w,handleDownload:g,handleArchive:D,handleRestore:S,handleConfirmRestore:E,handleDelete:P,handleBulkAction:(b,A)=>k(X,null,function*(){try{switch(n(!0),b){case"archive":yield Promise.all(A.map(H=>Re.archiveFile(H.id)));break;case"restore":yield Promise.all(A.map(H=>Re.restoreFile(H.id,"Standard")));break;case"download":for(const H of A)yield g(H);break;case"delete":window.confirm(`Are you sure you want to delete ${A.length} files?

This will permanently delete all selected files from:
• Database records
• S3 storage
• Glacier archives (if any)

This action cannot be undone.`)&&(yield Promise.all(A.map(H=>P(H,!0))));break;default:console.warn("Unknown bulk action:",b)}return r&&(yield r(t)),{success:!0,message:`Bulk ${b} completed`}}catch(K){throw console.error(`Error performing bulk ${b}:`,K),K}finally{n(!1)}}),handleHibernationSuggestion:b=>k(X,null,function*(){try{yield Re.archiveFile(b.id);const A=`❄️ ${b.original_filename} is now hibernating! You'll save money on storage costs.`;return r&&(yield r(t)),{success:!0,message:A}}catch(A){throw console.error("Error hibernating file:",A),A}}),handleFileAction:(b,A)=>k(X,null,function*(){try{n(!0);let K;switch(A){case"download":K=yield g(b);break;case"archive":K=yield D(b);break;case"restore":K=yield S(b);break;case"delete":K=yield P(b);break;default:console.warn("Unknown action:",A),K={success:!1,message:`Unknown action: ${A}`}}return K}catch(K){throw console.error(`Error performing ${A} action:`,K),K}finally{n(!1)}})}},Ta=({error:r,onDismiss:t,onUpgrade:s})=>{const n=vt(),i=()=>{s?s():n("/plans")},o=()=>{t&&t()};if(!r)return null;const a=r.type==="STORAGE_LIMIT_EXCEEDED",d=r.currentPlan||r.plan_required;return e.jsx(he,{severity:"error",sx:{mb:3,borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)"},action:e.jsxs(ee,{direction:"row",spacing:1,children:[e.jsx(z,{color:"inherit",size:"small",onClick:o,sx:{fontWeight:600,borderRadius:2,px:2,py:1},children:"Dismiss"}),(a||d)&&e.jsx(z,{variant:"contained",size:"small",onClick:i,sx:{fontWeight:600,borderRadius:2,px:2,py:1,bgcolor:"primary.main","&:hover":{bgcolor:"primary.dark"}},children:"Upgrade Plan"})]}),children:e.jsxs(h,{children:[e.jsx(l,{variant:"body1",sx:{fontWeight:500,mb:1},children:r.message}),(r.currentUsageGB||r.current_usage_gb)&&e.jsxs(h,{sx:{mt:2},children:[e.jsxs(ee,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Current Usage:"}),e.jsx(oe,{label:`${r.currentUsageGB||r.current_usage_gb}GB`,size:"small",color:"primary",variant:"outlined"})]}),r.remainingGB!==void 0&&e.jsxs(ee,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Remaining Space:"}),e.jsx(oe,{label:`${r.remainingGB}GB`,size:"small",color:parseFloat(r.remainingGB)>0?"success":"error",variant:"outlined"})]}),r.plan_limit_gb&&e.jsxs(h,{sx:{mt:2},children:[e.jsxs(ee,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Storage Usage"}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[r.current_usage_gb,"GB / ",r.plan_limit_gb,"GB"]})]}),e.jsx(Ae,{variant:"determinate",value:r.current_usage_gb/r.plan_limit_gb*100,sx:{height:8,borderRadius:4,bgcolor:"grey.200","& .MuiLinearProgress-bar":{bgcolor:parseFloat(r.current_usage_gb)/parseFloat(r.plan_limit_gb)>.8?"error.main":"primary.main"}}})]})]}),(a||d)&&e.jsx(l,{variant:"body2",sx:{mt:2,opacity:.8},children:r.upgrade_message||"Upgrade to a hibernation plan to get more storage space and continue uploading."})]})})};class Fa{constructor(){this.dbName="GlacierArchivalDB",this.version=1,this.db=null}init(){return k(this,null,function*(){return new Promise((t,s)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>s(n.error),n.onsuccess=()=>{this.db=n.result,t(this.db)},n.onupgradeneeded=i=>{const o=i.target.result;if(!o.objectStoreNames.contains("files")){const a=o.createObjectStore("files",{keyPath:"id"});a.createIndex("userId","userId",{unique:!1}),a.createIndex("timestamp","timestamp",{unique:!1})}if(!o.objectStoreNames.contains("uploads")){const a=o.createObjectStore("uploads",{keyPath:"id"});a.createIndex("timestamp","timestamp",{unique:!1}),a.createIndex("retryCount","retryCount",{unique:!1})}o.objectStoreNames.contains("metadata")||o.createObjectStore("metadata",{keyPath:"key"})}})})}storeFile(n){return k(this,arguments,function*(t,s={}){return this.db||(yield this.init()),new Promise((i,o)=>{const d=this.db.transaction(["files"],"readwrite").objectStore("files"),c={id:Date.now()+Math.random(),name:t.name,type:t.type,size:t.size,data:t,metadata:be(I({},s),{timestamp:Date.now(),userId:s.userId||"anonymous"})},p=d.add(c);p.onsuccess=()=>i(c.id),p.onerror=()=>o(p.error)})})}getFile(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const a=this.db.transaction(["files"],"readonly").objectStore("files").get(t);a.onsuccess=()=>s(a.result),a.onerror=()=>n(a.error)})})}getUserFiles(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const d=this.db.transaction(["files"],"readonly").objectStore("files").index("userId").getAll(t);d.onsuccess=()=>s(d.result),d.onerror=()=>n(d.error)})})}deleteFile(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const a=this.db.transaction(["files"],"readwrite").objectStore("files").delete(t);a.onsuccess=()=>s(),a.onerror=()=>n(a.error)})})}storeUploadQueueItem(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const o=this.db.transaction(["uploads"],"readwrite").objectStore("uploads"),a=be(I({id:Date.now()+Math.random()},t),{timestamp:Date.now(),retryCount:0}),d=o.add(a);d.onsuccess=()=>s(a.id),d.onerror=()=>n(d.error)})})}getQueuedUploads(){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((t,s)=>{const o=this.db.transaction(["uploads"],"readonly").objectStore("uploads").getAll();o.onsuccess=()=>t(o.result),o.onerror=()=>s(o.error)})})}removeQueuedUpload(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const a=this.db.transaction(["uploads"],"readwrite").objectStore("uploads").delete(t);a.onsuccess=()=>s(),a.onerror=()=>n(a.error)})})}storeMetadata(t,s){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((n,i)=>{const d=this.db.transaction(["metadata"],"readwrite").objectStore("metadata").put({key:t,value:s,timestamp:Date.now()});d.onsuccess=()=>n(),d.onerror=()=>i(d.error)})})}getMetadata(t){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((s,n)=>{const a=this.db.transaction(["metadata"],"readonly").objectStore("metadata").get(t);a.onsuccess=()=>{var d;return s((d=a.result)==null?void 0:d.value)},a.onerror=()=>n(a.error)})})}getStorageUsage(){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((t,s)=>{const o=this.db.transaction(["files"],"readonly").objectStore("files").getAll();o.onsuccess=()=>{const a=o.result,d=a.reduce((c,p)=>c+p.size,0);t({fileCount:a.length,totalSize:d,totalSizeMB:Math.round(d/(1024*1024)*100)/100})},o.onerror=()=>s(o.error)})})}clearAll(){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((t,s)=>{const n=this.db.transaction(["files","uploads","metadata"],"readwrite");n.objectStore("files").clear(),n.objectStore("uploads").clear(),n.objectStore("metadata").clear(),n.oncomplete=()=>t(),n.onerror=()=>s(n.error)})})}clearUploadQueue(){return k(this,null,function*(){return this.db||(yield this.init()),new Promise((t,s)=>{const o=this.db.transaction(["uploads"],"readwrite").objectStore("uploads").clear();o.onsuccess=()=>t(),o.onerror=()=>s(o.error)})})}exportData(){return k(this,null,function*(){this.db||(yield this.init());const t=yield this.getUserFiles("all"),s=yield this.getQueuedUploads();return{files:t,uploads:s,exportDate:new Date().toISOString()}})}importData(t){return k(this,null,function*(){this.db||(yield this.init());try{for(const s of t.files||[])yield this.storeFile(s.data,s.metadata);for(const s of t.uploads||[])yield this.storeUploadQueueItem(s);return!0}catch(s){return console.error("Error importing data:",s),!1}})}}const Ct=new Fa;class Aa{constructor(){this.queue=[],this.subscribers=new Set,this.isRunning=!1,this.concurrent=cr.maxConcurrentUploads,this.activeCount=0,this.initialized=!1,this._emitThrottled=this._throttle(this._emit.bind(this),200),this.activeWorkers=new Set,this._uploadSessionActive=!1,this._currentSessionTotal=0,this._cumulativeCompleted=0}_throttle(t,s){let n,i=0;return function(...o){const a=Date.now();a-i>s?(t.apply(this,o),i=a):(clearTimeout(n),n=setTimeout(()=>{t.apply(this,o),i=Date.now()},s-(a-i)))}}init(){return k(this,null,function*(){if(this.initialized)return;yield Ct.init();const t=yield Ct.getQueuedUploads();this.queue=(t||[]).map(s=>({id:s.id,file:s.file||null,relativePath:s.relativePath||"",status:s.status||"queued",progress:s.progress||0,s3Key:s.s3Key||"",error:void 0})),this.initialized=!0,this._emit()})}subscribe(t){this.subscribers.add(t);try{t(this.getState())}catch(s){}return()=>this.subscribers.delete(t)}getState(){const t=new Map,s=new Map;let n=0,i=0,o=0,a=0,d=0,c=0;for(const v of this.queue){t.set(v.status,(t.get(v.status)||0)+1);const N=v.operationType||"upload";s.set(N,(s.get(N)||0)+1),N==="upload"&&(c+=1,v.status==="queued"?i+=1:v.status==="uploading"?o+=1:v.status==="failed"?a+=1:v.status==="completed"&&(d+=1)),n+=v.size||0}const p=t.get("queued")||0,f=t.get("uploading")||0,w=t.get("failed")||0,g=t.get("completed")||0,D=s.get("delete")||0,S=t.get("deleting")||0,E=this.queue.slice(-50).map(v=>({id:v.id,relativePath:v.relativePath,status:v.status,progress:v.progress,s3Key:v.s3Key,error:v.error,name:v.name,operationType:v.operationType||"upload"})),P=this.queue.filter(v=>v.operationType==="delete").slice(-10).map(v=>({id:v.id,status:v.status,progress:v.progress,completedFiles:v.completedFiles,totalFiles:v.totalFiles,error:v.error}));return{isRunning:f>0,activeCount:f,total:this.queue.length,queued:p,inProgress:f,failed:w,completed:g,uploadTotal:this._uploadSessionActive?this._currentSessionTotal:c,uploadQueued:i,uploadInProgress:o,uploadFailed:a,uploadCompleted:this._uploadSessionActive?this._cumulativeCompleted:d,items:E,deleteOperations:P,deleteOperationsCount:D,deleteInProgress:S,totalSize:n,percentage:this.queue.length>0?Math.round(g/this.queue.length*100):0}}_cleanupCompletedItems(){if(this._uploadSessionActive)return;const t=1e4;if(this.queue.length>t){const s=this.queue.filter(n=>n.status==="completed");if(s.length>0){s.sort((i,o)=>i.id.localeCompare(o.id));const n=s.slice(0,Math.min(s.length,this.queue.length-t));this.queue=this.queue.filter(i=>!n.includes(i))}}}cleanupCompletedItems(){this._cleanupCompletedItems()}startUploadSession(t){this._uploadSessionActive=!0,this._currentSessionTotal=t,this._cumulativeCompleted=0}endUploadSession(){return k(this,null,function*(){this._uploadSessionActive=!1,this._currentSessionTotal=0,this._cumulativeCompleted=0;try{const t=this.queue.filter(s=>s.status==="completed"&&s.fileId).map(s=>s.fileId);if(t.length>0){const{mediaAPI:s}=yield xs(()=>Promise.resolve().then(()=>bn),void 0);yield s.markUploadComplete(t),console.log(`Marked ${t.length} files as upload complete`)}}catch(t){console.error("Failed to mark upload as complete:",t)}this._cleanupCompletedItems()})}incrementCompleted(){this._cumulativeCompleted+=1,this._emitThrottled()}addPlaceholder(t,s=""){const n=`ext_${Date.now()}_${Math.random().toString(16).slice(2)}`,i={id:n,file:null,relativePath:s,status:"queued",progress:0,s3Key:"",error:void 0,name:t,operationType:"upload"};return this.queue.push(i),this._emitThrottled(),n}addPlaceholdersBatch(t){const s=[],n=Date.now(),i=t.map((o,a)=>({id:`ext_${n}_${a}_${Math.random().toString(16).slice(2)}`,file:null,relativePath:o.relativePath||"",status:"queued",progress:0,s3Key:"",error:void 0,name:o.name,size:o.size||0,operationType:"upload"}));return this.queue.push(...i),s.push(...i.map(o=>o.id)),this._emitThrottled(),s}addDeleteOperation(t,s="delete"){const n=`del_${Date.now()}_${Math.random().toString(16).slice(2)}`,i={id:n,file:null,relativePath:"",status:"queued",progress:0,s3Key:"",error:void 0,name:`${s} operation`,operationType:s,fileIds:t,totalFiles:t.length,completedFiles:0};return this.queue.push(i),this._emitThrottled(),n}updatePlaceholder(t,{status:s,progress:n,error:i}){const o=this.queue.find(a=>a.id===t);if(!o){console.log(`Placeholder ${t} not found in queue`);return}typeof s=="string"&&(o.status=s),typeof n=="number"&&(o.progress=n),i!==void 0&&(o.error=i),this._emit()}updateDeleteOperation(t,{status:s,progress:n,completedFiles:i,error:o}){const a=this.queue.find(d=>d.id===t);a&&(typeof s=="string"&&(a.status=s),typeof n=="number"&&(a.progress=n),typeof i=="number"&&(a.completedFiles=i),o!==void 0&&(a.error=o),this._emit())}addFile(n){return k(this,arguments,function*(t,{relativePath:s=""}={}){yield this.init();const i=Date.now()+Math.random(),o={id:i,file:t,relativePath:s,status:"queued",progress:0,s3Key:""};return this.queue.push(o),yield Ct.storeUploadQueueItem({id:i,relativePath:s,status:"queued",progress:0}),this._emit(),this.isRunning&&this._tick(),i})}start(){this.isRunning=!0,this._emit(),this._tick()}pause(){this.isRunning=!1,this._emit()}cancel(t){return k(this,null,function*(){yield this.init(),this.queue=this.queue.filter(s=>s.id!==t),yield Ct.removeQueuedUpload(t),this._emit()})}clearAll(){return k(this,null,function*(){yield this.init(),this.queue=[],yield Ct.clearUploadQueue(),this._emit()})}registerWorker(t){this.activeWorkers.add(t)}unregisterWorker(t){this.activeWorkers.delete(t)}cancelAllUploads(){return k(this,null,function*(){yield this.init(),this.queue.forEach(t=>{t.operationType==="upload"&&(t.status==="queued"||t.status==="uploading")&&(t.status="cancelled",t.progress=0,t.error="Upload cancelled")}),this.activeCount=0,this.isRunning=!1,this.activeWorkers.forEach(t=>{try{t.postMessage({type:"cancel"}),setTimeout(()=>{t.terminate()},100)}catch(s){console.warn("Error cancelling worker:",s)}}),this.activeWorkers.clear(),yield Ct.clearUploadQueue(),this._emit(),window.dispatchEvent(new CustomEvent("cancelAllUploads")),window.dispatchEvent(new CustomEvent("cancelUpload"))})}_tick(){return k(this,null,function*(){if(this.isRunning)for(;this.activeCount<this.concurrent;){const t=this.queue.find(s=>s.status==="queued");if(!t)break;this._upload(t).catch(()=>{})}})}_upload(t){return k(this,null,function*(){this.activeCount+=1,t.status="uploading",t.progress=0,yield this._persistItem(t),this._emitThrottled();try{const n=(yield Re.getPresignedUrls({files:[{filename:t.file.name,fileType:t.file.type||"application/octet-stream",fileSize:t.file.size||0,relativePath:t.relativePath||""}]})).data.results[0],{url:i,fields:o}=n.presignedUrl||{},a=n.s3Key,d=n.fileId,c=new FormData;Object.entries(o||{}).forEach(([p,f])=>c.append(p,f)),c.append("file",t.file),yield this._xhrPost(i,c,p=>{t.progress=p,this._emitThrottled()}),t.status="completed",t.progress=100,t.s3Key=a,t.fileId=d,yield this._persistItem(t),this._emitThrottled(),this._cumulativeCompleted+=1}catch(s){t.status="failed",t.error=(s==null?void 0:s.message)||String(s),yield this._persistItem(t),this._emitThrottled()}finally{this.activeCount-=1,t.status==="completed"&&(yield Ct.removeQueuedUpload(t.id),this.queue=this.queue.filter(s=>s.id!==t.id),this._emitThrottled()),this.isRunning&&this._tick()}})}bulkUpload(t,s=""){return k(this,null,function*(){if(yield this.init(),t.length!==0){this.startUploadSession(t.length);try{const n=cr.bulkBatchSize,i=[];for(let o=0;o<t.length;o+=n)i.push(t.slice(o,o+n));console.log(`Processing ${t.length} files in ${i.length} batches of ${n}`);for(let o=0;o<i.length;o++){const a=i[o],d=a.map(w=>({filename:w.name,fileType:w.type||"application/octet-stream",fileSize:w.size||0,relativePath:s})),c=yield Re.getPresignedUrls({files:d}),{results:p}=c.data,f=a.map((w,g)=>{const D=`bulk_${Date.now()}_${o}_${g}_${Math.random().toString(16).slice(2)}`,S=p[g];return{id:D,file:w,relativePath:s,status:"queued",progress:0,s3Key:S.s3Key,presignedUrl:S.presignedUrl,fileId:S.fileId,error:void 0,operationType:"upload"}});this.queue.push(...f),this._emitThrottled(),o<i.length-1&&(yield new Promise(w=>setTimeout(w,100)))}this.start()}catch(n){console.error("Bulk upload failed:",n),this.queue.forEach(i=>{i.operationType==="upload"&&i.status==="queued"&&(i.status="failed",i.error=n.message||"Bulk upload failed")}),this._emit()}finally{this.endUploadSession()}}})}_bulkUploadItem(t){return k(this,null,function*(){t.status="uploading",t.progress=0,this._emit();try{const{url:s,fields:n}=t.presignedUrl||{};if(!s||!n)throw new Error("Invalid presigned URL response");const i=new FormData;Object.entries(n).forEach(([o,a])=>i.append(o,a)),i.append("file",t.file),yield this._xhrPost(s,i,o=>{t.progress=o,this._emitThrottled()}),t.status="completed",t.progress=100,this._emit()}catch(s){t.status="failed",t.error=s.message||"Upload failed",this._emit()}})}_xhrPost(t,s,n){return new Promise((i,o)=>{const a=new XMLHttpRequest;a.open("POST",t,!0),a.upload.onprogress=d=>{if(!d.lengthComputable)return;const c=Math.round(d.loaded/d.total*100);try{n==null||n(c)}catch(p){}},a.onload=()=>{a.status>=200&&a.status<300?i():o(new Error(`Upload failed with status ${a.status}`))},a.onerror=()=>o(new Error("Network error during upload")),a.send(s)})}_persistItem(t){return k(this,null,function*(){yield Ct.storeUploadQueueItem({id:t.id,relativePath:t.relativePath,status:t.status,progress:t.progress,s3Key:t.s3Key||""})})}_emit(){const t=this.getState();this.subscribers.forEach(s=>{try{s(t)}catch(n){}})}_emitThrottled(){this._throttleTimer||(this._throttleTimer=setTimeout(()=>{this._throttleTimer=null,this._emit()},200))}}const re=new Aa,Je=(r,t=2)=>{if(r===0)return"0 Bytes";const s=1024,n=t<0?0:t,i=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(r)/Math.log(s));return parseFloat((r/Math.pow(s,o)).toFixed(n))+" "+i[o]},Wa=r=>{const t=[];return r.size>Ve.MAX_FILE_SIZE&&t.push({type:"FILE_SIZE_EXCEEDED",message:dr.FILE_SIZE_EXCEEDED,details:`File "${r.name}" is ${Je(r.size)}, maximum allowed is ${Je(Ve.MAX_FILE_SIZE)}`}),r.name.length>255&&t.push({type:"FILENAME_TOO_LONG",message:"Filename too long",details:`File "${r.name}" has ${r.name.length} characters, maximum allowed is 255`}),{isValid:t.length===0,errors:t}},os=r=>{const t=[],s=[];let n=0,i=0;return r.length>Ve.MAX_FILES&&t.push({type:"TOO_MANY_FILES",message:dr.TOO_MANY_FILES,details:`Selected ${r.length} files, maximum allowed is ${Ve.MAX_FILES}`}),r.forEach((o,a)=>{const d=Wa(o);d.isValid?(i++,n+=o.size):t.push(...d.errors)}),n>Ve.MAX_TOTAL_SIZE&&t.push({type:"TOTAL_SIZE_EXCEEDED",message:dr.TOTAL_SIZE_EXCEEDED,details:`Total size is ${Je(n)}, maximum allowed is ${Je(Ve.MAX_TOTAL_SIZE)}`}),n>Ve.MAX_SESSION_SIZE&&t.push({type:"SESSION_SIZE_EXCEEDED",message:dr.SESSION_SIZE_EXCEEDED,details:`Session size is ${Je(n)}, maximum allowed is ${Je(Ve.MAX_SESSION_SIZE)}`}),n>Ve.MEMORY_LIMIT&&s.push({type:"MEMORY_LIMIT_WARNING",message:"Large upload detected",details:`Uploading ${Je(n)}. This may take a while.`}),{isValid:t.length===0,errors:t,warnings:s,stats:{totalFiles:r.length,validFiles:i,invalidFiles:r.length-i,totalSize:n,averageFileSize:i>0?n/i:0}}},Js=r=>k(X,null,function*(){try{const{hibernationAPI:t}=yield xs(()=>Promise.resolve().then(()=>bn),void 0),n=(yield t.getStorageUsage()).data;if(n.current_usage_bytes+r>n.limit_bytes){const o=n.current_usage_gb,a=r/Gt(1024,3),d=n.remaining_gb;return{canUpload:!1,error:{type:"STORAGE_LIMIT_EXCEEDED",message:`Storage limit exceeded! You've used ${o}GB of your ${n.limit_gb}GB ${n.plan_type==="free_tier"?"free tier":n.plan_name}. This upload would add ${a.toFixed(1)}GB, but you only have ${d}GB remaining.`,details:`Current usage: ${Je(n.current_usage_bytes)}, adding ${Je(r)} would exceed the ${Je(n.limit_bytes)} limit`,currentUsageGB:o,fileSizeGB:a.toFixed(1),remainingGB:d,planType:n.plan_type,planName:n.plan_name,limitGB:n.limit_gb,upgradeRequired:!0}}}return{canUpload:!0,remainingSpace:n.remaining_bytes-r,storageData:n}}catch(t){console.error("Error checking storage limit:",t);const s=15*1024*1024*1024,n=r/Gt(1024,3);return r>s?{canUpload:!1,error:{type:"STORAGE_LIMIT_EXCEEDED",message:`File size ${n.toFixed(1)}GB exceeds the 15GB free tier limit. Please upgrade to a hibernation plan.`,details:`File size: ${Je(r)}, Free tier limit: ${Je(s)}`,fileSizeGB:n.toFixed(1),upgradeRequired:!0}}:{canUpload:!0,remainingSpace:s-r}}}),Zs=r=>{const t=os(r).stats;return t.totalSize>Ve.MEMORY_LIMIT?"streaming":t.totalFiles>100?"batched":"standard"},Qs=(r,t=8)=>r>=t?{canStart:!1,error:{type:"CONCURRENT_UPLOAD_LIMIT",message:dr.CONCURRENT_UPLOAD_LIMIT,details:`Currently ${r} uploads in progress, maximum allowed is ${t}`}}:{canStart:!0,remainingSlots:t-r},Tn=({onUploadComplete:r,onUploadProgress:t,defaultRelativePath:s=""})=>{const[n,i]=u.useState(!1),[o,a]=u.useState(0),[d,c]=u.useState(""),[p,f]=u.useState([]),[w,g]=u.useState([]),[D,S]=u.useState(!1),[E,P]=u.useState(null),[R,v]=u.useState([]),[N,b]=u.useState([]),[A,K]=u.useState(null),[H,pe]=u.useState("standard"),[de,je]=u.useState(null),[ke,ne]=u.useState(!1),[Xe,fe]=u.useState([]),[O,qe]=u.useState(!1),Y=u.useRef(null),Pe=u.useRef(null);u.useRef(null);const W=u.useRef(!1);u.useEffect(()=>{const _=()=>{const q=Ye.getEncryptionStatus();qe(q.enabled)};_();const F=setInterval(_,1e3);return()=>clearInterval(F)},[]);const ue=u.useCallback(_=>k(X,null,function*(){if(W.current||n){console.warn("Cannot select files while upload is in progress");return}const F=Array.from(_.target.files);if(F.length!==0){if(F.length>Ve.MAX_FILES){v([{type:"file_count_exceeded",message:"🚫 Too many files selected!",details:`You selected ${F.length.toLocaleString()} files, but the maximum allowed is ${Ve.MAX_FILES.toLocaleString()} files to prevent browser slowdown.`,solution:"💡 Please split your directory into smaller batches of 100,000 files or less.",icon:"⚠️"}]),c(`❌ Selection cancelled: ${F.length.toLocaleString()} files exceeds limit`);return}c("Validating files...");try{const q=os(F);if(!q.isValid){v(q.errors),b(q.warnings),c(`Validation failed: ${q.errors.length} errors found`);return}const Z=yield Js(q.stats.totalSize);if(!Z.canUpload){v([Z.error]),c("Storage limit exceeded");return}const ae=Qs(0);if(!ae.canStart){v([ae.error]),c("Too many concurrent uploads");return}const me=Zs(F);pe(me);const G=[{directory:"Individual Files",files:F.map(se=>({file:se,name:se.name,size:se.size,type:se.type,relativePath:s})),isDirectory:!1}];f(G),v([]),b(q.warnings),K(Z),c(`Ready to upload ${q.stats.validFiles} files (${Je(q.stats.totalSize)})`)}catch(q){console.error("File validation error:",q),v([{type:"VALIDATION_ERROR",message:"File validation failed",details:q.message}]),c("Validation failed")}}}),[s]),J=u.useCallback(_=>k(X,null,function*(){if(W.current||n){console.warn("Cannot select directories while upload is in progress");return}const F=Array.from(_.target.files);if(F.length!==0){if(F.length>Ve.MAX_FILES){v([{type:"directory_count_exceeded",message:"🚫 Directory too large!",details:`This directory contains ${F.length.toLocaleString()} files, but the maximum allowed is ${Ve.MAX_FILES.toLocaleString()} files to prevent browser slowdown.`,solution:"💡 Please split this directory into smaller folders of 100,000 files or less.",icon:"📁"}]),c(`❌ Directory rejected: ${F.length.toLocaleString()} files exceeds limit`);return}c("Validating directory...");try{const q=os(F);if(!q.isValid){v(q.errors),b(q.warnings),c(`Validation failed: ${q.errors.length} errors found`);return}const Z=yield Js(q.stats.totalSize);if(!Z.canUpload){v([Z.error]),c("Storage limit exceeded");return}const ae=Qs(0);if(!ae.canStart){v([ae.error]),c("Too many concurrent uploads");return}const me=Zs(F);pe(me),c("Indexing selected directory...");const G=se=>k(X,null,function*(){const Ie=new Map,Fe=cr.mainBatchSize,Se=se.length;for(let We=0;We<Se;We+=Fe){const xe=se.slice(We,We+Fe);for(const Be of xe){const Ue=Be.webkitRelativePath.split("/"),At=Ue.pop(),rt=Ue.join("/");Ie.has(rt)||Ie.set(rt,[]),Ie.get(rt).push({file:Be,name:At,size:Be.size,type:Be.type,relativePath:s?`${s}/${rt}`:rt})}const $e=Math.min(We+Fe,Se);c(`Indexing files... ${$e}/${Se} (${Math.round($e/Se*100)}%)`),yield new Promise(Be=>setTimeout(Be,0))}return Ie});try{const se=yield G(F),Ie=[];se.forEach((Fe,Se)=>{Ie.push({directory:Se,files:Fe,isDirectory:!0})}),f(Ie),v([]),b(q.warnings),K(Z),c(`Ready to upload ${F.length} files from ${se.size} directories`)}catch(se){console.error("Error processing files:",se),v([{type:"PROCESSING_ERROR",message:"Error processing files",details:se.message}]),c("Error processing files. Please try again.")}}catch(q){console.error("Directory validation error:",q),v([{type:"VALIDATION_ERROR",message:"Directory validation failed",details:q.message}]),c("Validation failed")}}}),[s]),[Ze,Oe]=u.useState(!1),Ft=u.useCallback(_=>{_.preventDefault(),_.stopPropagation(),Oe(!0)},[]),Nt=u.useCallback(_=>{_.preventDefault(),_.stopPropagation(),Oe(!1)},[]),gs=u.useCallback(_=>{if(_.preventDefault(),_.stopPropagation(),Oe(!1),W.current||n){console.warn("Cannot drop files while upload is in progress");return}const F=Array.from(_.dataTransfer.files);if(F.length===0)return;if(Array.from(_.dataTransfer.items).some(ae=>ae.kind==="file"&&ae.webkitGetAsEntry&&ae.webkitGetAsEntry().isDirectory)){c('Please use "Select Folder" button for directory uploads');return}ue({target:{files:F}})},[ue]),fr=()=>k(X,null,function*(){var _;try{const F=p.reduce((G,se)=>G+se.files.length,0),q=p.map(G=>({directory:G.directory,fileCount:G.files.length}));c(`Creating upload session for ${F} files...`);const Z=yn.createSession({rootDirectory:((_=p[0])==null?void 0:_.directory)||"upload",totalFiles:F,directoryStructure:q}),ae=new Promise((G,se)=>{setTimeout(()=>se(new Error("Session creation timeout")),3e4)}),me=yield Promise.race([Z,ae]);return P(me.data.sessionId),me.data.sessionId}catch(F){throw console.error("Failed to create upload session:",F),F}}),fs=_=>k(X,null,function*(){const q=[],Z=_.length;for(let ae=0;ae<Z;ae+=1e3){const me=_.slice(ae,ae+1e3),G=re.addPlaceholdersBatch(me);q.push(...G);const se=Math.min(ae+1e3,Z);c(`Creating placeholders... ${se}/${Z} (${Math.round(se/Z*100)}%)`),yield new Promise(Ie=>setTimeout(Ie,0))}return q}),Ht=u.useCallback(()=>{ne(!0),c("Cancelling upload...");try{de&&de.abort(),Xe.forEach(_=>{try{_.postMessage({type:"cancel"}),setTimeout(()=>{_.terminate()},100)}catch(F){console.warn("Error cancelling worker:",F)}}),fe([]),g([]),re.clearAll().catch(_=>{console.warn("Error clearing upload manager:",_)}),re.cleanupCompletedItems()}catch(_){console.error("Error during cancellation:",_)}finally{re.endUploadSession(),i(!1),ne(!1),c("Upload cancelled"),je(null),W.current=!1}},[de,Xe]);u.useEffect(()=>{const _=()=>{n&&Ht()};return window.addEventListener("cancelAllUploads",_),()=>{window.removeEventListener("cancelAllUploads",_)}},[n,Ht]);const mr=()=>k(X,null,function*(){if(p.length===0)return;if(W.current||n){console.warn("Upload already in progress, ignoring duplicate request");return}W.current=!0;try{yield re.clearAll(),fe([])}catch(F){console.warn("Error clearing previous upload state:",F)}const _=new AbortController;je(_),i(!0),ne(!1),a(0),g([]),c("Creating upload session...");try{const F=p.reduce((G,se)=>G+se.files.length,0);re.startUploadSession(F);const q=yield fr();if(c("Preparing files for upload..."),c("Preparing file list..."),c(`Prepared ${F} files for upload`),c("Starting uploads..."),c("Starting streaming upload..."),yield $r(p,q,F,_),_.signal.aborted)return;const Z=w.filter(G=>!G.success),ae=w.filter(G=>G.success),me=ae.reduce((G,se)=>G+(se.fileSize||0),0);Mt.trackFileUpload(ae.length,me,"web"),ya(`Upload completed: ${ae.length} successful, ${Z.length} failed`,"upload",Z.length>0?"warning":"info",{successful_count:ae.length,failed_count:Z.length,total_size_mb:Math.round(me/(1024*1024))}),Z.length>0?(c(`Upload completed with ${Z.length} failures`),S(!0),Mt.trackError("upload_error",`${Z.length} files failed`,"file_upload"),Rn(new Error(`Upload failed: ${Z.length} files failed`),{tags:{component:"DirectoryUploader",action:"file_upload"},extra:{failed_count:Z.length,successful_count:ae.length,total_files:p.reduce((G,se)=>G+se.files.length,0)}})):c(`Upload completed! ${ae.length} files uploaded successfully`),re.cleanupCompletedItems(),setTimeout(()=>{f([]),g([])},100)}catch(F){F.name==="AbortError"?c("Upload cancelled"):(console.error("Upload failed:",F),c(`Upload failed: ${F.message}`))}finally{re.endUploadSession(),i(!1),ne(!1),je(null),W.current=!1}}),$r=(_,F,q,Z)=>k(X,null,function*(){const ae=cr.webWorkerBatchSize;let me=0;for(const G of _){const se=G.files,Ie=Math.ceil(se.length/ae);for(let Fe=0;Fe<Ie;Fe++){if(Z.signal.aborted){const ge=new Error("Upload cancelled");throw ge.name="AbortError",ge}const Se=Fe*ae,We=Math.min(Se+ae,se.length),xe=se.slice(Se,We),$e=xe.map(ge=>be(I({},ge),{directory:G.directory})),Be=yield fs($e);me+=xe.length,(me%50===0||me===q)&&c(`Uploading ${me}/${q} files (${Math.round(me/q*100)}%)`),yield Br($e,F,Z,Be),xe.length=0,$e.length=0,yield new Promise(ge=>setTimeout(ge,10))}}}),Br=(_,F,q,Z)=>k(X,null,function*(){return new Promise((ae,me)=>{const G=new Worker("/upload-worker.js"),se=[...Xe,G];if(fe(se),re.registerWorker(G),q.signal.aborted){G.terminate();const Se=new Error("Upload cancelled");Se.name="AbortError",me(Se);return}G.postMessage({type:"upload",files:_,sessionId:F,batchSize:cr.webWorkerBatchSize,accessToken:Ke.getAccessToken(),apiBaseUrl:gr.baseURL.replace("/api/","/api")});const Ie=()=>{G.postMessage({type:"cancel"}),setTimeout(()=>{G.terminate(),fe(We=>We.filter(xe=>xe!==G)),re.unregisterWorker(G);const Se=new Error("Upload cancelled");Se.name="AbortError",me(Se)},100)};q.signal.addEventListener("abort",Ie);let Fe=[];G.onmessage=Se=>{const Be=Se.data,{type:We,data:xe}=Be,$e=ws(Be,["type","data"]);if(We==="progress"){if(xe&&xe.placeholderId){const{placeholderId:ge,progress:Ue,status:At,fileIndex:rt}=xe;rt!==void 0&&Z[rt]&&re.updatePlaceholder(Z[rt],{progress:Ue||0,status:At||"uploading"})}xe&&xe.results&&(Fe=[...Fe,...xe.results])}else if(We==="complete")xe&&xe.results&&(Fe=[...Fe,...xe.results]),Fe.forEach((ge,Ue)=>{Z[Ue]&&(ge.success?(re.updatePlaceholder(Z[Ue],{status:"completed",progress:100}),re.incrementCompleted()):re.updatePlaceholder(Z[Ue],{status:ge.error==="Upload cancelled"?"cancelled":"failed",progress:0,error:ge.error}))}),g(ge=>[...ge,...Fe]),G.terminate(),fe(ge=>ge.filter(Ue=>Ue!==G)),re.unregisterWorker(G),re.unregisterWorker(G),q.signal.removeEventListener("abort",Ie),ae(Fe);else if(We==="cancelled"){Z.forEach(Ue=>{re.updatePlaceholder(Ue,{status:"cancelled",progress:0,error:"Upload cancelled"})}),G.terminate(),fe(Ue=>Ue.filter(At=>At!==G)),re.unregisterWorker(G),re.unregisterWorker(G),q.signal.removeEventListener("abort",Ie);const ge=new Error("Upload cancelled");ge.name="AbortError",me(ge)}else We==="error"&&(G.terminate(),fe(ge=>ge.filter(Ue=>Ue!==G)),re.unregisterWorker(G),re.unregisterWorker(G),q.signal.removeEventListener("abort",Ie),me(new Error((xe==null?void 0:xe.error)||"Unknown error")))},G.onerror=Se=>{G.terminate(),fe(We=>We.filter(xe=>xe!==G)),re.unregisterWorker(G),re.unregisterWorker(G),q.signal.removeEventListener("abort",Ie),me(Se)}})}),wt=()=>{f([]),a(0),c(""),g([]),S(!1),P(null),Y.current&&(Y.current.value=""),Pe.current&&(Pe.current.value="")},ir=_=>{if(_===0)return"0 Bytes";const F=1024,q=["Bytes","KB","MB","GB"],Z=Math.floor(Math.log(_)/Math.log(F));return parseFloat((_/Math.pow(F,Z)).toFixed(2))+" "+q[Z]};return e.jsxs(h,{sx:{maxWidth:800,mx:"auto",p:2},children:[e.jsx(De,{children:e.jsxs(Te,{children:[e.jsx(l,{variant:"h5",gutterBottom:!0,children:"File & Directory Upload"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Upload individual files or entire directories while preserving folder structure"}),e.jsxs(h,{sx:{border:"2px dashed",borderColor:Ze?"primary.main":n?"warning.main":p.length>0?"success.main":"grey.300",borderRadius:2,p:4,textAlign:"center",bgcolor:Ze?"primary.50":n?"warning.light":p.length>0?"success.light":"grey.50",opacity:n?.7:1,pointerEvents:n?"none":"auto",transition:"all 0.3s ease",cursor:n?"not-allowed":"pointer",transform:Ze?"scale(1.02)":"scale(1)","&:hover":{borderColor:n?"warning.main":p.length>0?"success.main":"primary.main",bgcolor:n?"warning.light":p.length>0?"success.main":"primary.50",transform:n?"none":"translateY(-2px)",boxShadow:n?"none":2}},onDragOver:Ft,onDragLeave:Nt,onDrop:gs,children:[e.jsx("input",{ref:Y,type:"file",multiple:!0,disabled:n,onChange:ue,style:{display:"none"}}),e.jsx("input",{ref:Pe,type:"file",multiple:!0,webkitdirectory:"",directory:"",disabled:n,onChange:J,style:{display:"none"}}),Ze?e.jsxs(h,{children:[e.jsx(Me,{sx:{fontSize:48,mb:2,color:"primary.main"}}),e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{color:"primary.main",fontWeight:600},children:"Drop Files Here"}),e.jsx(l,{variant:"body2",sx:{mb:3,color:"text.secondary"},children:"Release to upload your files"})]}):p.length>0?e.jsxs(h,{children:[e.jsx(Le,{sx:{fontSize:48,mb:2,color:"success.main"}}),e.jsx(l,{variant:"h6",gutterBottom:!0,sx:{color:"success.main",fontWeight:600},children:"Files Ready for Upload"}),e.jsxs(l,{variant:"body2",sx:{mb:3,color:"text.secondary"},children:[p.reduce((_,F)=>_+F.files.length,0)," files from ",p.length," folders selected"]}),e.jsxs(h,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(z,{variant:"outlined",startIcon:e.jsx(Xt,{}),onClick:()=>{var _;W.current||n||(_=Y.current)==null||_.click()},disabled:n,sx:{minWidth:150},children:"Add More Files"}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(ar,{}),onClick:()=>{var _;W.current||n||(_=Pe.current)==null||_.click()},disabled:n,sx:{minWidth:150},children:"Add Folder"})]})]}):e.jsxs(h,{children:[e.jsx(Me,{sx:{fontSize:48,mb:2,color:"primary.main"}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Upload Your Files"}),e.jsx(l,{variant:"body2",sx:{mb:3,color:"text.secondary"},children:"Choose files or folders to upload to your secure storage"}),e.jsxs(h,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(z,{variant:"contained",startIcon:e.jsx(Ot,{}),onClick:()=>{var _;W.current||n||(_=Y.current)==null||_.click()},disabled:n,sx:{minWidth:150,py:1.5},children:"Select Files"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(ar,{}),onClick:()=>{var _;W.current||n||(_=Pe.current)==null||_.click()},disabled:n,sx:{minWidth:150,py:1.5},children:"Select Folder"})]}),e.jsx(l,{variant:"caption",sx:{mt:3,display:"block",color:"text.secondary"},children:"Or drag & drop files/folders here"})]})]}),p.length>0&&e.jsxs(h,{sx:{mt:3},children:[e.jsxs(l,{variant:"h6",gutterBottom:!0,children:["Selected Files (",p.reduce((_,F)=>_+F.files.length,0)," files)",p.some(_=>_.isDirectory)&&" - Directory Structure Preserved"]}),e.jsx(dt,{sx:{maxHeight:300,overflow:"auto"},children:p.map((_,F)=>e.jsxs(ur.Fragment,{children:[e.jsxs(ve,{children:[e.jsx(we,{children:_.isDirectory?e.jsx(ar,{color:"primary"}):e.jsx(Ot,{color:"secondary"})}),e.jsx(_e,{primary:_.directory,secondary:`${_.files.length} files${_.isDirectory?" (directory)":" (individual files)"}`})]}),_.files.map((q,Z)=>e.jsxs(ve,{sx:{pl:4},children:[e.jsx(we,{children:e.jsx(Ot,{color:"action"})}),e.jsx(_e,{primary:q.name,secondary:ir(q.size)})]},Z))]},F))})]}),R.length>0&&e.jsx(h,{sx:{mt:2},children:R.map((_,F)=>_.type==="STORAGE_LIMIT_EXCEEDED"?e.jsx(Ta,{error:_,onDismiss:()=>{v(q=>q.filter((Z,ae)=>ae!==F))},onUpgrade:()=>{window.location.href="/plans"}},F):e.jsxs(he,{severity:"error",sx:{mb:1},children:[e.jsx(l,{variant:"body2",sx:{fontWeight:600},children:_.message}),_.details&&e.jsx(l,{variant:"caption",sx:{display:"block",mt:.5},children:_.details})]},F))}),N.length>0&&e.jsx(he,{severity:"info",sx:{mt:2},children:e.jsxs(l,{variant:"body2",children:[N[0].message,": ",N[0].details]})}),p.length>0&&!n&&R.length===0&&e.jsx(ie,{sx:{p:3,mt:2,bgcolor:"grey.50",border:"1px solid",borderColor:"grey.200"},children:e.jsxs(ee,{spacing:2,children:[e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(Me,{sx:{fontSize:48,color:"primary.main",mb:1}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:.5},children:"Ready to Upload"}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[p.reduce((_,F)=>_+F.files.length,0)," files from ",p.length," folders"]})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-around",py:2,bgcolor:"white",borderRadius:1},children:[e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:p.reduce((_,F)=>_+F.files.length,0)}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"Files"})]}),e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:p.length}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"Folders"})]}),e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:O?"🔒":"🔓"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:O?"Encrypted":"Standard"})]})]}),e.jsx(z,{variant:"contained",size:"large",fullWidth:!0,onClick:mr,disabled:n||R.length>0,sx:{py:1.5,fontSize:"1.1rem",fontWeight:600},children:n?"Uploading...":"Start Upload"})]})}),n&&e.jsxs(h,{sx:{mt:3,p:{xs:2,sm:3},bgcolor:"background.paper",borderRadius:2,border:"1px solid",borderColor:"divider",boxShadow:1},children:[e.jsx(l,{variant:"body2",gutterBottom:!0,sx:{fontWeight:600,fontSize:{xs:"0.875rem",sm:"1rem"},color:"text.primary"},children:d}),e.jsx(Ae,{variant:"determinate",value:isNaN(o)?0:o,sx:{mb:2,height:{xs:8,sm:6},borderRadius:{xs:4,sm:3},bgcolor:"grey.200","& .MuiLinearProgress-bar":{borderRadius:{xs:4,sm:3},background:"linear-gradient(90deg, #1976d2 0%, #42a5f5 100%)"}}}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:[isNaN(o)?"0.0":o.toFixed(1),"% complete"]}),e.jsxs(l,{variant:"body2",color:"primary.main",sx:{fontWeight:600,fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:[p.reduce((_,F)=>_+F.files.length,0)," files"]})]})]}),e.jsxs(h,{sx:{mt:3,display:"flex",gap:{xs:1,sm:2},flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(z,{variant:"contained",disabled:R.length>0||p.length===0||n,onClick:()=>{if(W.current||n){console.warn("Upload button clicked but upload already in progress");return}if(R.length>0){console.warn("Upload button clicked but validation errors exist");return}mr()},startIcon:e.jsx(Me,{}),fullWidth:!0,sx:{py:{xs:1.5,sm:1},fontSize:{xs:"0.875rem",sm:"1rem"},fontWeight:600},children:n?"Uploading...":"Upload Files"}),n&&e.jsx(z,{variant:"outlined",color:"error",onClick:Ht,disabled:ke,startIcon:e.jsx(qn,{}),fullWidth:!0,sx:{py:{xs:1.5,sm:1},fontSize:{xs:"0.875rem",sm:"1rem"},fontWeight:600},children:ke?"Cancelling...":"Cancel Upload"}),e.jsx(z,{variant:"outlined",onClick:()=>{if(W.current||n){console.warn("Cannot reset while upload is in progress");return}wt()},disabled:n,startIcon:e.jsx(Xt,{}),fullWidth:!0,sx:{py:{xs:1.5,sm:1},fontSize:{xs:"0.875rem",sm:"1rem"},fontWeight:600},children:"Reset"})]})]})}),e.jsxs(ft,{open:D,onClose:()=>S(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(mt,{children:"Upload Results"}),e.jsxs(yt,{children:[e.jsxs(h,{sx:{mb:2},children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Summary"}),e.jsxs(h,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(oe,{icon:e.jsx(Le,{}),label:`${w.filter(_=>_.success).length} Successful`,color:"success"}),e.jsx(oe,{icon:e.jsx(gt,{}),label:`${w.filter(_=>!_.success).length} Failed`,color:"error"})]})]}),e.jsx(Vt,{sx:{my:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"File Details"}),e.jsx(dt,{sx:{maxHeight:400,overflow:"auto"},children:w.map((_,F)=>e.jsxs(ve,{children:[e.jsx(we,{children:_.success?e.jsx(Le,{color:"success"}):e.jsx(gt,{color:"error"})}),e.jsx(_e,{primary:_.file,secondary:_.success?_.path:_.error})]},F))})]}),e.jsx(Zt,{children:e.jsx(z,{onClick:()=>S(!1),children:"Close"})})]})]})},Ua=({open:r,onClose:t,downloadInfo:s})=>{const[n,i]=u.useState(0),[o,a]=u.useState(""),[d,c]=u.useState(!1),[p,f]=u.useState(null),[w,g]=u.useState(!1);u.useEffect(()=>{r&&s&&(i(0),a("Starting download..."),c(!1),f(null),g(!1))},[r,s]);const D=()=>{d||t()},S=()=>{let E=0;const P=setInterval(()=>{E+=Math.random()*10,E>=90&&(E=90,clearInterval(P),a("Preparing download...")),i(E)},300)};return u.useEffect(()=>{r&&s&&S()},[r,s]),u.useEffect(()=>{s!=null&&s.downloadComplete&&(i(100),g(!0),a("Download complete!"))},[s==null?void 0:s.downloadComplete]),s?e.jsxs(ft,{open:r,onClose:D,maxWidth:"sm",fullWidth:!0,children:[e.jsx(mt,{children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Yt,{color:"primary"}),e.jsx(l,{variant:"h6",children:"Downloading File"})]})}),e.jsxs(yt,{children:[e.jsxs(h,{sx:{mb:2},children:[e.jsx(l,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:s.isBulkDownload?`Bulk Download (${s.fileCount} files)`:s.filename}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s.isBulkDownload?`${s.fileCount} files • Total size: ${(s.file_size/(1024*1024)).toFixed(2)} MB`:`Size: ${(s.file_size/(1024*1024)).toFixed(2)} MB`})]}),s.is_encrypted&&e.jsxs(he,{severity:"info",sx:{mb:2},icon:e.jsx(bt,{}),children:[e.jsxs(l,{variant:"body2",sx:{fontWeight:"bold",mb:.5},children:["🔒 Encrypted File",s.isBulkDownload?"s":""]}),e.jsx(l,{variant:"body2",children:s.isBulkDownload?"Some files will be automatically decrypted during download.":"This file will be automatically decrypted during download."}),e.jsxs(h,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(oe,{label:"AES-GCM 256-bit",size:"small",color:"primary"}),e.jsx(oe,{label:"E2E Encrypted",size:"small",color:"success"})]})]}),p&&e.jsxs(he,{severity:"error",sx:{mb:2},icon:e.jsx(gt,{}),children:[e.jsx(l,{variant:"body2",sx:{fontWeight:"bold",mb:.5},children:"Download Failed"}),e.jsx(l,{variant:"body2",children:p})]}),w&&e.jsxs(he,{severity:"success",sx:{mb:2},icon:e.jsx(Le,{}),children:[e.jsx(l,{variant:"body2",sx:{fontWeight:"bold",mb:.5},children:"Download Complete"}),e.jsx(l,{variant:"body2",children:s.isBulkDownload?s.is_encrypted?"Files downloaded and decrypted successfully!":"Files downloaded successfully!":s.is_encrypted?"File downloaded and decrypted successfully!":"File downloaded successfully!"})]}),e.jsxs(h,{sx:{mt:2},children:[e.jsx(l,{variant:"body2",sx:{mb:1},children:o}),e.jsx(Ae,{variant:"determinate",value:n,sx:{height:8,borderRadius:4}}),e.jsxs(l,{variant:"body2",color:"text.secondary",sx:{mt:1},children:[n.toFixed(1),"% complete"]})]}),d&&e.jsxs(h,{sx:{mt:2},children:[e.jsx(l,{variant:"body2",sx:{mb:1},children:"Decrypting file..."}),e.jsx(Ae,{variant:"indeterminate",sx:{height:4,borderRadius:2}})]})]}),e.jsx(Zt,{children:e.jsx(z,{onClick:D,disabled:d,children:w?"Close":"Cancel"})})]}):null},za=u.memo(({uploadManagerState:r})=>{var p,f,w,g;const t=r;if(!t)return null;const s=(p=t.uploadTotal)!=null?p:0,n=(f=t.uploadCompleted)!=null?f:0,i=(w=t.uploadInProgress)!=null?w:0,o=(g=t.uploadQueued)!=null?g:0;if(s===0||i===0&&o===0)return null;const a=s>0?Math.round(n/s*100):0;let d="";s>0?d=`📤 Uploading ${n}/${s} files (${a}%)`:d="✅ Upload completed!";const c=()=>{re.cancelAllUploads()};return e.jsx(h,{sx:{px:{xs:2,md:3},pt:1.5},children:e.jsx(ie,{sx:{p:2,border:"1px solid #e0e0e0"},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(Me,{sx:{color:"#60a5fa"}}),e.jsxs(h,{sx:{flex:1},children:[e.jsx(l,{variant:"body2",sx:{fontWeight:600},children:d}),e.jsx(Ae,{variant:"determinate",value:a,sx:{mt:1,height:8,borderRadius:4}})]}),e.jsx(z,{variant:"outlined",color:"error",size:"small",onClick:c,sx:{minWidth:"auto"},children:"Cancel"})]})})})}),La=({onFileSelect:r,onFolderSelect:t,globalSearchQuery:s})=>{const n=Jt(),[i,o]=u.useState([]),[a,d]=u.useState([]),[c,p]=u.useState("root"),[f,w]=u.useState(new Set(["root"]));u.useState(new Set);const[g,D]=u.useState(new Set),[S,E]=u.useState(new Set),[P,R]=u.useState(""),[v,N]=u.useState(0),[b,A]=u.useState(null),[K,H]=u.useState(!1),[pe,de]=u.useState(!0),[je,ke]=u.useState(!1);u.useState(!1);const[ne,Xe]=u.useState({total:0,completed:0,inProgress:0,queued:0}),[fe,O]=u.useState({open:!1,count:0}),[qe,Y]=u.useState({}),[Pe,W]=u.useState(null),[ue,J]=u.useState({current:0,total:0}),[Ze,Oe]=u.useState(null),[Ft,Nt]=u.useState({}),[gs,fr]=u.useState(0),[fs,Ht]=u.useState(""),[mr,$r]=u.useState(!1),Br=!1,wt=u.useMemo(()=>ne.total>0&&(ne.inProgress>0||ne.queued>0),[ne.total,ne.inProgress,ne.queued]),ir=u.useMemo(()=>wt?{title:"Upload in progress...",subtitle:"Please wait for current upload to complete"}:{title:v===0?"No active files":"No hibernated files",subtitle:v===0?"Click here or drag files to upload":"Hibernate some files to see them here"},[wt,v]),[_,F]=u.useState(ir);u.useEffect(()=>{const x=setTimeout(()=>{F(ir)},200);return()=>clearTimeout(x)},[ir]);const{handleArchive:q,handleDelete:Z,handleDownload:ae,downloadDialogOpen:me,downloadInfo:G,setDownloadDialogOpen:se,setDownloadInfo:Ie}=Da(st,!0),Fe=x=>{D(m=>{const y=new Set(m);return y.has(x)?y.delete(x):y.add(x),y})},Se=x=>{E(m=>{const y=new Set(m);return y.has(x)?y.delete(x):y.add(x),y})},We=()=>{const x=new Set(_t.map(y=>y.id)),m=new Set(or.map(y=>y.path));D(x),E(m)},xe=()=>{D(new Set),E(new Set)},$e=()=>g.size+S.size,Be=()=>i.filter(x=>g.has(x.id)),ge=()=>a.filter(x=>S.has(x.path)),Ue=(x,m)=>{const y=[];for(const L of m){const $=i.filter(te=>{var B;return(B=te.relative_path)==null?void 0:B.startsWith(L.path)}).filter(te=>te.status==="archiving");$.length>0&&y.push({type:"folder_has_hibernating_files",folder:L.name,hibernatingCount:$.length,hibernatingFiles:$.map(te=>te.original_filename)})}const C=x.filter(L=>L.status==="archiving");return C.length>0&&y.push({type:"files_already_hibernating",hibernatingFiles:C.map(L=>L.original_filename)}),y},At=x=>{const m=i.filter(B=>{var U;return(U=B.relative_path)==null?void 0:U.startsWith(x)});if(m.length===0)return null;const y=m.reduce((B,U)=>(B[U.status]=(B[U.status]||0)+1,B),{}),C=m.length,L=y.archived||0,M=y.archiving||0,$=y.restoring||0;(y.uploaded||0)+(y.restored||0);const te=(L+M)/C;return $>0?{type:"restoring",count:$,total:C,icon:e.jsx(Nr,{sx:{fontSize:14}}),color:"#fbbf24",label:`${$} waking`}:te>=.5?{type:"hibernated",count:L,total:C,icon:e.jsx(jt,{sx:{fontSize:14}}),color:"#94a3b8",label:`${L}/${C} hibernated`}:M>0?{type:"hibernating",count:M,total:C,icon:e.jsx(Xr,{sx:{fontSize:14}}),color:"#a78bfa",label:`${M} hibernating`}:te>0?{type:"mixed",count:L,total:C,icon:e.jsx(jt,{sx:{fontSize:14}}),color:"#64748b",label:`${L}/${C} hibernated`}:null},rt=()=>k(X,null,function*(){const x=Be(),m=ge(),y=Ue(x,m);if(y.length>0){let M=`❄️ Cannot hibernate due to conflicts:

`;y.forEach($=>{$.type==="folder_has_hibernating_files"?(M+=`• Folder "${$.folder}" has ${$.hibernatingCount} files already hibernating
`,M+=`  Files: ${$.hibernatingFiles.slice(0,3).join(", ")}${$.hibernatingFiles.length>3?"...":""}

`):$.type==="files_already_hibernating"&&(M+=`• ${$.hibernatingFiles.length} selected files are already hibernating
`,M+=`  Files: ${$.hibernatingFiles.slice(0,3).join(", ")}${$.hibernatingFiles.length>3?"...":""}

`)}),M+="Please wait for current hibernation to complete or select different files/folders.",alert(M);return}const C=[...x];for(const M of m){const $=i.filter(te=>{var B;return(B=te.relative_path)==null?void 0:B.startsWith(M.path)});C.push(...$)}const L=C.filter(M=>M.status==="uploaded"||M.status==="restored");if(L.length===0){alert('No files available for hibernation. Files must be in "uploaded" or "restored" state.');return}Oe("hibernate"),W("in_progress"),Y({}),L.forEach(M=>{Y($=>be(I({},$),{[M.id]:{status:"pending",progress:0}}))});try{let M=0,$=0;const te=10,B=[];for(let U=0;U<L.length;U+=te)B.push(L.slice(U,U+te));J({current:0,total:B.length});for(let U=0;U<B.length;U++){const ye=B[U];J({current:U+1,total:B.length}),yield Promise.all(ye.map(ce=>k(X,null,function*(){try{Y(Q=>be(I({},Q),{[ce.id]:{status:"in_progress",progress:50}})),yield q(ce),Y(Q=>be(I({},Q),{[ce.id]:{status:"completed",progress:100}})),M++}catch(Q){console.error(`Failed to hibernate ${ce.original_filename}:`,Q),Y(le=>be(I({},le),{[ce.id]:{status:"error",progress:0}})),$++}}))),U<B.length-1&&(yield new Promise(ce=>setTimeout(ce,1e3)))}W("completed"),setTimeout(()=>{xe(),st(!0),W(null),Y({}),Oe(null)},2e3)}catch(M){console.error("Bulk hibernation failed:",M),W("error"),setTimeout(()=>{W(null),Y({}),Oe(null)},3e3)}}),An=()=>k(X,null,function*(){const x=Be(),m=ge();try{for(const y of x)y.status==="archived"&&(yield Re.restoreFile(y.id,"Standard"));for(const y of m){const C=i.filter(L=>{var M;return(M=L.relative_path)==null?void 0:M.startsWith(y.path)});for(const L of C)L.status==="archived"&&(yield Re.restoreFile(L.id,"Standard"))}xe(),st(!0)}catch(y){console.error("Bulk wake up failed:",y)}}),Wn=()=>k(X,null,function*(){const x=Be(),m=ge();if(x.length===0&&m.length===0)return;const y=[...x];for(const L of m){const M=i.filter($=>{var te;return(te=$.relative_path)==null?void 0:te.startsWith(L.path)});y.push(...M)}const C=y.filter(L=>L.status==="uploaded"||L.status==="restored");if(C.length===0){alert('No files available for download. Files must be in "uploaded" or "restored" state.');return}try{Ie({filename:`bulk_download_${Date.now()}.zip`,file_size:C.reduce((U,ye)=>U+ye.file_size,0),is_encrypted:C.some(U=>U.is_encrypted),encryption_metadata:null,isBulkDownload:!0,fileCount:C.length}),se(!0);const L=(yield xs(()=>import("./utils-76a9f601.js").then(U=>U.j),["assets/utils-76a9f601.js","assets/vendor-950dbbc1.js"])).default,M=new L;for(let U=0;U<C.length;U++){const ye=C[U];try{const ce=yield Re.downloadFile(ye.id),{download_url:Q,filename:le,file_size:ze,is_encrypted:He,encryption_metadata:Ee}=ce.data,at=yield fetch(Q);if(!at.ok)throw new gt(`Failed to download ${le}: ${at.status}`);let Qe=yield at.blob(),yr=le;if(He&&Ee&&Ye.isEnabled())try{const br=new File([Qe],le,{type:Qe.type}),ys=yield Ye.decryptFileAfterDownload(br,Ee);Qe=ys,yr=ys.name}catch(br){throw console.error(`Decryption failed for ${le}:`,br),new gt(`Decryption failed for ${le}: ${br.message}`)}else if(He&&!Ye.isEnabled())throw new gt(`File ${le} is encrypted but encryption service is not enabled. Please set up your master password first.`);const ms=ye.relative_path||"",$n=ms?`${ms}/${yr}`:yr;M.file($n,Qe);const Bn=Math.round((U+1)/C.length*100);console.log(`Added ${yr} to ZIP (${Bn}%)`)}catch(ce){console.error(`Failed to process file ${ye.original_filename}:`,ce)}}console.log("Generating ZIP file...");const $=yield M.generateAsync({type:"blob"});console.log(`ZIP generated successfully, size: ${$.size} bytes`);const te=window.URL.createObjectURL($);console.log("Created download URL:",te);const B=document.createElement("a");B.href=te,B.download=`download_${Date.now()}.zip`,B.style.display="none",document.body.appendChild(B),console.log("Triggering download..."),B.click(),setTimeout(()=>{if(te&&te.startsWith("blob:"))console.log("Download triggered successfully");else{console.warn("Download may not have started, trying alternative method");const U=document.createElement("iframe");U.style.display="none",U.src=te,document.body.appendChild(U),setTimeout(()=>{document.body.removeChild(U)},2e3)}},500),setTimeout(()=>{document.body.removeChild(B),window.URL.revokeObjectURL(te),console.log("Download cleanup completed")},2e3),Ie(U=>be(I({},U),{downloadComplete:!0})),setTimeout(()=>{se(!1),xe(),console.log(`Bulk download completed: ${C.length} files in ZIP`)},3e3)}catch(L){console.error("Bulk download failed:",L),se(!1),alert(`Bulk download failed: ${L.message}`)}}),Un=()=>{const x=Be(),m=ge();if(x.length===0&&m.length===0)return;const y=m.reduce((L,M)=>L+(M.fileCount||0),0),C=x.length+y;O({open:!0,count:C})},zn=()=>k(X,null,function*(){const x=Be(),m=ge();O({open:!1,count:0});const y=[...x];for(const M of m)try{console.log(`Fetching files for folder: ${M.path}`);const $=yield Re.getFiles({folder:M.path,paginate:!1});$.data&&Array.isArray($.data.files)&&(y.push(...$.data.files),console.log(`Found ${$.data.files.length} files in folder ${M.path}`))}catch($){console.error(`Error fetching files for folder ${M.path}:`,$)}const C=y.map(M=>M.id);console.log(`Total files to delete: ${C.length}`);const L=re.addDeleteOperation(C,"delete");Oe("delete"),W("in_progress"),Y({}),y.forEach(M=>{Y($=>be(I({},$),{[M.id]:{status:"pending",progress:0}}))});try{re.updateDeleteOperation(L,{status:"deleting",progress:0,completedFiles:0});const M=1e3,$=[];for(let U=0;U<C.length;U+=M)$.push(C.slice(U,U+M));J({current:0,total:$.length});let te=0,B=0;for(let U=0;U<$.length;U++){const ye=$[U];try{J({current:U+1,total:$.length}),Y(Ee=>{const at=I({},Ee);return ye.forEach(Qe=>{at[Qe]={status:"in_progress",progress:50}}),at});const ce=yield Re.bulkDeleteFiles(ye),{summary:Q,failed_files:le}=ce.data;te+=Q.successfully_deleted,B+=Q.failed_deletions||0,ye.forEach(Ee=>{const at=le?le.find(Qe=>Qe.file_id===Ee):null;Y(at?Qe=>be(I({},Qe),{[Ee]:{status:"error",progress:0}}):Qe=>be(I({},Qe),{[Ee]:{status:"completed",progress:100}}))});const ze=te+B,He=Math.round(ze/C.length*100);re.updateDeleteOperation(L,{status:"uploading",progress:He,completedFiles:ze}),U<$.length-1&&(yield new Promise(Ee=>setTimeout(Ee,100)))}catch(ce){console.error(`Batch ${U+1} failed:`,ce),ye.forEach(Q=>{Y(le=>be(I({},le),{[Q]:{status:"error",progress:0}}))}),B+=ye.length}}W("completed"),re.updateDeleteOperation(L,{status:"completed",progress:100,completedFiles:te+B}),setTimeout(()=>k(X,null,function*(){xe(),yield st(!0);try{const U=yield Re.getFolderStructure(!0);console.log("[Bulk Delete] Folder structure refreshed:",U.data)}catch(U){console.error("[Bulk Delete] Failed to refresh folder structure:",U)}W(null),Y({}),Oe(null),re.queue=re.queue.filter(U=>U.id!==L),re._emit()}),2e3)}catch(M){console.error("Bulk delete failed:",M),W("error"),re.updateDeleteOperation(L,{status:"failed",progress:0,error:M.message}),setTimeout(()=>{W(null),Y({}),Oe(null),re.queue=re.queue.filter($=>$.id!==L),re._emit()},3e3)}});u.useEffect(()=>{st()},[c,P]),u.useEffect(()=>{const x=()=>{const y=Ye.getEncryptionStatus();$r(y.enabled)};x();const m=setInterval(x,1e3);return()=>clearInterval(m)},[]),u.useEffect(()=>{let x,m="",y=null;return re.init().then(()=>{x=re.subscribe(C=>{if(!C)return;const L=`${C.total}-${C.completed}-${C.inProgress}-${C.queued}-${C.failed}`;L!==m&&(m=L,y&&clearTimeout(y),y=setTimeout(()=>{Xe(C),y=null},500))})}),()=>{x==null||x(),y&&clearTimeout(y)}},[]),u.useEffect(()=>{let x;const m=ne;if(!m)return;const{inProgress:y,queued:C,completed:L,total:M}=m;return(y===0&&C===0&&L>0||L===M)&&(x=setTimeout(()=>k(X,null,function*(){yield re.clearAll(),st(!0)}),1e3)),()=>{x&&clearTimeout(x)}},[ne==null?void 0:ne.inProgress,ne==null?void 0:ne.queued,ne==null?void 0:ne.completed,ne==null?void 0:ne.total]),u.useEffect(()=>{const x=setTimeout(()=>{R(s||"")},200);return()=>clearTimeout(x)},[s]);function st(x=!1){return k(this,null,function*(){try{if(de(!0),!Ke.getAccessToken()){console.error("No authentication token found"),o([]),d([]);return}const y=yield Re.getFiles({folder:c==="root"?"root":c,search:(P==null?void 0:P.trim())||"",paginate:!1,cacheBust:x?Date.now():void 0});if(y.status!==200){console.error("API returned non-200 status:",y.status),o([]),d([]);return}let C=[],L=[];y.data&&Array.isArray(y.data.files)?(C=y.data.files,L=y.data.folders||[]):Array.isArray(y.data)?C=y.data:y.data&&Array.isArray(y.data.data)&&(C=y.data.data),Array.isArray(C)||(C=[]);const M=L.map(B=>({id:`folder_${B.name}`,original_filename:B.name,file_type:"folder",file_size:B.size||0,relative_path:B.relative_path,status:"uploaded",uploaded_at:new Date().toISOString(),fileCount:B.fileCount,size:B.size||0}));C=[...C,...M];const $=new Map,te=[];if(C.forEach(B=>{if(B.file_type==="folder"){const Q=(B.relative_path||"").split("/").filter(le=>le!=="");if(Q.length===0||Q.length===1&&Q[0]===B.original_filename){const le=B.original_filename;$.set(le,{name:B.original_filename,path:le,parent:"root",fileCount:B.fileCount||0,size:B.size||0})}else{let le="root";Q.forEach((ze,He)=>{const Ee=le==="root"?ze:`${le}/${ze}`;$.has(Ee)||$.set(Ee,{name:ze,path:Ee,parent:le,fileCount:0,size:0}),le=Ee})}return}const ye=(B.relative_path||B.s3_key||"").split("/").filter(ce=>ce!=="");if(ye.length===0)te.push(B);else{let ce="root";ye.forEach((Q,le)=>{const ze=ce==="root"?Q:`${ce}/${Q}`;$.has(ze)||$.set(ze,{name:Q,path:ze,parent:ce,fileCount:0,size:0}),ce=ze}),te.push(B)}}),C.forEach(B=>{if(B.file_type==="folder")return;const ye=(B.relative_path||B.s3_key||"").split("/").filter(Q=>Q!=="");let ce="root";ye.forEach((Q,le)=>{const ze=ce==="root"?Q:`${ce}/${Q}`,He=$.get(ze);He&&He.fileCount===0&&He.size===0&&(He.fileCount+=1,He.size+=B.file_size||0),ce=ze})}),c==="root"&&C.length>0&&C.every(B=>B.file_type==="folder")){const B=C.filter(U=>U.file_type==="folder"&&(!U.relative_path||U.relative_path==="")).map(U=>k(this,null,function*(){try{const ce=(yield Re.getFiles({folder:U.original_filename,search:"",paginate:!1})).data.files||[],Q=ce.filter(Ee=>Ee.file_type!=="folder").length,le=ce.filter(Ee=>Ee.file_type!=="folder").reduce((Ee,at)=>Ee+(at.file_size||0),0),ze=U.original_filename,He=$.get(ze);return He&&(He.fileCount=Q,He.size=le),{folderPath:ze,fileCount:Q,size:le}}catch(ye){return console.error(`Error getting stats for folder ${U.original_filename}:`,ye),{folderPath:U.original_filename,fileCount:0,size:0}}}));yield Promise.all(B)}o(te),d(Array.from($.values()))}catch(m){console.error("Error loading files:",m)}finally{de(!1)}})}const _t=u.useMemo(()=>{if(!i||i.length===0)return[];let x=i;if(P){const m=P.toLowerCase();x=i.filter(y=>{const C=(y.original_filename||"").toLowerCase(),L=(y.relative_path||y.s3_key||"").toLowerCase();return C.includes(m)||L.includes(m)})}else x=x.filter(m=>{const y=m.relative_path||"";if(c==="root")return!y||y==="";{const C=c;return y===C?!0:y.startsWith(C+"/")?y.substring(C.length+1).indexOf("/")===-1:!1}});return x},[i,v,P,c]),or=u.useMemo(()=>{if(P)return[];let x;return c==="root"?x=a.filter(m=>m.parent==="root"):x=a.filter(m=>m.parent===c),x},[a,c,P]),Mr=x=>{if(!x)return"0 B";const m=1024,y=["B","KB","MB","GB","TB"],C=Math.floor(Math.log(x)/Math.log(m));return`${parseFloat((x/Math.pow(m,C)).toFixed(2))} ${y[C]}`},Ln=x=>new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),On=x=>{w(m=>{const y=new Set(m);return y.has(x)?y.delete(x):y.add(x),y})};return e.jsxs(h,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},height:"calc(100vh - 100px)",bgcolor:"background.default",borderRadius:0,overflow:"hidden",position:"relative"},children:[Br,e.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",position:"relative",minWidth:0,overflow:"hidden"},children:[e.jsx(h,{sx:{borderBottom:`1px solid ${j(n.palette.divider,.1)}`,bgcolor:j("#ffffff",.5)},children:e.jsx(h,{sx:{px:0,pt:1.5,pb:1},children:e.jsxs(ee,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",sx:{flexWrap:"nowrap",gap:1,overflowX:"auto"},children:[e.jsxs(ee,{direction:"row",spacing:1,alignItems:"center",sx:{flex:"0 0 auto",whiteSpace:"nowrap"},children:[e.jsx(Vn,{fontSize:"small",sx:{color:"text.secondary",cursor:"pointer"},onClick:()=>{p("root"),t==null||t("root")}}),c!=="root"&&c.split("/").filter(x=>x!=="root").map((x,m,y)=>{const C=y.slice(0,m+1).join("/");return e.jsxs(ur.Fragment,{children:[e.jsx(Yn,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsx(l,{variant:"body2",sx:{color:m===y.length-1?"primary.main":"text.secondary",fontWeight:m===y.length-1?600:400,cursor:"pointer","&:hover":{textDecoration:"underline"},whiteSpace:"nowrap"},onClick:()=>{p(C),t==null||t(C)},children:x})]},C)})]}),e.jsxs(ee,{direction:"row",spacing:1,alignItems:"center",sx:{flex:"0 0 auto",whiteSpace:"nowrap"},children:[c!=="root"&&e.jsx(lt,{title:"Folder Details",children:e.jsx(Ne,{size:"small",onClick:()=>H(!0),children:e.jsx(tn,{fontSize:"small"})})}),e.jsx(tt,{size:"small",placeholder:"Search files...",value:P,onChange:x=>R(x.target.value),sx:{minWidth:{xs:160,md:240}}}),e.jsx(lt,{title:"Upload Files",children:e.jsx(z,{size:"small",startIcon:e.jsx(Me,{}),onClick:()=>ke(!0),disabled:wt,sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"Upload"})}),e.jsx(lt,{title:"Create Folder",children:e.jsx(z,{size:"small",startIcon:e.jsx(Kn,{}),onClick:()=>k(X,null,function*(){var m,y;const x=prompt("Enter folder name:");if(x&&x.trim())try{const C=yield Re.createFolder(x.trim(),c==="root"?"":c);alert(`Folder "${x.trim()}" created successfully!`),window.location.reload()}catch(C){const L=((y=(m=C.response)==null?void 0:m.data)==null?void 0:y.error)||"Failed to create folder";alert(`Error: ${L}`)}}),sx:{textTransform:"none",fontWeight:600},children:"New Folder"})}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",mr:1},children:[e.jsx(Cr,{checked:$e()>0&&$e()===_t.length+or.length,indeterminate:$e()>0&&$e()<_t.length+or.length,onChange:x=>{x.target.checked?We():xe()},size:"small",sx:{color:"primary.main","&.Mui-checked":{color:"primary.main"}}}),e.jsx(l,{variant:"body2",sx:{color:"text.secondary",ml:.5},children:"Select All"})]}),e.jsx(lt,{title:"Refresh",children:e.jsx(Ne,{onClick:st,size:"small",sx:{flex:"0 0 auto"},children:e.jsx(Xt,{fontSize:"small"})})}),$e()>0&&e.jsxs(e.Fragment,{children:[e.jsx(lt,{title:`Download ${$e()} items`,children:e.jsx(Ne,{onClick:Wn,size:"small",sx:{bgcolor:j("#3b82f6",.1),"&:hover":{bgcolor:j("#3b82f6",.2)}},children:e.jsx(Yt,{sx:{color:"#3b82f6"}})})}),e.jsx(lt,{title:`Hibernate ${$e()} items`,children:e.jsx(Ne,{onClick:rt,size:"small",sx:{bgcolor:j("#a78bfa",.1),"&:hover":{bgcolor:j("#a78bfa",.2)}},children:e.jsx(_s,{sx:{color:"#a78bfa"}})})}),e.jsx(lt,{title:`Wake up ${$e()} items`,children:e.jsx(Ne,{onClick:An,size:"small",sx:{bgcolor:j("#fbbf24",.1),"&:hover":{bgcolor:j("#fbbf24",.2)}},children:e.jsx(Nr,{sx:{color:"#fbbf24"}})})}),e.jsx(lt,{title:`Delete ${$e()} items`,children:e.jsx(Ne,{onClick:Un,size:"small",sx:{bgcolor:j("#ef4444",.1),"&:hover":{bgcolor:j("#ef4444",.2)}},children:e.jsx(zt,{sx:{color:"#ef4444"}})})})]})]})]})})}),e.jsx(za,{uploadManagerState:ne}),(()=>{const m=(ne.deleteOperations||[]).find(te=>te&&te.status==="deleting");if(!m)return null;const y=m.totalFiles||0,C=m.completedFiles||0;if(!(y>0))return null;const M=y>0?Math.round(C/y*100):0,$=y-C;return e.jsx(Hr,{in:!0,timeout:150,children:e.jsx(h,{sx:{px:{xs:2,md:3},pt:1.5},children:e.jsxs(ie,{sx:{p:2,border:`1px solid ${j("#f59e0b",.2)}`,background:`linear-gradient(135deg, ${j("#f59e0b",.05)} 0%, ${j("#f59e0b",.02)} 100%)`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"all 0.15s ease"},children:[e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{p:1,borderRadius:"50%",bgcolor:j("#f59e0b",.1),display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(zt,{sx:{color:"#f59e0b",fontSize:20}})}),e.jsxs(h,{sx:{flex:1},children:[e.jsxs(l,{variant:"body2",sx:{fontWeight:600,color:"#f59e0b"},children:["🗑️ Deleting ",$," of ",y," files"]}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[C," completed • ",$," remaining"]})]}),e.jsxs(l,{variant:"caption",sx:{fontWeight:600,color:"#f59e0b",bgcolor:j("#f59e0b",.1),px:1.5,py:.5,borderRadius:1},children:[M,"%"]})]}),e.jsx(Ae,{variant:"determinate",value:M,sx:{mt:1.5,height:8,borderRadius:4,bgcolor:j("#f59e0b",.1),"& .MuiLinearProgress-bar":{bgcolor:"#f59e0b",borderRadius:4}}})]})})})})(),e.jsxs(h,{sx:{flex:1,overflow:"auto",pt:{xs:2,md:3},pr:{xs:2,md:2},pb:{xs:2,md:3},pl:{xs:2,md:3}},children:[_t.length>0&&e.jsxs(ie,{sx:{p:2.5,mb:3,bgcolor:"background.paper",border:`1px solid ${j(n.palette.divider,.1)}`},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(l,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:"📊 File Status Summary"}),e.jsx(h,{sx:{display:"flex",alignItems:"center",gap:1},children:mr?e.jsx(oe,{icon:e.jsx(bt,{}),label:"E2E Encryption Enabled",size:"small",color:"success",variant:"outlined"}):e.jsx(oe,{icon:e.jsx(ls,{}),label:"E2E Encryption Disabled",size:"small",color:"default",variant:"outlined"})}),(()=>{const x=_t.reduce((m,y)=>(m[y.status]=(m[y.status]||0)+1,m),{});return e.jsxs(ee,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(oe,{label:`Hibernated: ${x.archived||0}`,size:"small",sx:{bgcolor:j("#94a3b8",.15),color:"#475569",fontWeight:600}}),e.jsx(oe,{label:`Hibernating: ${x.archiving||0}`,size:"small",sx:{bgcolor:j("#a78bfa",.15),color:"#6b21a8",fontWeight:600}}),e.jsx(oe,{label:`Awake Mode: ${(x.uploaded||0)+(x.restored||0)}`,size:"small",sx:{bgcolor:j("#60a5fa",.15),color:"#0c4a6e",fontWeight:600}})]})})()]}),e.jsx(h,{sx:{display:"none"},children:(()=>{const x=_t.reduce((m,y)=>(Wt(y.status),m[y.status]=(m[y.status]||0)+1,m),{});return Object.entries(x).map(([m,y])=>{const C=Wt(m);return e.jsx(oe,{icon:C.icon,label:`${C.label}: ${y}`,size:"small",sx:{bgcolor:j(C.color,.1),color:C.color,fontWeight:600,border:`1px solid ${j(C.color,.3)}`}},m)})})()})]}),Pe==="completed"&&e.jsx(h,{sx:{mb:4},children:e.jsx(ie,{sx:{p:2.5,bgcolor:j("#f3f4f6",.3),border:"1px solid",borderColor:"#6b7280"},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(Le,{sx:{color:"#6b7280"}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"#374151"},children:"Deletion Completed Successfully!"})]})})}),Pe==="error"&&e.jsx(h,{sx:{mb:4},children:e.jsx(ie,{sx:{p:2.5,bgcolor:j("#fee2e2",.3),border:"1px solid",borderColor:"#ef4444"},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(gt,{sx:{color:"#ef4444"}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"#991b1b"},children:"Some files failed to delete"})]})})}),je&&!wt?e.jsxs(h,{children:[e.jsx(h,{sx:{mb:4,p:2.5,bgcolor:j("#f0f9ff",.5),borderRadius:2},children:e.jsxs(ee,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(Me,{sx:{color:"#60a5fa"}}),e.jsxs(h,{children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600},children:"Upload Files"}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:["Uploading to: ",e.jsx("strong",{children:c==="root"?"Root Directory":c})]})]}),e.jsx(h,{sx:{flex:1}}),e.jsx(Ne,{onClick:()=>ke(!1),sx:{bgcolor:j("#ef4444",.1),"&:hover":{bgcolor:j("#ef4444",.2)}},children:e.jsx(rn,{sx:{color:"#ef4444"}})})]})}),e.jsx(Tn,{open:!0,onClose:()=>ke(!1),onUploadComplete:()=>{ke(!1),fr(0),Ht(""),st(!0)},onUploadProgress:(x,m)=>{Nt(y=>be(I({},y),{[m]:x})),typeof m=="string"&&m.includes("files")&&(fr(Math.round(x)),Ht(m))},defaultRelativePath:c==="root"?"":c})]}):pe?e.jsx(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:e.jsx(Ae,{sx:{width:"50%"}})}):(()=>_t.length===0&&or.length===0&&!P)()?e.jsxs(h,{sx:I({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:2,cursor:"pointer",borderRadius:3,border:`2px dashed ${j("#60a5fa",.3)}`,bgcolor:j("#f0f9ff",.3),transition:"all 0.3s","&:hover":{borderColor:"#60a5fa",bgcolor:j("#f0f9ff",.5),transform:"scale(1.02)"}},wt&&{opacity:.5,pointerEvents:"none",cursor:"not-allowed"}),onClick:()=>{wt||ke(!0)},children:[e.jsx(Me,{sx:{fontSize:80,color:j("#60a5fa",.5)}}),e.jsx(l,{variant:"h6",color:"text.secondary",children:_.title}),e.jsx(l,{variant:"body2",color:"text.secondary",children:_.subtitle}),v===0&&e.jsx(z,{variant:"contained",startIcon:e.jsx(Me,{}),sx:{mt:2,bgcolor:"#60a5fa","&:hover":{bgcolor:"#3b82f6"},textTransform:"none",fontWeight:600},children:"Upload Files"})]}):e.jsxs(T,{container:!0,spacing:2,children:[or.map(x=>e.jsx(T,{item:!0,xs:12,sm:6,md:3,lg:2,xl:2,children:e.jsx(Hr,{in:!0,timeout:300,children:e.jsxs(De,{sx:I({height:"100%",cursor:"pointer",transition:"all 0.3s",background:"background.paper",border:`1px solid ${j("#60a5fa",.2)}`,position:"relative","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${j("#60a5fa",.2)}`,borderColor:"#60a5fa"}},S.has(x.path)&&{borderColor:"#60a5fa",bgcolor:j("#60a5fa",.1)}),onClick:m=>{m.target.type!=="checkbox"&&(p(x.path),t==null||t(x.path),On(x.path))},children:[e.jsx(h,{sx:{position:"absolute",top:8,right:8,zIndex:1},onClick:m=>m.stopPropagation(),children:e.jsx(Cr,{checked:S.has(x.path),onChange:()=>Se(x.path),size:"small",sx:{color:"#60a5fa","&.Mui-checked":{color:"#60a5fa"}}})}),e.jsx(Te,{sx:{px:1.5,py:1.5},children:e.jsxs(ee,{spacing:1.5,children:[e.jsx(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:80,borderRadius:2,background:`linear-gradient(135deg, ${j("#60a5fa",.1)}, ${j("#a78bfa",.1)})`},children:e.jsx(ar,{sx:{fontSize:48,color:"#60a5fa"}})}),e.jsxs(h,{children:[e.jsx(l,{variant:"body2",sx:{fontWeight:600,mb:.25,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:x.name}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{lineHeight:1},children:[x.fileCount," files • ",Mr(x.size)]})]}),(()=>{const m=At(x.path);return m?e.jsx(oe,{icon:m.icon,label:m.label,size:"small",sx:{bgcolor:j(m.color,.1),color:m.color,fontWeight:600,borderRadius:1.5,border:`1px solid ${j(m.color,.3)}`,fontSize:"0.75rem",height:24}}):null})()]})})]})})},`folder-${x.path}`)),_t.map(x=>{const m=Wt(x.status),y=["archiving","restoring"].includes(x.status);return e.jsx(T,{item:!0,xs:12,sm:6,md:3,lg:2,xl:2,children:e.jsx(Hr,{in:!0,timeout:300,children:e.jsxs(De,{sx:I(I({height:"100%",cursor:"pointer",transition:"all 0.3s",background:"background.paper",border:`1px solid ${j(m.color,.2)}`,position:"relative","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${j(m.color,.2)}`,borderColor:m.color}},m.glow&&{animation:`${glow} 2s infinite`,boxShadow:`0 0 20px ${j(m.color,.3)}`}),g.has(x.id)&&{borderColor:m.color,bgcolor:j(m.color,.1)}),onClick:C=>{C.target.type!=="checkbox"&&(A(x),r==null||r(x,"view"))},children:[e.jsx(h,{sx:{position:"absolute",top:8,right:8,zIndex:1},onClick:C=>C.stopPropagation(),children:e.jsx(Cr,{checked:g.has(x.id),onChange:()=>Fe(x.id),size:"small",sx:{color:m.color,"&.Mui-checked":{color:m.color}}})}),e.jsx(Te,{children:e.jsxs(ee,{spacing:1.5,children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:80,borderRadius:2,background:`linear-gradient(135deg, ${j(m.color,.1)} 0%, ${j(m.color,.05)} 100%)`,position:"relative",overflow:"hidden"},children:[e.jsx(Ot,{sx:I({fontSize:48,color:m.color},m.animation&&{animation:`${m.animation} 2s infinite`})}),y&&e.jsx(Ae,{sx:{position:"absolute",bottom:0,left:0,right:0,height:3,bgcolor:j(m.color,.1),"& .MuiLinearProgress-bar":{bgcolor:m.color}}})]}),e.jsx(lt,{title:x.original_filename,children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{variant:"body2",sx:{fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:x.original_filename}),x.is_encrypted&&e.jsx(lt,{title:"Encrypted with E2E encryption",children:e.jsx(bt,{sx:{fontSize:12,color:"success.main"}})})]})}),e.jsx(ee,{spacing:0,children:e.jsx(l,{variant:"caption",color:"text.secondary",sx:{lineHeight:1},children:Mr(x.file_size)})}),e.jsx(oe,{icon:m.icon,label:m.label,size:"small",sx:{bgcolor:j(m.color,.1),color:m.color,fontWeight:600,borderRadius:1.5}})]})})]})})},x.id)})]})]})]}),b&&e.jsx(Xn,{direction:"left",in:!!b,mountOnEnter:!0,unmountOnExit:!0,children:e.jsxs(ie,{elevation:0,sx:{width:{xs:"100%",lg:320},height:{xs:"auto",lg:"100%"},maxHeight:{xs:"400px",lg:"none"},borderRadius:0,borderLeft:{xs:"none",lg:`1px solid ${j(n.palette.divider,.1)}`},borderTop:{xs:`1px solid ${j(n.palette.divider,.1)}`,lg:"none"},background:"background.paper",display:"flex",flexDirection:"column",p:3,gap:2,flexShrink:0,overflow:"auto"},children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700},children:"File Details"}),e.jsx(Ne,{size:"small",onClick:()=>A(null),children:e.jsx(Ss,{})})]}),e.jsx(h,{sx:{height:150,borderRadius:2,background:`linear-gradient(135deg, ${j("#60a5fa",.1)} 0%, ${j("#a78bfa",.1)} 100%)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ot,{sx:{fontSize:64,color:"#60a5fa"}})}),e.jsx(l,{variant:"body1",sx:{fontWeight:600,wordBreak:"break-word"},children:b.original_filename}),e.jsx(Vt,{}),e.jsxs(ee,{spacing:2,children:[e.jsxs(h,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Size"}),e.jsx(l,{variant:"body2",children:Mr(b.file_size)})]}),e.jsxs(h,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Uploaded"}),e.jsx(l,{variant:"body2",children:Ln(b.uploaded_at)})]}),e.jsxs(h,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Status"}),e.jsx(oe,{icon:Wt(b.status).icon,label:Wt(b.status).label,size:"small",sx:{mt:.5,bgcolor:j(Wt(b.status).color,.1),color:Wt(b.status).color,fontWeight:600}})]}),b.glacier_archive_id&&e.jsxs(h,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Archive ID"}),e.jsx(l,{variant:"caption",sx:{display:"block",mt:.5,fontFamily:"monospace",bgcolor:j("#f1f5f9",.5),p:1,borderRadius:1,wordBreak:"break-all"},children:b.glacier_archive_id})]})]}),(()=>{const x=ne.items||[],m=(b==null?void 0:b.relative_path)||"";if(!m)return null;const C=x.filter(Q=>Q.operationType==="upload"||!Q.operationType).filter(Q=>{const le=Q.relativePath||"";return le===m||le.startsWith(m+"/")||le.startsWith(m)}),L=C.length,M=C.filter(Q=>Q.status==="completed").length,$=C.filter(Q=>Q.status==="uploading").length,te=C.filter(Q=>Q.status==="queued").length,B=L>0&&($>0||te>0),U=L>0?Math.round(C.reduce((Q,le)=>Q+(le.progress||0),0)/L):0,ye=L>0?Math.max(U,Math.round(M/L*100)):0,ce=$===0&&te>0;return!B&&ye===0?null:e.jsxs(h,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Upload Status"}),e.jsxs(ee,{direction:"row",alignItems:"center",spacing:1,sx:{mt:.5},children:[e.jsx(Me,{sx:{color:"#60a5fa"}}),e.jsx(l,{variant:"body2",sx:{fontWeight:600},children:ce?"Starting uploads…":`Uploading ${Math.max(Math.floor((L-M)/100)*100,0)} of ${L} files`})]}),ce?e.jsx(Ae,{variant:"indeterminate",sx:{mt:1,height:8,borderRadius:4}}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{variant:"determinate",value:ye,sx:{mt:1,height:8,borderRadius:4}}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[ye,"% complete • ",$," in progress • ",te," queued • ",M," completed"]})]})]})})(),e.jsx(Vt,{}),e.jsxs(ee,{spacing:1,children:[e.jsx(z,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(Yt,{}),sx:{textTransform:"none",fontWeight:600},onClick:()=>ae(b),children:"Download"}),b.status==="uploaded"&&e.jsx(z,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(_s,{}),onClick:()=>k(X,null,function*(){try{yield q(b),st(!0)}catch(x){console.error("Hibernate failed:",x)}}),sx:{textTransform:"none",fontWeight:600,color:"#a78bfa",borderColor:"#a78bfa"},children:"Hibernate"}),b.status==="archived"&&e.jsx(z,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(Nr,{}),onClick:()=>k(X,null,function*(){try{yield Re.restoreFile(b.id,"Standard"),yield st(!0)}catch(x){console.error("Wake failed:",x)}}),sx:{textTransform:"none",fontWeight:600,color:"#fbbf24",borderColor:"#fbbf24"},children:"Wake Up"}),e.jsx(z,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(kr,{}),sx:{textTransform:"none",fontWeight:600},children:"Share"}),e.jsx(z,{fullWidth:!0,variant:"outlined",color:"error",startIcon:e.jsx(zt,{}),onClick:()=>k(X,null,function*(){try{yield Z(b),A(null),st(!0)}catch(x){console.error("Delete failed:",x)}}),sx:{textTransform:"none",fontWeight:600},children:"Delete"})]})]})}),(()=>{if(b||c==="root")return null;const x=K;return e.jsx(Jn,{anchor:"right",open:x,onClose:()=>H(!1),sx:{zIndex:m=>m.zIndex.drawer+1},children:e.jsxs(h,{sx:{width:{xs:320,sm:360},p:3,display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700},children:"Folder Details"}),e.jsx(Ne,{size:"small",onClick:()=>H(!1),children:e.jsx(Ss,{})})]}),e.jsx(h,{sx:{height:120,borderRadius:2,background:`linear-gradient(135deg, ${j("#60a5fa",.1)} 0%, ${j("#a78bfa",.1)} 100%)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ar,{sx:{fontSize:64,color:"#60a5fa"}})}),e.jsx(l,{variant:"body1",sx:{fontWeight:600,wordBreak:"break-word"},children:c}),e.jsx(Vt,{})]})})})(),e.jsxs(ft,{open:fe.open,onClose:()=>O({open:!1,count:0}),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(mt,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(zt,{color:"error"}),"Confirm Bulk Delete"]}),e.jsxs(yt,{children:[e.jsxs(l,{variant:"body1",children:["Are you sure you want to delete ",e.jsx("strong",{children:fe.count})," items?"]}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All selected files and folders will be permanently removed."})]}),e.jsxs(Zt,{children:[e.jsx(z,{onClick:()=>O({open:!1,count:0}),color:"inherit",children:"Cancel"}),e.jsxs(z,{onClick:zn,color:"error",variant:"contained",startIcon:e.jsx(zt,{}),children:["Delete ",fe.count," Items"]})]})]}),e.jsx(Ua,{open:me,onClose:()=>se(!1),downloadInfo:G})]})},Oa=r=>!r||typeof r!="string"?"":r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/<iframe[^>]*>.*?<\/iframe>/gi,"").replace(/<object[^>]*>.*?<\/object>/gi,"").replace(/<embed[^>]*>.*?<\/embed>/gi,"").replace(/<form[^>]*>.*?<\/form>/gi,"").replace(/<input[^>]*>/gi,"").replace(/<textarea[^>]*>.*?<\/textarea>/gi,"").replace(/<select[^>]*>.*?<\/select>/gi,"").replace(/<link[^>]*>/gi,"").replace(/<meta[^>]*>/gi,"").replace(/<style[^>]*>.*?<\/style>/gi,"").replace(/<base[^>]*>/gi,"").replace(/<applet[^>]*>.*?<\/applet>/gi,"").replace(/<param[^>]*>/gi,"").replace(/<blink[^>]*>.*?<\/blink>/gi,"").replace(/<marquee[^>]*>.*?<\/marquee>/gi,"").replace(/<keygen[^>]*>/gi,"").replace(/<isindex[^>]*>/gi,"").replace(/<listing[^>]*>.*?<\/listing>/gi,"").replace(/<plaintext[^>]*>.*?<\/plaintext>/gi,"").replace(/<xmp[^>]*>.*?<\/xmp>/gi,"").replace(/<xml[^>]*>.*?<\/xml>/gi,"").replace(/<svg[^>]*>.*?<\/svg>/gi,"").replace(/<math[^>]*>.*?<\/math>/gi,"").substring(0,1e3),$a=({open:r,file:t,onClose:s,onAction:n,loading:i=!1})=>{const[o,a]=u.useState(0),[d,c]=u.useState(null),[p,f]=u.useState(!1);u.useEffect(()=>(t&&r&&w(),()=>{d&&URL.revokeObjectURL(d)}),[t,r]);const w=()=>k(X,null,function*(){if(t){f(!0);try{(t.file_type.startsWith("image/")||t.file_type.startsWith("video/"))&&c("/api/placeholder/400/300")}catch(N){console.error("Error generating preview:",N)}finally{f(!1)}}}),g=N=>{const b=N.file_type.toLowerCase();return b.startsWith("image/")?e.jsx(Qn,{color:"primary",sx:{fontSize:48}}):b.startsWith("video/")?e.jsx(ei,{color:"secondary",sx:{fontSize:48}}):b.startsWith("audio/")?e.jsx(ti,{color:"success",sx:{fontSize:48}}):b.includes("pdf")||b.includes("document")?e.jsx(Es,{color:"error",sx:{fontSize:48}}):b.includes("text")||b.includes("code")?e.jsx(sn,{color:"info",sx:{fontSize:48}}):b.includes("zip")||b.includes("archive")?e.jsx(St,{color:"warning",sx:{fontSize:48}}):e.jsx(Ot,{color:"action",sx:{fontSize:48}})},D=N=>{switch(N){case"uploaded":return e.jsx(lr,{color:"success"});case"archiving":return e.jsx(ks,{color:"warning"});case"archived":return e.jsx(St,{color:"info"});case"restoring":return e.jsx(ks,{color:"warning"});case"restored":return e.jsx(lr,{color:"success"});case"failed":return e.jsx(ri,{color:"error"});default:return e.jsx(Me,{color:"action"})}},S=N=>{switch(N){case"uploaded":return"success";case"archiving":return"warning";case"archived":return"info";case"restoring":return"warning";case"restored":return"success";case"failed":return"error";default:return"default"}},E=N=>{if(N===0)return"0 Bytes";const b=1024,A=["Bytes","KB","MB","GB","TB"],K=Math.floor(Math.log(N)/Math.log(b));return parseFloat((N/Math.pow(b,K)).toFixed(2))+" "+A[K]},P=N=>new Date(N).toLocaleString(),R=N=>{n&&n(t,N)},v=(N,b)=>{a(b)};return t?e.jsxs(ft,{open:r,onClose:s,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"90vh"}},children:[e.jsx(mt,{children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2},children:[g(t),e.jsxs(h,{children:[e.jsx(l,{variant:"h6",noWrap:!0,sx:{maxWidth:400},children:t.original_filename}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(oe,{icon:D(t.status),label:t.status,color:S(t.status),size:"small"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:E(t.file_size)})]})]})]}),e.jsx(Ne,{onClick:s,children:e.jsx(rn,{})})]})}),e.jsxs(yt,{sx:{p:0},children:[e.jsx(h,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(as,{value:o,onChange:v,children:[e.jsx(qt,{label:"Preview"}),e.jsx(qt,{label:"Details"}),e.jsx(qt,{label:"History"}),e.jsx(qt,{label:"Actions"})]})}),e.jsxs(h,{sx:{p:3},children:[o===0&&e.jsxs(h,{children:[e.jsx(ie,{sx:{p:3,textAlign:"center",mb:3},children:p?e.jsxs(h,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(Ae,{sx:{width:"100%"}}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Loading preview..."})]}):t.file_type.startsWith("image/")?e.jsxs(h,{children:[e.jsx("img",{src:d||"/api/placeholder/400/300",alt:Oa(t.original_filename),style:{maxWidth:"100%",maxHeight:400,objectFit:"contain",borderRadius:8},onError:N=>{N.target.style.display="none",N.target.nextSibling.style.display="block"}}),e.jsx(h,{sx:{display:"none",mt:2},children:e.jsx(he,{severity:"info",children:"Preview not available for this image"})})]}):t.file_type.startsWith("video/")?e.jsx(h,{children:e.jsxs("video",{controls:!0,style:{maxWidth:"100%",maxHeight:400,borderRadius:8},children:[e.jsx("source",{src:d||"/api/placeholder/400/300",type:t.file_type}),"Your browser does not support the video tag."]})}):e.jsxs(h,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[g(t),e.jsx(l,{variant:"h6",color:"text.secondary",children:"Preview not available"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"This file type cannot be previewed"})]})}),e.jsxs(T,{container:!0,spacing:2,children:[e.jsx(T,{item:!0,xs:12,sm:6,md:3,children:e.jsx(z,{variant:"outlined",startIcon:e.jsx(Yt,{}),fullWidth:!0,onClick:()=>R("download"),children:"Download"})}),t.status==="uploaded"&&e.jsx(T,{item:!0,xs:12,sm:6,md:3,children:e.jsx(z,{variant:"outlined",startIcon:e.jsx(St,{}),fullWidth:!0,onClick:()=>R("archive"),children:"Put to Sleep"})}),t.status==="archived"&&e.jsx(T,{item:!0,xs:12,sm:6,md:3,children:e.jsx(z,{variant:"outlined",startIcon:e.jsx(vr,{}),fullWidth:!0,onClick:()=>R("restore"),children:"Restore"})}),e.jsx(T,{item:!0,xs:12,sm:6,md:3,children:e.jsx(z,{variant:"outlined",startIcon:e.jsx(kr,{}),fullWidth:!0,onClick:()=>R("share"),children:"Share"})})]})]}),o===1&&e.jsxs(h,{children:[e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(De,{children:e.jsxs(Te,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"File Information"}),e.jsxs(dt,{dense:!0,children:[e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Ot,{})}),e.jsx(_e,{primary:"Filename",secondary:t.original_filename})]}),e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(ut,{})}),e.jsx(_e,{primary:"Size",secondary:E(t.file_size)})]}),e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Es,{})}),e.jsx(_e,{primary:"Type",secondary:t.file_type})]}),e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Zn,{})}),e.jsx(_e,{primary:"Uploaded",secondary:P(t.uploaded_at)})]}),t.archived_at&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(St,{})}),e.jsx(_e,{primary:"Archived",secondary:P(t.archived_at)})]})]})]})})}),e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(De,{children:e.jsxs(Te,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Status & Metadata"}),e.jsxs(dt,{dense:!0,children:[e.jsxs(ve,{children:[e.jsx(we,{children:D(t.status)}),e.jsx(_e,{primary:"Status",secondary:t.status}),e.jsx(oe,{label:t.status,color:S(t.status),size:"small"})]}),t.checksum&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Le,{})}),e.jsx(_e,{primary:"Checksum",secondary:t.checksum})]}),t.glacier_archive_id&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(St,{})}),e.jsx(_e,{primary:"Glacier ID",secondary:t.glacier_archive_id})]}),t.restore_tier&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Ur,{})}),e.jsx(_e,{primary:"Restore Tier",secondary:t.restore_tier})]})]})]})})})]}),t.description&&e.jsx(De,{sx:{mt:3},children:e.jsxs(Te,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Description"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:t.description})]})})]}),o===2&&e.jsxs(h,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"File History"}),e.jsxs(dt,{children:[e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(Me,{color:"primary"})}),e.jsx(_e,{primary:"File uploaded",secondary:P(t.uploaded_at)})]}),t.status==="archived"&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(St,{color:"info"})}),e.jsx(_e,{primary:"File archived",secondary:t.archived_at?P(t.archived_at):"Recently"})]}),t.status==="restored"&&e.jsxs(ve,{children:[e.jsx(we,{children:e.jsx(vr,{color:"success"})}),e.jsx(_e,{primary:"File restored",secondary:"Recently"})]})]})]}),o===3&&e.jsxs(h,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Available Actions"}),e.jsxs(T,{container:!0,spacing:2,children:[e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(Yt,{color:"primary",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Download"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Download this file to your device"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(Yt,{}),fullWidth:!0,onClick:()=>R("download"),children:"Download"})]})})}),t.status==="uploaded"&&e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(St,{color:"info",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Archive"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Move file to Glacier for long-term storage"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(St,{}),fullWidth:!0,onClick:()=>R("archive"),children:"Archive"})]})})}),t.status==="archived"&&e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(vr,{color:"warning",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Restore"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Restore file from Glacier (takes 3-5 hours)"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(vr,{}),fullWidth:!0,onClick:()=>R("restore"),children:"Restore"})]})})}),e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(kr,{color:"success",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Share"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Generate a shareable link"}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(kr,{}),fullWidth:!0,onClick:()=>R("share"),children:"Share"})]})})}),e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(Cs,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Rename"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Change the filename"}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(Cs,{}),fullWidth:!0,onClick:()=>R("rename"),children:"Rename"})]})})}),e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsx(De,{sx:{height:"100%"},children:e.jsxs(Te,{sx:{textAlign:"center"},children:[e.jsx(zt,{color:"error",sx:{fontSize:48,mb:2}}),e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Delete"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Permanently delete this file"}),e.jsx(z,{variant:"outlined",color:"error",startIcon:e.jsx(zt,{}),fullWidth:!0,onClick:()=>R("delete"),children:"Delete"})]})})})]})]})]})]}),e.jsx(Zt,{children:e.jsx(z,{onClick:s,children:"Close"})})]}):null},Ba=({open:r,onClose:t,onPasswordSet:s})=>{const[n,i]=u.useState(""),[o,a]=u.useState(""),[d,c]=u.useState(!1),[p,f]=u.useState(!1),[w,g]=u.useState(!1),[D,S]=u.useState(""),[E,P]=u.useState(!1),[R,v]=u.useState(0),[N,b]=u.useState(""),[A,K]=u.useState(null),H=de=>k(X,null,function*(){if(de.preventDefault(),S(""),K(null),!n){S("Password is required");return}if(n.length<8){S("Password must be at least 8 characters long");return}if(n!==o){S("Passwords do not match");return}P(!0),v(0),b("Initializing encryption...");try{v(25),b("Setting up encryption keys..."),yield Ye.initializeEncryption(n),v(50),b("Testing encryption...");const je=yield Ye.testEncryption();if(K(je),!je.success)throw new gt(je.error||"Encryption test failed");v(75),b("Finalizing setup..."),w&&(localStorage.setItem("encryption_enabled","true"),localStorage.setItem("encryption_initialized",Date.now().toString())),v(100),b("Encryption ready!"),yield new Promise(ke=>setTimeout(ke,500)),s(n),i(""),a(""),t()}catch(je){console.error("Encryption initialization failed:",je),S(`Encryption setup failed: ${je.message}`),Ye.disableEncryption()}finally{P(!1),v(0),b("")}}),pe=()=>{E||(i(""),a(""),S(""),K(null),t())};return e.jsxs(ft,{open:r,onClose:pe,maxWidth:"sm",fullWidth:!0,children:[e.jsx(mt,{children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Dt,{color:"primary"}),e.jsx(l,{variant:"h6",children:"Set Master Password"})]})}),e.jsxs(yt,{children:[e.jsxs(he,{severity:"info",sx:{mb:2},children:[e.jsx(l,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"🔒 True End-to-End Encryption"}),e.jsxs(l,{variant:"body2",sx:{mb:1},children:["Your master password encrypts all files using ",e.jsx("strong",{children:"AES-GCM 256-bit encryption"})," before upload. Only you can decrypt them - not even we can access your files."]}),e.jsxs(h,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:1},children:[e.jsx(oe,{label:"AES-GCM 256-bit",size:"small",color:"primary"}),e.jsx(oe,{label:"PBKDF2 (100k iterations)",size:"small",color:"primary"}),e.jsx(oe,{label:"Zero-Knowledge",size:"small",color:"primary"}),e.jsx(oe,{label:"Open Source",size:"small",color:"success"})]}),e.jsx(l,{variant:"body2",sx:{mt:1,fontStyle:"italic"},children:"Choose a strong password and keep it safe - it cannot be recovered if lost."})]}),D&&e.jsx(he,{severity:"error",sx:{mb:2},children:D}),A&&e.jsxs(he,{severity:A.success?"success":"error",sx:{mb:2},icon:A.success?e.jsx(Le,{}):e.jsx(gt,{}),children:[e.jsx(l,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:A.success?"✅ Encryption Test Passed":"❌ Encryption Test Failed"}),e.jsx(l,{variant:"body2",children:A.message}),A.success&&e.jsxs(l,{variant:"body2",sx:{mt:1},children:["Duration: ",A.duration,"ms | Compression: ",A.compressionRatio,"x"]})]}),E&&e.jsxs(h,{sx:{mb:2},children:[e.jsx(l,{variant:"body2",sx:{mb:1},children:N}),e.jsx(Ae,{variant:"determinate",value:R,sx:{height:8,borderRadius:4}})]}),e.jsxs(h,{component:"form",onSubmit:H,children:[e.jsx(tt,{fullWidth:!0,label:"Master Password",type:d?"text":"password",value:n,onChange:de=>i(de.target.value),margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(wr,{position:"start",children:e.jsx(bt,{})}),endAdornment:e.jsx(wr,{position:"end",children:e.jsx(Ne,{onClick:()=>c(!d),edge:"end",children:d?e.jsx(Ps,{}):e.jsx(Dr,{})})})},helperText:"Minimum 8 characters, used to derive encryption keys",disabled:E}),e.jsx(tt,{fullWidth:!0,label:"Confirm Password",type:p?"text":"password",value:o,onChange:de=>a(de.target.value),margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(wr,{position:"start",children:e.jsx(bt,{})}),endAdornment:e.jsx(wr,{position:"end",children:e.jsx(Ne,{onClick:()=>f(!p),edge:"end",children:p?e.jsx(Ps,{}):e.jsx(Dr,{})})})},disabled:E}),e.jsx(si,{control:e.jsx(Cr,{checked:w,onChange:de=>g(de.target.checked),disabled:E}),label:"Remember password for this session (not recommended for shared devices)",sx:{mt:2}})]})]}),e.jsxs(Zt,{children:[e.jsx(z,{onClick:pe,disabled:E,children:"Cancel"}),e.jsx(z,{onClick:H,variant:"contained",color:"primary",disabled:!n||!o||E,startIcon:E?e.jsx(Dt,{}):e.jsx(bt,{}),children:E?"Setting Up Encryption...":"Enable E2E Encryption"})]})]})},Fn=()=>{const r=Jt(),[t,s]=u.useState("security"),n=c=>(p,f)=>{s(f?c:!1)},i=[{service:"Google Drive",storage:"1 TB",monthlyPrice:"₹1,300",keyNotes:"Simple, but costly"},{service:"Dropbox",storage:"1 TB",monthlyPrice:"₹1,500",keyNotes:"Smooth, but pricey"},{service:"OneDrive",storage:"1 TB",monthlyPrice:"₹1,250",keyNotes:"Great for Office users"},{service:"☁️ DataHibernate",storage:"1 TB",monthlyPrice:"₹249",keyNotes:`✅ Same AWS reliability
✅ End-to-End Encrypted
✅ Transparent, Indian pricing`}],o=[{icon:e.jsx(bt,{}),title:"True End-to-End Encryption",description:"AES-GCM 256-bit encryption with PBKDF2 key derivation. Files are encrypted before upload - even we cannot decrypt them.",details:["Military-grade AES-GCM 256-bit encryption","PBKDF2 with 100,000 iterations","Random IV per file prevents pattern analysis","Authentication tags ensure integrity","Zero-knowledge architecture"]},{icon:e.jsx(sn,{}),title:"Open Source Encryption",description:"Our encryption code is completely open source, allowing security audits and building trust through transparency.",details:["Full source code available on GitHub","Security researchers can audit the code","No hidden backdoors or vulnerabilities","Community-driven security improvements","Transparent implementation"]},{icon:e.jsx(ui,{}),title:"Master Password Protection",description:"Your master password is never stored on our servers. Keys are derived client-side using industry-standard algorithms.",details:["Password never leaves your device","Keys derived using PBKDF2","No key storage on servers","Client-side encryption only","Password cannot be recovered if lost"]},{icon:e.jsx(hi,{}),title:"Secure Infrastructure",description:"Built on AWS infrastructure with additional security layers and compliance certifications.",details:["AWS S3 with server-side encryption","HTTPS/TLS for all communications","SOC 2 Type II compliance","GDPR compliant data handling","Regular security audits"]}],a=[{icon:e.jsx(lr,{}),title:"99.99% Uptime SLA",description:"Built on AWS infrastructure with redundancy and failover mechanisms.",details:["Multi-region data replication","Automatic failover systems","24/7 monitoring and alerting","99.99% uptime guarantee","Disaster recovery protocols"]},{icon:e.jsx(ut,{}),title:"Glacier Deep Archive",description:"Long-term storage with automatic tiering to reduce costs while maintaining accessibility.",details:["Automatic tiering to Glacier","Instant retrieval for hot data","Cost-effective cold storage","Data integrity verification","Automated lifecycle management"]},{icon:e.jsx(Ur,{}),title:"High Performance",description:"Optimized for speed with CDN integration and parallel processing.",details:["Global CDN for fast downloads","Parallel upload processing","Streaming uploads for large files","Optimized data compression","Smart caching mechanisms"]}],d=[{icon:e.jsx(Gr,{}),title:"Zero-Knowledge Architecture",description:"We cannot see your files, even if we wanted to. Only you have the keys to decrypt your data.",details:["Server never sees plaintext data","No access to encryption keys","Cannot decrypt user files","Privacy by design","Legal protection for users"]},{icon:e.jsx(Jr,{}),title:"GDPR Compliant",description:"Full compliance with privacy regulations including GDPR, CCPA, and other data protection laws.",details:["Right to be forgotten","Data portability","Consent management","Privacy by design","Regular compliance audits"]},{icon:e.jsx(Dr,{}),title:"Transparent Operations",description:"Open about our practices, policies, and any data processing activities.",details:["Open source code","Transparent privacy policy","Regular security reports","Community oversight","No hidden data collection"]}];return e.jsxs(h,{sx:{flex:1,overflow:"auto",pt:{xs:2,md:3},pr:{xs:2,md:2},pb:{xs:2,md:3},pl:{xs:2,md:3}},children:[e.jsx(ie,{sx:{p:2.5,mb:3,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(l,{variant:"h4",sx:{fontWeight:700,mb:2,color:"text.primary"},children:"Why Choose Data Hibernate?"}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",maxWidth:600,mx:"auto"},children:"Save money while keeping your files safe. Simple, secure, and affordable cloud storage."})]})}),e.jsxs(T,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(T,{item:!0,xs:12,md:3,children:e.jsxs(ie,{sx:{height:"100%",textAlign:"center",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsx(Dt,{sx:{fontSize:48,color:"#60a5fa",mb:2}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:1,color:"text.primary"},children:"Secure"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Your files are encrypted and safe"})]})}),e.jsx(T,{item:!0,xs:12,md:3,children:e.jsxs(ie,{sx:{height:"100%",textAlign:"center",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsx(Gr,{sx:{fontSize:48,color:"#a78bfa",mb:2}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:1,color:"text.primary"},children:"Private"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"We can't see your files - only you can"})]})}),e.jsx(T,{item:!0,xs:12,md:3,children:e.jsxs(ie,{sx:{height:"100%",textAlign:"center",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsx(lr,{sx:{fontSize:48,color:"#94a3b8",mb:2}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:1,color:"text.primary"},children:"Reliable"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Built on AWS - same reliability as big companies"})]})}),e.jsx(T,{item:!0,xs:12,md:3,children:e.jsxs(ie,{sx:{height:"100%",textAlign:"center",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsx(ni,{sx:{fontSize:48,color:"#10b981",mb:2}}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:1,color:"text.primary"},children:"Low Cost"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Save up to 80% compared to Google Drive & Dropbox"})]})})]}),e.jsxs(ie,{sx:{p:2.5,mb:3,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsx(l,{variant:"h5",sx:{fontWeight:600,mb:3,display:"flex",alignItems:"center",gap:1,color:"text.primary"},children:"💰 Compare & Save Instantly"}),e.jsx(ii,{component:ie,variant:"outlined",children:e.jsxs(oi,{children:[e.jsx(ai,{children:e.jsxs(Is,{sx:{bgcolor:"grey.50"},children:[e.jsx(Et,{sx:{fontWeight:600},children:"Service"}),e.jsx(Et,{sx:{fontWeight:600},children:"Storage"}),e.jsx(Et,{sx:{fontWeight:600},children:"Monthly Price (1 TB)"}),e.jsx(Et,{sx:{fontWeight:600},children:"Key Notes"})]})}),e.jsx(li,{children:i.map((c,p)=>e.jsxs(Is,{sx:{bgcolor:c.service==="☁️ DataHibernate"?j(r.palette.success.main,.1):"inherit","&:hover":{bgcolor:j(r.palette.primary.main,.05)}},children:[e.jsx(Et,{sx:{fontWeight:c.service==="☁️ DataHibernate"?600:"normal"},children:c.service}),e.jsx(Et,{children:c.storage}),e.jsx(Et,{sx:{fontWeight:c.service==="☁️ DataHibernate"?600:"normal"},children:c.monthlyPrice}),e.jsx(Et,{children:e.jsx(l,{variant:"body2",sx:{whiteSpace:"pre-line"},children:c.keyNotes})})]},c.service))})]})}),e.jsx(he,{severity:"success",sx:{mt:2},children:e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Save up to 80% compared to Google Drive and Dropbox!"}),"Plus you get the same AWS reliability with end-to-end encryption."]})})]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsxs(ie,{sx:{height:"100%",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsxs(l,{variant:"h6",sx:{fontWeight:600,mb:3,display:"flex",alignItems:"center",gap:1,color:"text.primary"},children:[e.jsx(Dt,{sx:{color:"#60a5fa"}}),"Security Features"]}),o.map((c,p)=>e.jsxs(Rs,{expanded:t===`security-${p}`,onChange:n(`security-${p}`),sx:{mb:1},children:[e.jsx(Ds,{expandIcon:e.jsx(Ts,{}),children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[c.icon,e.jsx(l,{variant:"subtitle1",sx:{fontWeight:500},children:c.title})]})}),e.jsxs(Fs,{children:[e.jsx(l,{variant:"body2",sx:{mb:2},children:c.description}),e.jsx(dt,{dense:!0,children:c.details.map((f,w)=>e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(Le,{sx:{fontSize:16,color:"success.main"}})}),e.jsx(_e,{primary:f,primaryTypographyProps:{variant:"body2"}})]},w))})]})]},p))]})}),e.jsx(T,{item:!0,xs:12,md:6,children:e.jsxs(ie,{sx:{height:"100%",p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsxs(l,{variant:"h6",sx:{fontWeight:600,mb:3,display:"flex",alignItems:"center",gap:1,color:"text.primary"},children:[e.jsx(lr,{sx:{color:"#94a3b8"}}),"Reliability Features"]}),a.map((c,p)=>e.jsxs(Rs,{expanded:t===`reliability-${p}`,onChange:n(`reliability-${p}`),sx:{mb:1},children:[e.jsx(Ds,{expandIcon:e.jsx(Ts,{}),children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[c.icon,e.jsx(l,{variant:"subtitle1",sx:{fontWeight:500},children:c.title})]})}),e.jsxs(Fs,{children:[e.jsx(l,{variant:"body2",sx:{mb:2},children:c.description}),e.jsx(dt,{dense:!0,children:c.details.map((f,w)=>e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(Le,{sx:{fontSize:16,color:"success.main"}})}),e.jsx(_e,{primary:f,primaryTypographyProps:{variant:"body2"}})]},w))})]})]},p))]})}),e.jsx(T,{item:!0,xs:12,children:e.jsxs(ie,{sx:{p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsxs(l,{variant:"h6",sx:{fontWeight:600,mb:3,display:"flex",alignItems:"center",gap:1,color:"text.primary"},children:[e.jsx(Gr,{sx:{color:"#a78bfa"}}),"Privacy Features"]}),e.jsx(T,{container:!0,spacing:2,children:d.map((c,p)=>e.jsx(T,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{p:2,border:`1px solid ${j(r.palette.divider,.2)}`,borderRadius:1},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[c.icon,e.jsx(l,{variant:"subtitle1",sx:{fontWeight:500},children:c.title})]}),e.jsx(l,{variant:"body2",sx:{mb:2},children:c.description}),e.jsx(dt,{dense:!0,children:c.details.map((f,w)=>e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(Le,{sx:{fontSize:16,color:"success.main"}})}),e.jsx(_e,{primary:f,primaryTypographyProps:{variant:"body2"}})]},w))})]})},p))})]})})]}),e.jsxs(ie,{sx:{mt:4,p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`},children:[e.jsxs(l,{variant:"h5",sx:{fontWeight:600,mb:3,display:"flex",alignItems:"center",gap:1,color:"text.primary"},children:[e.jsx(qr,{sx:{color:"#60a5fa"}}),"Open Source E2E Encryption"]}),e.jsxs(T,{container:!0,spacing:3,children:[e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"Why Open Source?"}),e.jsxs(dt,{children:[e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(Dr,{sx:{fontSize:16,color:"#60a5fa"}})}),e.jsx(_e,{primary:"Transparency - Users can verify the encryption implementation",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(ci,{sx:{fontSize:16,color:"#60a5fa"}})}),e.jsx(_e,{primary:"Security Audits - Researchers can review and improve the code",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(Jr,{sx:{fontSize:16,color:"#60a5fa"}})}),e.jsx(_e,{primary:"Trust Building - No hidden backdoors or vulnerabilities",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(ve,{sx:{py:.5},children:[e.jsx(we,{sx:{minWidth:32},children:e.jsx(di,{sx:{fontSize:16,color:"#60a5fa"}})}),e.jsx(_e,{primary:"Community Contributions - Security improvements from the community",primaryTypographyProps:{variant:"body2"}})]})]})]}),e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"Technical Implementation"}),e.jsxs(h,{sx:{bgcolor:"background.paper",p:2,borderRadius:1,border:`1px solid ${j(r.palette.divider,.2)}`},children:[e.jsx(l,{variant:"body2",component:"pre",sx:{fontFamily:"monospace",fontSize:"0.875rem",mb:2},children:`// Core Encryption Library
class GlacierEncryption {
  constructor() {
    this.algorithm = 'AES-GCM';
    this.keyLength = 256;
    this.pbkdf2Iterations = 100000;
  }
  
  async encryptFile(fileData, password) {
    const salt = this.generateSalt();
    const iv = this.generateIV();
    const key = await this.deriveKey(password, salt);
    
    return await crypto.subtle.encrypt({
      name: this.algorithm,
      iv: iv
    }, key, fileData);
  }
}`}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(qr,{}),href:"https://github.com/your-org/datahibernate-encryption",target:"_blank",sx:{mt:1},children:"View Source Code"})]})]})]}),e.jsx(he,{severity:"info",sx:{mt:3},children:e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Coming Soon:"})," The complete E2E encryption source code will be available on GitHub for public review and contribution. This includes the core encryption library, key derivation functions, and all security-related components."]})})]}),e.jsxs(ie,{sx:{mt:4,p:2.5,bgcolor:"background.paper",border:`1px solid ${j(r.palette.divider,.1)}`,textAlign:"center"},children:[e.jsx(l,{variant:"h5",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"Ready to Secure Your Data?"}),e.jsx(l,{variant:"body1",sx:{mb:3,color:"text.secondary"},children:"Join thousands of users who trust Data Hibernate for their most sensitive data"}),e.jsxs(ee,{direction:"row",spacing:2,justifyContent:"center",children:[e.jsx(z,{variant:"contained",size:"large",startIcon:e.jsx(Me,{}),children:"Start Uploading"}),e.jsx(z,{variant:"outlined",size:"large",startIcon:e.jsx(qr,{}),children:"View on GitHub"})]})]})]})},Ma=()=>{var qe;const r=Jt(),t=nn(r.breakpoints.down("md")),[s,n]=u.useState("overview"),[i,o]=u.useState(null),[a,d]=u.useState(null),[c,p]=u.useState(!0),[f,w]=u.useState(null),[g,D]=u.useState(""),[S,E]=u.useState(!1),[P,R]=u.useState(!1),[v,N]=u.useState(null),b=[{id:"overview",label:"Overview",icon:e.jsx(ut,{}),view:"overview"},{id:"hibernate",label:"Data Manager",icon:e.jsx(jt,{}),view:"hibernate"},{id:"plans",label:"Plans",icon:e.jsx(Me,{}),view:"plans"},{id:"why",label:"Why Data Hibernate",icon:e.jsx(tn,{}),view:"why"}];u.useEffect(()=>{A(),K();const Y=window.location.hash.substring(1);Y&&["overview","hibernate","plans","why"].includes(Y)&&n(Y)},[]);const A=()=>k(X,null,function*(){try{const Y=yield Tt.getUser();d(Y.data)}catch(Y){console.error("Error loading user data:",Y)}finally{p(!1)}}),K=()=>{const Y=Ye.getEncryptionStatus();E(Y.enabled),N(Y)},H=()=>{S?(Ye.disableEncryption(),E(!1),N(null)):R(!0)},pe=Y=>{K(),R(!1)},de=()=>k(X,null,function*(){try{Ke.clearTokens(),window.location.href="/login"}catch(Y){({}).VITE_DEBUG==="true"&&console.error("Error during logout:",Y),window.location.href="/login"}}),je=Y=>{w(Y.currentTarget)},ke=()=>{w(null)},ne=(Y,Pe)=>k(X,null,function*(){Pe==="view"&&o(Y)}),Xe=Y=>{},fe=()=>{switch(s){case"overview":return e.jsx(Ys,{});case"hibernate":return e.jsx(La,{onFileSelect:ne,onFolderSelect:Xe,globalSearchQuery:g});case"plans":return e.jsx(Dn,{});case"why":return e.jsx(Fn,{});default:return e.jsx(Ys,{})}},O=(Y,Pe)=>{n(Pe)};return c?e.jsx(h,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:e.jsx(Ae,{sx:{width:"100%",maxWidth:400}})}):e.jsxs(h,{sx:{display:"flex",flexDirection:"column",height:"100vh",bgcolor:"grey.50"},children:[e.jsx(pi,{position:"static",elevation:1,sx:{bgcolor:"white",color:"text.primary"},children:e.jsxs(xi,{sx:{minHeight:{xs:56,sm:64},px:{xs:1,sm:2},flexWrap:{xs:"wrap",sm:"nowrap"}},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",mr:{xs:2,sm:4},minWidth:{xs:"auto",sm:"auto"}},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:{xs:28,sm:32},height:{xs:28,sm:32},mr:{xs:1,sm:1.5},borderRadius:1}}),e.jsx(l,{variant:"h6",component:"div",sx:{fontWeight:"bold",fontSize:{xs:"1rem",sm:"1.25rem"},display:{xs:"none",sm:"block"}},children:"Data Hibernate"})]}),e.jsx(as,{value:s,onChange:O,sx:{flexGrow:1,"& .MuiTab-root":{minHeight:{xs:40,sm:48},fontSize:{xs:"0.75rem",sm:"0.875rem"},px:{xs:1,sm:2},textTransform:"none",fontWeight:600},"& .MuiTabs-indicator":{height:{xs:2,sm:3}}},variant:t?"scrollable":"standard",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:b.map(Y=>e.jsx(qt,{value:Y.view,label:Y.label,icon:Y.icon,iconPosition:"start",sx:{minHeight:{xs:40,sm:48},fontSize:{xs:"0.75rem",sm:"0.875rem"},px:{xs:1,sm:2},"& .MuiSvgIcon-root":{fontSize:{xs:"1rem",sm:"1.25rem"}}}},Y.id))}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:{xs:.5,sm:1},ml:{xs:1,sm:2}},children:[e.jsx(Ne,{color:"inherit",onClick:H,title:S?"Disable E2E Encryption":"Enable E2E Encryption",size:"small",sx:{color:S?"success.main":"text.secondary","&:hover":{bgcolor:S?"success.light":"action.hover"},p:{xs:.5,sm:1}},children:S?e.jsx(bt,{}):e.jsx(ls,{})}),e.jsx(Ne,{color:"inherit",size:"small",sx:{p:{xs:.5,sm:1}},children:e.jsx(gi,{badgeContent:0,color:"error",children:e.jsx(fi,{})})}),e.jsx(Ne,{color:"inherit",onClick:je,size:"small",sx:{p:{xs:.5,sm:1}},children:e.jsx(mi,{sx:{width:{xs:28,sm:32},height:{xs:28,sm:32},bgcolor:"primary.main",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:((qe=a==null?void 0:a.username)==null?void 0:qe.charAt(0))||"U"})})]})]})}),e.jsx(h,{sx:{flexGrow:1,overflow:"auto",bgcolor:"grey.50"},children:fe()}),f&&e.jsxs(yi,{anchorEl:f,open:!!f,onClose:ke,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(As,{onClick:ke,children:[e.jsx(en,{sx:{mr:1}}),"Settings"]}),e.jsxs(As,{onClick:de,children:[e.jsx(bi,{sx:{mr:1}}),"Logout"]})]}),i&&e.jsx($a,{file:i,open:!!i,onClose:()=>o(null)}),e.jsx(Ba,{open:P,onClose:()=>R(!1),onPasswordSet:pe})]})},Na=()=>{const[r]=mn(),t=vt(),[s,n]=u.useState("verifying"),[i,o]=u.useState(""),[a,d]=u.useState(""),[c,p]=u.useState(!1),f=r.get("token");u.useEffect(()=>{f?w(f):(n("error"),o("No verification token provided"))},[f]);const w=E=>k(X,null,function*(){var P,R;try{const v=yield Tt.verifyEmail({token:E});n("success"),o(v.data.message)}catch(v){const N=((R=(P=v.response)==null?void 0:P.data)==null?void 0:R.error)||"Verification failed";N.includes("expired")?(n("expired"),o("Your verification link has expired. Please request a new verification email.")):(n("error"),o(N))}}),g=()=>k(X,null,function*(){var E,P;if(!a){o("Please enter your email address");return}p(!0);try{yield Tt.resendVerification({email:a}),o("Verification email sent! Please check your inbox.")}catch(R){o(((P=(E=R.response)==null?void 0:E.data)==null?void 0:P.error)||"Failed to resend verification email")}finally{p(!1)}}),D=()=>{switch(s){case"success":return e.jsx(Le,{color:"success",sx:{fontSize:60}});case"error":case"expired":return e.jsx(ji,{color:"error",sx:{fontSize:60}});default:return e.jsx(Kt,{size:60})}},S=()=>{switch(s){case"success":return"success";case"error":case"expired":return"error";default:return"info"}};return e.jsx(De,{sx:{maxWidth:500,mx:"auto",mt:8},children:e.jsxs(Te,{children:[e.jsx(h,{sx:{textAlign:"center",mb:3},children:D()}),e.jsx(l,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"Email Verification"}),i&&e.jsx(he,{severity:S(),sx:{mb:3},children:i}),s==="success"&&e.jsx(h,{sx:{textAlign:"center"},children:e.jsx(z,{variant:"contained",onClick:()=>t("/login"),sx:{mt:2},children:"Go to Login"})}),(s==="error"||s==="expired")&&e.jsxs(h,{children:[e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s==="expired"?"Your verification link has expired. Enter your email address to get a new verification email.":"Didn't receive the email? Enter your email address to resend the verification email."}),e.jsx(tt,{fullWidth:!0,label:"Email Address",type:"email",value:a,onChange:E=>d(E.target.value),sx:{mb:2}}),e.jsx(z,{fullWidth:!0,variant:"contained",startIcon:e.jsx(Xt,{}),onClick:g,disabled:c,children:c?"Sending...":"Resend Verification Email"}),e.jsx(z,{fullWidth:!0,variant:"outlined",onClick:()=>t("/login"),sx:{mt:1},children:"Back to Login"})]}),s==="verifying"&&e.jsx(l,{variant:"body2",color:"text.secondary",align:"center",children:"Verifying your email address..."})]})})},Ha=()=>{const[r,t]=u.useState(!1);u.useEffect(()=>{const i=()=>{const a=Ye.getEncryptionStatus();t(a.enabled)};i();const o=setInterval(i,1e3);return()=>clearInterval(o)},[]);const s=i=>{const o=i.filter(d=>d.success),a=i.filter(d=>!d.success);alert(`Upload completed! ${o.length} files uploaded successfully, ${a.length} failed.`)},n=(i,o)=>{};return e.jsx("div",{className:"min-h-screen bg-gray-100 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Data Hibernate Platform"}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Upload your files directly to S3"}),e.jsx(h,{sx:{display:"flex",justifyContent:"center",mb:2},children:r?e.jsx(oe,{icon:e.jsx(bt,{}),label:"E2E Encryption Enabled",color:"success",variant:"outlined",sx:{fontWeight:600}}):e.jsx(oe,{icon:e.jsx(ls,{}),label:"E2E Encryption Disabled",color:"default",variant:"outlined",sx:{fontWeight:600}})}),!r&&e.jsx(he,{severity:"info",sx:{maxWidth:600,mx:"auto",mb:4},children:e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"🔓 E2E Encryption Disabled"}),e.jsx("br",{}),"Files will be uploaded without encryption. Enable E2E encryption from the dashboard for maximum security."]})})]}),e.jsx(Tn,{onUploadComplete:s,onUploadProgress:n})]})})},Ga=()=>{const r=Jt();nn(r.breakpoints.down("md"));const t=[{icon:e.jsx(jt,{sx:{fontSize:40,color:"#4f46e5"}}),title:"Deep Hibernate",subtitle:"🌙 Long-term archival storage",features:["Stored safely in AWS Glacier Deep Archive","Ultra-low cost for long-term data","Restore in ~12 hours","10 GB free retrieval every 6 months"],pricing:[{storage:"100 GB",price:"₹599/year"},{storage:"1 TB",price:"₹2,999/year"}],description:"Perfect for memories, backups, and data you rarely need",color:"#1976d2",gradient:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",lightColor:"#e3f2fd",darkColor:"#1565c0",bgColor:"#f8fafc",textColor:"#1e293b"},{icon:e.jsx(Rr,{sx:{fontSize:40,color:"#2563eb"}}),title:"Smart Hibernate",subtitle:"🌤️ Flexible retrieval storage",features:["Stored on AWS Glacier Flexible Retrieval","Retrieve anytime within hours","Includes 10 GB free per month","Extra retrieval at ₹2/GB"],pricing:[{storage:"100 GB",price:"₹1,079/year"},{storage:"1 TB",price:"₹4,799/year"}],description:"Balance between cost and accessibility for regular backups",color:"#1976d2",gradient:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",lightColor:"#e3f2fd",darkColor:"#1565c0",bgColor:"#f8fafc",textColor:"#1e293b"}],s=[{icon:e.jsx(Jr,{}),text:"Built on AWS — Trusted globally"},{icon:e.jsx(wi,{}),text:"Up to 80% cheaper than big tech storage"},{icon:e.jsx(_i,{}),text:"No confusing tech — just simple plans"},{icon:e.jsx(Si,{}),text:"Made for India — affordable, reliable, transparent"},{icon:e.jsx(Ei,{}),text:"You pay once. We take care of the rest."}];return e.jsxs(h,{sx:{minHeight:"100vh",bgcolor:"grey.50"},children:[e.jsx(ie,{elevation:0,sx:{background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white",py:{xs:8,md:12},borderRadius:0,position:"relative",overflow:"hidden"},children:e.jsx(it,{maxWidth:"lg",children:e.jsxs(T,{container:!0,spacing:4,alignItems:"center",children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsxs(h,{sx:{textAlign:{xs:"center",md:"left"}},children:[e.jsx(oe,{icon:e.jsx(Me,{}),label:"💤 DataHibernate",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",mb:3,fontSize:"1.1rem",fontWeight:600,borderRadius:3}}),e.jsx(l,{variant:"h1",sx:{fontSize:{xs:"2.5rem",md:"3.5rem"},fontWeight:800,lineHeight:1.2,mb:3},children:"Upload. Forget. Sleep Easy."}),e.jsx(l,{variant:"h5",sx:{fontSize:{xs:"1.2rem",md:"1.5rem"},fontWeight:300,mb:4,opacity:.9},children:"Your memories deserve rest, too."}),e.jsx(l,{variant:"body1",sx:{fontSize:"1.1rem",mb:4,opacity:.8,lineHeight:1.6},children:"A secure, long-term cloud vault built for people who don't want to think about storage ever again. Whether it's old photos, work archives, or personal backups — just upload once and let it sleep in peace."}),e.jsxs(ee,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(z,{variant:"contained",size:"large",endIcon:e.jsx(Ws,{}),sx:{bgcolor:"white",color:"#1976d2",px:4,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.2)","&:hover":{bgcolor:"rgba(255,255,255,0.9)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(0,0,0,0.3)"}},onClick:()=>window.location.href="/login",children:"Get Started"}),e.jsx(z,{variant:"outlined",size:"large",sx:{borderColor:"white",color:"white",px:4,py:1.5,fontSize:"1.1rem",fontWeight:600,borderRadius:3,"&:hover":{borderColor:"white",bgcolor:"rgba(255,255,255,0.1)"}},onClick:()=>window.location.href="/why",children:"Why Choose Us?"})]})]})}),e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(h,{sx:{textAlign:"center"},children:e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate Logo",sx:{width:{xs:200,md:300},height:"auto",filter:"drop-shadow(0 10px 20px rgba(0,0,0,0.3))"}})})})]})})}),e.jsxs(it,{maxWidth:"lg",sx:{py:8},children:[e.jsxs(h,{sx:{textAlign:"center",mb:6},children:[e.jsx(l,{variant:"h3",sx:{mb:3,fontWeight:800,color:"#1e293b"},children:"Choose Your Hibernation Plan"}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",maxWidth:700,mx:"auto",lineHeight:1.6},children:"Select the perfect storage solution for your data needs. Each plan offers different balance between cost, storage capacity, and retrieval speed."})]}),e.jsx(T,{container:!0,spacing:4,children:t.map((n,i)=>e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(De,{sx:{height:"100%",position:"relative",border:`2px solid ${j(n.color,.15)}`,borderRadius:4,transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)","&:hover":{transform:"translateY(-12px) scale(1.02)",boxShadow:`0 20px 60px ${j(n.color,.25)}`,borderColor:n.color}},children:e.jsx(Te,{sx:{p:4},children:e.jsxs(ee,{spacing:4,children:[e.jsxs(h,{sx:{textAlign:"center"},children:[e.jsx(h,{sx:{p:3,borderRadius:"50%",bgcolor:n.lightColor,display:"flex",alignItems:"center",justifyContent:"center",border:`2px solid ${n.color}`,mx:"auto",width:80,height:80,mb:3},children:ur.cloneElement(n.icon,{sx:{fontSize:40,color:n.color}})}),e.jsx(l,{variant:"h4",sx:{fontWeight:800,mb:2,color:n.textColor},children:n.title}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",lineHeight:1.5},children:n.description})]}),e.jsx(dt,{dense:!0,children:n.features.map((o,a)=>e.jsxs(ve,{sx:{px:0},children:[e.jsx(we,{sx:{minWidth:36},children:e.jsx(Le,{sx:{color:n.color,fontSize:20}})}),e.jsx(_e,{primary:o,primaryTypographyProps:{fontSize:"0.9rem"}})]},a))}),e.jsx(h,{sx:{textAlign:"center",p:3,bgcolor:n.lightColor,borderRadius:3,border:`1px solid ${j(n.color,.2)}`},children:n.pricing.map((o,a)=>e.jsxs(h,{sx:{mb:a===0?2:0},children:[e.jsx(l,{variant:"h5",sx:{fontWeight:800,mb:1,color:n.textColor},children:o.price}),e.jsxs(l,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:[o.storage," Storage"]})]},a))}),e.jsx(z,{fullWidth:!0,variant:"contained",sx:{bgcolor:n.color,borderRadius:3,py:3,fontSize:"1.1rem",fontWeight:700,textTransform:"none",boxShadow:`0 4px 16px ${j(n.color,.2)}`,transition:"all 0.3s ease","&:hover":{bgcolor:n.darkColor,transform:"translateY(-2px)",boxShadow:`0 8px 24px ${j(n.color,.3)}`}},children:"Choose Plan"})]})})})},i))})]}),e.jsx(ie,{elevation:0,sx:{bgcolor:"#f8fafc",py:8,borderRadius:0},children:e.jsxs(it,{maxWidth:"lg",children:[e.jsx(h,{sx:{textAlign:"center",mb:6},children:e.jsx(l,{variant:"h3",sx:{mb:3,fontWeight:800,color:"#1e293b"},children:"Why Choose DataHibernate?"})}),e.jsx(T,{container:!0,spacing:4,children:s.map((n,i)=>e.jsx(T,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(ie,{sx:{p:4,textAlign:"center",height:"100%",borderRadius:3,transition:"all 0.3s ease",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 16px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-8px)",boxShadow:"0 12px 32px rgba(0,0,0,0.15)"}},children:[e.jsx(h,{sx:{color:"#1976d2",mb:3},children:ur.cloneElement(n.icon,{sx:{fontSize:48}})}),e.jsx(l,{variant:"h6",sx:{fontWeight:600,color:"#1e293b"},children:n.text})]})},i))})]})}),e.jsx(it,{maxWidth:"lg",sx:{py:8},children:e.jsxs(T,{container:!0,spacing:6,alignItems:"center",children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate",sx:{width:"100%",maxWidth:400,height:"auto",mx:"auto",display:"block",filter:"drop-shadow(0 8px 16px rgba(0,0,0,0.1))"}})}),e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h3",sx:{mb:3,fontWeight:800,color:"#1e293b"},children:"Your Data's Second Home"}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",lineHeight:1.6,mb:3},children:"From family albums to startup archives — DataHibernate ensures your files are sleeping safely in the cloud, ready whenever you need them again."}),e.jsx(l,{variant:"body1",sx:{fontSize:"1.1rem",lineHeight:1.7,mb:4,color:"text.secondary"},children:"Think of it as hibernation for your data — calm, secure, and waiting patiently for your call."}),e.jsxs(ee,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(oe,{icon:e.jsx(Dt,{}),label:"Secure",sx:{bgcolor:"#e0e7ff",color:"#4f46e5",fontWeight:600,borderRadius:3}}),e.jsx(oe,{icon:e.jsx(ut,{}),label:"Reliable",sx:{bgcolor:"#dbeafe",color:"#2563eb",fontWeight:600,borderRadius:3}}),e.jsx(oe,{icon:e.jsx(vi,{}),label:"Affordable",sx:{bgcolor:"#dcfce7",color:"#16a34a",fontWeight:600,borderRadius:3}}),e.jsx(oe,{icon:e.jsx(Ur,{}),label:"Fast",sx:{bgcolor:"#fef3c7",color:"#d97706",fontWeight:600,borderRadius:3}})]})]})]})}),e.jsx(ie,{elevation:0,sx:{background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white",py:8,textAlign:"center",borderRadius:0},children:e.jsxs(it,{maxWidth:"md",children:[e.jsx(l,{variant:"h3",sx:{mb:3,fontWeight:800},children:"🔒 Start Your Hibernate Journey Today"}),e.jsxs(l,{variant:"h6",sx:{mb:4,opacity:.9,lineHeight:1.6},children:["Choose your plan → Upload → Relax.",e.jsx("br",{}),"No hidden charges. No monthly stress.",e.jsx("br",{}),"Just pure, long-term peace."]}),e.jsx(z,{variant:"contained",size:"large",endIcon:e.jsx(Ws,{}),sx:{bgcolor:"white",color:"#1976d2",px:6,py:2,fontSize:"1.2rem",fontWeight:600,borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.2)","&:hover":{bgcolor:"rgba(255,255,255,0.9)",transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(0,0,0,0.3)"}},onClick:()=>window.location.href="/login",children:"Get Started →"})]})}),e.jsx(ie,{elevation:0,sx:{bgcolor:"#1e293b",color:"white",py:6,borderRadius:0},children:e.jsxs(it,{maxWidth:"lg",children:[e.jsxs(T,{container:!0,spacing:4,children:[e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(h,{component:"img",src:"/icon.png",alt:"DataHibernate",sx:{width:48,height:48,mr:2}}),e.jsx(l,{variant:"h5",sx:{fontWeight:800},children:"DataHibernate"})]}),e.jsx(l,{variant:"body1",sx:{color:"#94a3b8",mb:3,lineHeight:1.6},children:"Secure, affordable cloud storage for your digital memories. Built for India, trusted globally."})]}),e.jsxs(T,{item:!0,xs:12,md:6,children:[e.jsx(l,{variant:"h6",sx:{mb:3,fontWeight:700},children:"Quick Links"}),e.jsxs(ee,{direction:"row",spacing:3,flexWrap:"wrap",children:[e.jsx(et,{href:"/login",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Login"}),e.jsx(et,{href:"/register",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Register"}),e.jsx(et,{href:"/why",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Why Choose Us"}),e.jsx(et,{href:"#",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Privacy Policy"}),e.jsx(et,{href:"#",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Terms of Service"}),e.jsx(et,{href:"#",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Support"}),e.jsx(et,{href:"#",sx:{color:"#94a3b8",textDecoration:"none","&:hover":{color:"white"}},children:"Contact"})]})]})]}),e.jsx(Vt,{sx:{my:4,borderColor:"#334155"}}),e.jsx(l,{variant:"body2",sx:{color:"#94a3b8",textAlign:"center"},children:"© 2024 DataHibernate. All rights reserved. Built with ❤️ for digital peace of mind."})]})})]})},qa=Ci({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'}}),Va=()=>{const r=sr();return u.useEffect(()=>{const t=document.title||"Data Hibernate",s=r.pathname;Mt.trackPageView(t,s)},[r]),null},Ya=()=>e.jsxs(ki,{theme:qa,children:[e.jsx(Pi,{}),e.jsx(it,{maxWidth:!1,disableGutters:!0,children:e.jsx(h,{sx:{minHeight:"100vh"},children:e.jsxs(So,{children:[e.jsx(Va,{}),e.jsxs(yo,{children:[e.jsx(nt,{path:"/",element:e.jsx(Ga,{})}),e.jsx(nt,{path:"/login",element:e.jsx(ba,{})}),e.jsx(nt,{path:"/register",element:e.jsx(ja,{})}),e.jsx(nt,{path:"/forgot-password",element:e.jsx(va,{})}),e.jsx(nt,{path:"/reset-password",element:e.jsx(wa,{})}),e.jsx(nt,{path:"/why",element:e.jsx(Fn,{})}),e.jsx(nt,{path:"/verify-email",element:e.jsx(Na,{})}),e.jsx(nt,{path:"/dashboard",element:e.jsx(Yr,{children:e.jsx(Ma,{})})}),e.jsx(nt,{path:"/upload",element:e.jsx(Yr,{children:e.jsx(Ha,{})})}),e.jsx(nt,{path:"/plans",element:e.jsx(Yr,{children:e.jsx(Dn,{})})})]})]})})})]});"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(r=>{r.forEach(t=>{t.unregister()})});const Ka=on(document.getElementById("root"));Ka.render(e.jsx(Ya,{}));console.log("VITE_API_BASE_URL:","https://datahibernate.in/api/")});export default Xa();
